## 简介

本文介绍如何通过控制台使用 COS 的媒体处理功能。针对已存在于存储桶中的文件，您可以创建任务进行媒体处理操作。目前支持创建**文件转码**、**视频截帧**、**视频转动图**和**智能封面**四种任务。

>?媒体处理功能为收费项，由数据万象收取，详细的计费说明请参见数据万象 [媒体处理费用](https://cloud.tencent.com/document/product/460/6970#.E5.AA.92.E4.BD.93.E5.A4.84.E7.90.86.E8.B4.B9.E7.94.A8)。

## 操作步骤

1. 登录 [对象存储控制台](https://console.cloud.tencent.com/cos5/bucket) ，在【存储桶列表】页面选择需操作的存储桶，进入存储桶管理页面。
2. 单击【数据处理】>【媒体处理】页签，单击【编辑】，将状态修改为**开启**。
3. （可选）您可以选择开启回调规则，COS 支持自定义设置回调 URL，在事件完成后，系统将向该 URL 发送 HTTP 请求，请求体中包含通知内容。您可通过配置的回调地址及时了解处理进展和状态，以便进行其他业务操作。回调详情请查看下方的 [回调内容](#.E5.9B.9E.E8.B0.83.E5.86.85.E5.AE.B9)。
4. 单击【保存】，即可开启媒体处理功能。
5. 功能开启后，单击【创建任务】。您可以创建媒体处理任务进行**文件转码**、**视频截帧**、**视频转动图**和**智能封面**。不同类型的任务可参考以下配置项说明进行配置：
   ![](https://main.qcloudimg.com/raw/1a651cba711e11eacfd99420a09ede88.png)
 - 选择任务类型为**文件转码**。
    - 源文件路径：需要转码的文件所在路径。
    - 输出存储桶：转码后的文件所存放的存储桶。
    - 输出路径：转码后的文件存放路径，如不填写则与源文件路径保持一致，注意文件路径以 / 分割文件夹，不允许以 / 结尾。
    - 输出文件名：转码后的文件名。
    - 队列：任务创建完成后，将会进入队列中按创建顺序依次执行，当队列未开启或暂停时，需手动开启队列。
    - 模板类型：选择转码的模板类型，可选系统默认模板或创建自定义模板，有关自定义模板更详细的信息请参见 [任务模板](https://cloud.tencent.com/document/product/460/46490#.E8.87.AA.E5.AE.9A.E4.B9.89.E6.A8.A1.E6.9D.BF)。
    - 选择模板：选择需要转码的模板。
    - 添加水印：若已创建水印模板，则可以选择添加视频水印。
    - 去除水印：可去除视频中的水印。
 - 选择任务类型为**视频截帧**。
    - 源文件路径：需要进行截帧的文件所在路径。
    - 输出存储桶：截帧后的文件所存放的存储桶。
    - 输出路径：截帧后的文件存放路径，如不填写则与源文件路径保持一致，注意文件路径以 / 分割文件夹，不允许以 / 结尾。
    - 输出文件名：截帧后的文件名，必须包含{Number}参数作为截图序号。例如输出文件名设置为 test-${Number}.jpg，任务截取两张截图，则实际输出文件名为 test-0.jpg、test-1.jpg。
    - 输出格式：默认为 JPEG。
    - 队列：任务创建完成后，将会进入队列中按创建顺序依次执行，当队列未开启或暂停时，需手动开启队列。
    - 模板类型：选择截帧的模板类型，可选系统默认模板或创建自定义模板，有关自定义模板更详细的信息请参见 [任务模板](https://cloud.tencent.com/document/product/460/46490#.E8.87.AA.E5.AE.9A.E4.B9.89.E6.A8.A1.E6.9D.BF)。
    - 选择模板：选择需要截帧的模板。
 - 选择任务类型为**视频转动图**。
    - 源文件路径：需要进行转动图的文件所在路径。
    - 输出存储桶：转动图后的文件所存放的存储桶。
    - 输出路径：转动图后的文件所存放的路径，如不填写则与源文件路径保持一致，注意文件路径以 / 分割文件夹，不允许以 / 结尾。
    - 输出文件名：转动图后的文件名。
    - 队列：任务创建完成后，将会进入队列中按创建顺序依次执行，当队列未开启或暂停时，需手动开启队列。
    - 模板类型：选择转动图的模板类型，可选系统默认模板或创建自定义模板，有关自定义模板更详细的信息请参见 [任务模板](https://cloud.tencent.com/document/product/460/46490#.E8.87.AA.E5.AE.9A.E4.B9.89.E6.A8.A1.E6.9D.BF)。
    - 选择模板：选择需要转动图的模板。
 - 选择任务类型为**智能封面**。
    - 源文件路径：需要获取智能封面的文件所在路径。
    - 输出存储桶：获取智能封面后的文件存放存储桶。
    - 输出路径：获取智能封面后的文件存放路径，如不填写则与源文件路径保持一致，注意文件路径以 / 分割文件夹，不允许以 / 结尾。
    - 输出文件名：获取智能封面后的文件名，输出文件名必须包含{Number}参数作为封面序号。如输出文件名设置为 test-${Number}.jpg，则实际输出文件名为 test-0.jpg、test-1.jpg。
    - 队列：任务创建完成后，将会进入队列中按创建顺序依次执行，当队列未开启或暂停时，需手动开启队列。
6. 配置完成后，单击【确定】即可完成媒体处理任务的创建。

## 回调内容

任务完成后，系统会向您设置的回调地址发送回调内容，内容展示如下：

```shell
<Response>
  <JobsDetail></JobsDetail>
  <NonExistJobIds></NonExistJobIds>
</Response>
```

具体的数据内容如下：

| 参数 |描述           | 类型      |
| :----------------- | :------------- | :-------- |                                
| JobsDetail         |任务的详细信息，同 CreateMediaJobs 接口的 [Response.JobsDetail](https://cloud.tencent.com/document/product/460/48233#.E5.93.8D.E5.BA.94) 节点 | Container |
| NonExistJobIds     | 查询的 ID 中不存在的任务，所有任务都存在时不返回             | String  |
