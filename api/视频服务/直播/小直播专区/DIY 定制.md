

## 移动端定制
小直播的源码中所使用的是腾讯云交互设计提供的一套模式方案，如果您是：
- 想要在已有的APP中集成直播功能，只需要直播/录播列表和推流播放等部分；
- 想要一个独立的APP，但不想使用腾讯云原定的设计方案；
- 只需要推流和播放界面，其它的统统不需要；

那么您完全可以按自己的思路对我们的源码进行定制和修改，这个过程您可以参考源码的设计文档，先对每个模块的功能和设计思路有一个了解，然后再按自己的想法去粗取精，辅助您快速实现自己想要的UI和功能逻辑。

## 替换账号系统
小直播默认使用的账号体系是腾讯云的托管账号体系，即注册登录服务以及账号管理和存储均由腾讯云后台提供支持和保障，这种方式的好处是可以快速的跑起来看到效果。

但很大概率来说，您已经有了自己现成的账号体系和用户关系链，并且不考虑做迁移和调整。在小直播的设计之初我们就考虑到了这一点，所以跟直播录播相关的功能设计均没有强依赖账号体系和用户资料，目的就是方便您通过半天的时间就可以完成替换。

## 定制IM消息
IM消息即消息收发和聊天室功能，小直播中的消息、弹幕、点赞等功能都是基于IM消息系统实现的。

**如果您考虑完全替换**
如果您有自己的消息解决方案，可以考虑不使用腾讯云的IM解决方案，这种模式下您需要将小直播中的收发消息部分的底层逻辑替换成您自己的IM消息通道，这部分工作需要您提前阅读小直播的APP源码设计文档。

**如您仅替换账号系统**
如果您觉得腾讯云IM解决方案在高并发和可靠性方面非常满意，但是又希望使用自己的账号体系，那么您可以在腾讯云通讯解决方案中选择**独立模式**进行集成，集成方案可以参考[指引](https://www.qcloud.com/doc/product/269/1508)。

- **IM消息 - 托管模式**
> 直接从官网上获取的小直播是采用了托管模式，该模式下，腾讯云会为您建立一套完整的账号数据库，然后注册和登录服务全部打包实现。
>
> APP在启动时，先用TLS SDK（已打包在IMSDK中）进行TLS登录，TLS后台会返回给您UserSign，之后再把UserSign交给IM SDK进行IM登录即可收发消息了。
>
> 因为整个腾讯云后台是打通的，所以这里的账号映射也是天然打通的。

- **IM消息 - 独立模式**
> 独立模式下，账号系统并不由腾讯后台负责，但是IM消息的发送和接受者又必须跟您的账号系统关联，这种情况下的集成方案如下：
>
> 首先，您需要使用腾讯云[REST API](https://www.qcloud.com/doc/product/269/4919) 将您账号系统中的用户ID、昵称和头像URL导入腾讯的IM 消息系统（放心，这些都是UI显示相关数据）。
>
> 之后，当一个昵称叫“Jack”的用户使用您的APP成功登录了，您的登录后台需要为Jack派发一个UserSign，UserSign由事先协商好的非对称密钥进行签名。
>
> 然后，APP将使用您派发给Jack的UserSign交给IM SDK完成IM登录流程，如果腾讯云IM后台确认UserSign签名合法，即可以确认Jack已经通过了您的身份确认，后续jack就可以使用腾讯云的IM消息服务。

## 安全保护
由于考虑到您很大概率使用自己的账号系统，所以小直播一期的后台代码<font color='red'>并没有集成用户登录检查</font>逻辑，这样做可以避免您在开始阶段即面对如何对接登录检查的问题。

但也因此，目前的源码是没有用户登录确认机制的，换言之它是<font color='red'>**不安全**</font>的，任何熟悉这套协议的攻击者都可以拉取您服务器上的直播列表和录播列表。

所以，在真正上线前，您需要在后台加入身份鉴权逻辑，比如：
- 您可能希望只有登录后的用户才能拉取到直播/录播列表
- 您可能希望只有经过认证的用户才可以获得直播权限
- 您可能希望只有付费用户才能发弹幕消息
- ...

这些鉴权逻辑还需要您在现有的后台源码基础上进行补充，并且对接到自己现有的账号和支付系统中。

总之，小直播一起还只是一个框架，礼物系统，支付系统，游戏录屏等一大波功能还在研发过程中，期待您的持续关注。



