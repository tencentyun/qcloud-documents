**上报方式**
服务器端上报日志（仅支持“自定义事件”类型的数据），参考下文中的[构建报文](#.E6.9E.84.E5.BB.BA.E6.8A.A5.E6.96.87)
>注意：
>当前仅支持HTTP协议的上报接口，参考下文中的[上报到MTA](#.E4.B8.8A.E6.8A.A5.E5.88.B0mta)

## 构建报文
构建JSON格式的日志，可包含表格中的字段。其中标记为必选的字段必须上报，否则日志无效。

用JSON数组的方式上报多条日志，单条日志也需要加 "[…]" 标记。推荐多条日志合并上报，提高传输效率。

|字段ID	|含义|	是否必选|	示例|
| :---: |----| :--: |
|ky	|(系统字段)MTA分配的APPKEY	|必选	|"if8888mta"|
|ts	|(系统字段)当前UNIX时间戳	|必选	|1512057600|
|et	|(系统字段)日志类型	|必选(填1000)	|1000|
|cui	|账号ID	|必选	|"13823965426"|
|ei	|事件ID	|必选|	"\__LOAN\__bind_card"|
|kv	|事件参数(JSON格式)	|可选	|{"status": 1, "product_id": "1000234"}|

### 报文示例
```
[
  {
    "ky": "if8888mta",
    "ts": 1512057600,
    "et": 1000,
    "cui": "13823965426",
    "ei": "__LOAN__bind_card",
    "kv": {"status": 1, "product_id": "1000234"}
  }, {
    "ky": "if8888mta",
    "ts": 1512057600,
    "et": 1000,
    "cui": "13823965426",
    "ei": "__LOAN__card_confirm",
    "kv": {"product_id": "1000234"}
  }
]
```

## 上报到MTA
**接口类型：**HTTP POST

**编码支持：**UTF-8

**上报示例**
```
curl -d '[{"ky": "if8888mta","ts": 1512057600,"et": 1000,"cui":
 "13823965426","ei": "__LOAN__bind_card","kv": {"status": 1, "product_id": 
"1000234"}}]' http://pingma.qq.com/mstat/submit
```

## 事件、参数说明
>注意：
>请按照下文提供的事件ID、参数ID进行上报，且务必参照[上报代码示例](#.E4.BA.8B.E4.BB.B6id.2F.E5.8F.82.E6.95.B0id.E7.A4.BA.E4.BE.8B)进行上报，否则日志无效

### 事件ID/参数ID示例
*展示部分，查看全部请[下载](http://mta.qq.com/mta/resource/download/MTA_loan_introduction.xlsx)*    

|漏斗	|事件名称	|事件id|	是否必选|	上报时机	|事件参数id	|参数含义	|是否必选	|数据指标|
|---|---|---|---|---|------|----|----|
|漏斗|	产品|	 \__LOAN\__product	|必选	|每天上报一次借款产品id|	product_id|	产品id	|必选|	产品维度|
|授信漏斗	|用户注册	|\__LOAN\__register	|必选	|用户注册完成时上报一次|	status|	注册状态|	必选|	注册成功|
|授信漏斗	|点击申请额度	|\__LOAN\__apply_edu|	必选|	用户点击申请额度按钮时上报一次	|product_id	|产品id	|可选	|申请额度|
|授信漏斗|	填写认证材料|	\__LOAN\__fill_info	|必选	|用户开始填写额度申请认证资料时上报一次|	product_id	|产品id|	可选|	授信认证|
|授信漏斗|	提交额度|\__LOAN\__submit|	必选|	用户点击“提交审核申请”按钮时上报一次	|product_id |	产品id |	可选	|额度审核|

### 代码示例
*展示部分，查看全部请[下载](http://mta.qq.com/mta/resource/download/MTA-loan-code-sample.pdf)*

**示例1 **
事件名称&ID：用户注册\__LOAN\__register(必选)

- 上报时机：注册完成时上报一次

|字段	|含义|	必需|	代码示例|	用途|
|--|----|--|---|
|status|	注册状态|	是|	"status":1|	过滤（1：“成功”；0：“失败”）
- 报表：授信分析/漏斗分析
- 名称：注册成功
- 输出维度：无
- - 输出指标
- -  - 用户数：用户账号去重

**示例2 **
事件名称&ID：点击申请额度\__LOAN\__apply_edu(必选)

- 上报时机：开始申请额度时上报一次

|字段	|含义|	必需|	代码示例|	用途|
|--|----|--|---|
|product_id|	产品ID|	否|	"product_id":"10000100"|	维度|
- 报表：授信分析/漏斗分析
- 名称：申请额度
- 输出维度：无
- - 输出指标：
- - - 用户数：用户账号去重

## 接口返回
返回报文为JSON格式，包含ret和msg两个字段
- ret字段：0表示接收成功，其他表示接收失败
- msg字段：如接收失败，这里存放出错原因（如 invalid appkey）
错误码说明

|错误码	|错误码含义|
|---|---|
|invalid appkey	|错误的appkey|
|Json parse error	|Json解析错误|
|Gzip error|	Gzip解压失败|
接收成功并不意味着日志被成功处理。如果缺失[事件参数说明]()中的必选字段，日志仍然可能无效。

上报接收成功后次日就可查看借贷分析的数据
