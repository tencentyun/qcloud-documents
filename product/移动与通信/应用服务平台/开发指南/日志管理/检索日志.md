## 操作场景
本文档主要指导您如何在云开发控制台进行日志检索。

## 操作步骤
1. 登录 [云开发控制台](https://console.cloud.tencent.com/tcb)，单击左侧菜单【日志检索】。
2. 进入日志检索页面，单击【点击开通】，开通日志检索功能。
3. 选择检索的时间范围，然后在输入框填写检索语法（语法支持关键词检索，模糊检索，范围检索等方法）。


### 全文检索
日志内容会根据分词符拆分为多个词组，用户可以输入特定的关键词精确检索到相关日志，也支持模糊关键字匹配检索。
![nBTyR0.png](https://main.qcloudimg.com/raw/54be682521c9a301118bc76127548454.png)


### 键值检索
日志内容以 JSON 对象格式返回，类似于键值对即 key:value 形式，其中 key 作为用户可以自定义输出日志内容对象属性字段，value 则为日志内容，在控制台中同样支持`key:value`格式定位日志，value 支持模糊关键字检索。模糊关键字检索如下：
![nBTgMT.png](https://main.qcloudimg.com/raw/a804c762ada9238224c72e6074f282b2.png)

### 模糊关键字检索
日志服务提供模糊查询的能力，通过特殊的模糊关键字进行日志检索，具体说明如下：

|元字符|描述|
|--------|--------|
| * |模糊查询关键字，匹配零个、单个或多个任意字符。不支持开头\*，例如，输入 abc\*，会返回以 abc 开头的所有命中日志 |
| ? |模糊查询关键字，特定位置匹配单个字符。例如，输入 ab?c，会返回以 ab 为开头，以 c 为结尾字符，且两者之间且有一个字符的所有命中日志 |

![nBTsGq.png](https://main.qcloudimg.com/raw/92899df04ecf7900a6f46196ef40dbf6.png)
![nBT6zV.png](https://main.qcloudimg.com/raw/6dc1b1089b4fffaae4d9dfdd9a4cf5b0.png)


### 查询语法
检索支持以下查询语法：

|语法|语义|
|--|--|
|key:value| 键值搜索格式，其中 value 支持`?`、`*`模糊搜索|
|A and B| “与”逻辑，返回 A 与 B 的交集结果，若多个关键词，使用空格分割则默认为 and |
|A or B|“或”逻辑，返回 A 或 B 的并集结果|
|not B|“非”逻辑，返回不包含 B 的结果|
|A not B| “减”逻辑，返回符合 A 但不符合 B 的结果，即 A-B|
|(A , B)| 合并多个 query 为一个 query，主要用于控制运算优先级|
|A:B |key-value 对的查询格式，若 key 或者 value 中包含空格、冒号等关键字符，需要用引号包括。例如 "error level":high |
|'a'| 字符a将被视为普通字符，不会当作语法关键词处理|
|"A" | A 中的所有关键词都将被视为普通字符，不会当作语法关键词处理|
|\ |转义字符，转义后的字符表示符号本身，例如转义引号`\"`，转义冒号`\:`等 |
|* |模糊查询关键字，匹配零个、单个或多个任意字符，不支持开头`*`，例如：输入`abc*`，会返回以`abc`开头的所有命中日志|
| ?|模糊查询关键字，特定位置匹配单个字符。例如，输入`ab?c`，会返回以`ab`为开头，以`c`为结尾字符，且两者之间且有一个字符的所有命中日志|
|>| 大于，针对数值类型的字段|
|>=| 大于等于，针对数值类型的字段|
|<| 小于，针对数值类型的字段|
|<=| 小于等于，针对数值类型的字段|
|=| 等于，可以是数值类型的字段，也可以是文本类型（不支持模糊搜索，若要使用模糊搜索，参考键值搜索 key:value）|
| in | 数值范围查询，中括号 `[]` 表示闭区间，`()` 表示开区间，例如，`(0 100]` 表示 >0 且 <=100 |
| \_source_ |查询某个 source 源的日志，例如 \_source_:127.0.0.1|

>?
- 运算符的优先级由高到低排序为`:` > `"` > `()` > `and` > `not` > `or`。
- 数值型必须设置成 double 或 long 类型后，才能进行范围检索，否则返回的结果会与预期不符。
- 若 b 是文本，`a=b`与`a：b`的区别在于前者是 a 全等于 b，后者是 a 包含 b（按分词逻辑处理，支持模糊搜索）。
- 语法关键词不区分大小写。
