## 简介

目前，厂商会逐步对 App 开发者的通知消息根据分类进行限额限频，以此保证终端用户不被过度骚扰；不同的消息分类主要通过渠道 ID（ChannelID）进行区分；TPNS 综合各厂商的分类能力，支持将消息分为两类：

- 普通消息（默认）：适用于推送全员公告、运营活动、热点新闻等，多为用户普适性的内容。
- 通知消息/个人私信：适用于推送聊天消息、个人订单变化、交易提醒等与私人通知相关的内容，通知消息的推送数量不受限制。

消息分类支持在调用推送 API 时指定。

#### 使用步骤

1. 若需要使用厂商通知消息，按以下说明申请或创建通知消息的 Channel ID：
	- [OPPO 申请指南](#oppozhinan)
	- [小米申请指南](#xiaomizhinan)
	- [vivo 申请指南](#vivozhinan)
	- [华为使用指南](#huaweizhinan)
	
 申请到 Channel ID 后在推送 API 时指定即可。魅族、华为暂不支持通知消息，且不限额。
2. 若不需要使用厂商通知/私信消息，仅需要自定义 Channel ID，从而做到根据 App 自身的业务消息类别进行消息分类，可根据不同厂商对应进行配置：
<table>
<thead>
<tr>
<th>推送通道</th>
<th>配置说明</th>
</tr>
</thead>
<tbody><tr>
<td>TPNS</td>
<td><ul><li>App 端，调用 Android SDK 创建 Channel ID 接口创建 Channel ID。</li><li>调用 TPNS <a href="https://cloud.tencent.com/document/product/548/39064#android-.E6.99.AE.E9.80.9A.E6.B6.88.E6.81.AF">服务端 API</a> 时，指定对应的 Channel ID（不限额度）。</li></ul></td>
</tr>
<tr>
<td>华为</td>
<td><ul><li>App 端，调用 Android SDK 创建 Channel ID 接口创建 Channel ID。</li><li>调用 TPNS <a href="https://cloud.tencent.com/document/product/548/39064#android-.E6.99.AE.E9.80.9A.E6.B6.88.E6.81.AF">服务端 API</a> 时，指定对应的 Channel ID（不限额度）。</li></ul></td>
</tr>
<tr>
<td>小米</td>
<td><ul><li> 在小米开放平台管理台上创建 Channel ID 或通过小米服务端 API 创建。</li><li>调用 TPNS 服务端 API 时，指定对应的 Channel ID。 </li></td>
</tr>
<tr>
<td>OPPO</td>
<td><ul><li>App 端，调用 Android SDK 创建 Channel ID。</li><li>在 OPPO 管理台登记该 Channel ID，保持一致性.</li><li>调用 TPNS 服务端 API 时，指定对应的 Channel ID。</li></ul></td>
</tr>
<tr>
<td>魅族</td>
<td>无 Channel 相关说明。</td>
</tr>
<tr>
<td>vivo</td>
<td><ul><li>调用服务端 API 创建 Channel ID 。</li><li>调用 TPNS <a href="https://cloud.tencent.com/document/product/548/39064#android-.E6.99.AE.E9.80.9A.E6.B6.88.E6.81.AF">服务端 API</a> 时，指定对应的 Channel ID 。</li></ul></td>
</tr>
</tbody></table>
3. 若既不需要使用厂商通知消息，也不需要自定义 Channel ID，则无需做任何处理，TPNS 会为 App 的所有消息指定一个默认的 Channel ID，消息归到默认类别中。



## OPPO 通知渠道申请指南[](id:oppozhinan)

### OPPO 通知渠道介绍

OPush 平台上默认的是公信通道，目前在原有基础上新增“私信”通道，对单个用户推送个性化信息时，不再受推送数量限制。以下是“公信”和“私信”的对比：

| 类型         | 公信                                                         | 私信                                                         |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 推送内容     | 热点新闻、新品推广、平台公告、社区话题、有奖活动等，多用户普适性的内容。 | 个人订单变化、快递通知、订阅内容更新、评论互动、会员积分变动等，与单个用户信息强相关的内容。 |
| 推送对象     | 多个用户（也可单个用户推送）。                               | 仅限单个用户。                                               |
| 推送数量限制 | 所有公信类通道共享推送次数，当日达到次数限制后，所有公信类通道将不能再推送消息，目前单日推送数量为：累计注册用户数 * 2 。 | 不限量。                                                     |
| 配置方式     | 默认。                                                       | 需要在 OPPO PUSH 运营平台上登记该通道，并将通道对应属性设置为“私信” 。 |

> !OPPO 官方提醒：切记！一定不要利用私信通道用于普适性消息推送（如热点新闻、新品推广等），后台会实时监控，如违反运营规则，OPush 有权关闭您的私信通道权限。由此产生的后果，如调用接口异常，或使用私信通道发送的消息没到达用户等，由业务方自行承担。

### OPPO 私信通道申请

1. 进入 [OPPO 开放平台](https://push.oppo.com)，在【应用配置】>【新建通道】中新建通道，通道 ID 与通道名称必填且需要与应用客户端保持一致，其他选项可不填。
<dx-alert infotype="notice" title="">
通道 ID 一旦确定下来不能随意变更或删除。
</dx-alert>

 ![](https://main.qcloudimg.com/raw/20c0242e7558cdfac1bd6d6a79f0a219.png)
2. 目前 OPPO 私信通道需要邮件申请后才能生效，请按照以下要求发送邮件给 OPush 平台，详情请参见 [OPPO PUSH 通道升级公测邀请](https://open.oppomobile.com/wiki/doc#id=10614)。
```plaintext
公测申请条件：OPush 的累计用户数 ≥ 300,000即可申请加入公私信公测。
申请方式：发送邮件至 push@oppo.com 申请。邮件模板：
应用 ID：XXX
应用名称：XXX
累计用户数：XXX
私信专用通道名称：
私信专用通道 ID：
业务接口人联系微信：
XX应用申请接入 OPush 公私信公测，并承诺遵守运营规则，不使用私信通道推送任何营销消息。
```

### OPPO 私信通道使用

1. 客户端创建通知渠道，请选择以下任意一种方式创建：
	1. 使用 Android API 创建通知渠道，详见 Android 官方文档 [创建和管理通知渠道](https://developer.android.google.cn/training/notify-user/channels)。
	2. 使用 TPNS SDK（1.1.5.4及以上的版本）创建通知渠道，详见文档 [创建通知渠道](https://cloud.tencent.com/document/product/548/36659#.E5.88.9B.E5.BB.BA.E9.80.9A.E7.9F.A5.E6.B8.A0.E9.81.93)。
2. Rest API 推送。
   在 Rest API 请求参数 Android 结构体中设置 `oppo_ch_id` 参数，可实现根据通知渠道下发，具体参考 [PushAPI 参数说明](https://cloud.tencent.com/document/product/548/39064#.E8.AF.B7.E6.B1.82.E5.8F.82.E6.95.B0)。
<dx-alert infotype="notice" title="">
目前 OPPO 私信通道通知只能通过 Rest API 进行下发，控制台暂不支持。
</dx-alert>
推送示例如下：
<dx-codeblock>
:::  json
{
    "audience_type": "token",
    "token_list": ["005c28bf60e29f9a1c2052ce96f43019a0b7"],
    "message_type": "notify",
    "message": {
    "title": "测试标题",
    "content": "测试内容",
    "android": {
        "oppo_ch_id": "私信通道id"}
  }
}
:::
</dx-codeblock>






## 小米通知渠道申请指南[](id:xiaomizhinan)

### 小米通知渠道介绍

小米推送（Mipush）的通知渠道分为“普通消息”（默认）和“通知消息”两类。

- 普通消息（默认）适用于推送热点新闻、新品推广、平台公告、社区话题、有奖活动等，多为用户普适性的内容。
- 通知消息适用于推送聊天消息、个人订单变化、快递通知、交易提醒、IOT系统通知等与私人通知相关的内容，通知消息的推送数量不受限制。

普通消息与通知消息限制说明：

| 类型         | 普通消息（默认）                                             | 通知消息                                                     |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 推送内容     | 热点新闻、新品推广、平台公告、社区话题、有奖活动等，多用户普适性的内容。 | 聊天消息、个人订单变化、快递通知、交易提醒、IoT系统通知等与私人通知相关的内容。 |
| 推送数量限制 | <li>MIUI 日联网设备数&lt;10000时，当日可推送数量为50000 <li>MIUI 日联网设备数≥10000时，当日可推送数为 MIUI 日联网设备数 x 5<li>说明：当日推送数量以送达数计算。</li> | 不限量。                                                     |
| 配置方式     | 默认。                                                       | 需要向小米推送团队申请，审核通过后开通对应类别的Channel（申请方式请参见下章节说明）。 |

### 小米通知消息申请

目前小米通知消息需要开发者登录小米推送运营平台，在【应用管理】>【通知类别】菜单页面进行申请操作，详情请参见 [小米推送通知消息](https://dev.mi.com/console/doc/detail?pId=2086#_0_1)。

### 小米通知消息使用

目前小米通知消息只能通过 Rest API 进行下发，控制台暂不支持。
在 Rest API 请求参数 `Android` 结构体中设置 `xm_ch_id ` 参数，可实现小米通知渠道下发，详情请参见 [PushAPI](https://cloud.tencent.com/document/product/548/39064#.E8.AF.B7.E6.B1.82.E5.8F.82.E6.95.B0) 参数说明。
推送示例如下：

```json
{
    "audience_type": "token",
    "token_list": ["005c28bf60e29f9a***2052ce96f43019a0b7"],
    "message_type": "notify",
    "message": {
    "title": "小米通知消息",
    "content": "测试内容",
    "android": {
        "xm_ch_id": "小米通知消息的channel_id"
  }
}
```

<span id="vivozhinan"> </span>

## vivo 系统消息申请指南

### vivo 消息分类介绍

vivo 消息分类功能将推送消息类型分为运营消息和系统消息。

| 消息类别 | 量级         | 通知栏消息显示                   | 2020年6月1日后频控规则            |
| -------- | ------------ | -------------------------------- | --------------------------------- |
| 运营消息 | 1倍 SDK 订阅数 | 应用不存活时折叠，应用存活时外显 | 单应用单用户每天接收条数上限5条。 |
| 系统消息 | 1倍 SDK 订阅数 | 无论应用是否存活都外显           | 不限接收条数。                    |

> ?
>1. 2020年6月1日前，无论是否接入消息分类，频控规则不变，均按每个应用单用户“公共类消息（全推，群推，标签推）”每天接收上限为5条，不限制单推条数。2020年6月1日起，频控规则变更为按每个应用单用户“运营消息”接收条数上限5条进行频控，若出现用户体验类投诉，将会根据实际情况调整条数。
>2. Funtouch OS_10及以上版本没有消息盒子，应用不存活时窄条展示，具体样式以实际为准。
>3. 系统消息量级和运营消息量级均会随着SDK订阅数变化而自动变化，如特殊情况需额外提升系统消息量级，申请方法详见下方【vivo 系统消息申请】。
>4. 若某 vivo 用户当前接收运营消息超过5条，则当天触发限额后的运营消息均会通过 TPNS 通道下发，不再通过 vivo 通道下发。
>5. 若您已向 vivo 申请提升运营消息限额，请联系我们进行后台配置，否则限额变更无法生效。
>


### vivo 系统消息申请

1. 系统消息只能通过 vivo 服务端 API 接口创建，Web 端 vivo 运营平台暂不支持此功能。API 接口新增请求字段 `classification`，“0”代表运营消息，“1”代表系统消息，不填默认为0，详情请参见 vivo [服务端 API 文档](https://dev.vivo.com.cn/documentCenter/doc/362)。
2. 系统消息量默认是1倍的 SDK 订阅数，当系统消息不够时，可以邮件特殊申请实际需求的系统消息量级，按照下面的邮件模板填写信息后发送至邮箱：push@vivo.com。
```plaintext
主题：xxx应用申请增加im消息/系统消息发送量级
正文：……
应用名称：……
包名：……
应用简介：……
IM消息/系统消息需求量级（万）：……
具体推送场景说明：例如，用户个人聊天、商家聊天
```

### vivo 系统消息使用

目前 vivo 通知消息只能通过 Rest API 进行下发，控制台暂不支持。
在 Rest API 请求参数 `Android` 结构体中设置 `vivo_ch_id ` 参数为"1"，可实现 vivo 系统消息下发，详情请参见 [PushAPI](https://cloud.tencent.com/document/product/548/39064#.E8.AF.B7.E6.B1.82.E5.8F.82.E6.95.B0) 参数说明。
推送示例如下：

```json
{
    "audience_type": "token",
    "token_list": ["005c28bf60e29f9a***2052ce96f43019a0b7"],
    "message_type": "notify",
    "message": {
    "title": "vivo系统通知",
    "content": "测试内容",
    "android": {
        "vivo_ch_id": "1"
    }
}
```

<span id="huaweizhinan"> </span>

## 华为通知渠道使用指南

### 华为通知渠道介绍

华为推送从 EMUI 10.0版本开始将通知消息智能分成两个级别：**一般与重要**。EMUI 10.0之前的版本没有对通知消息进行分类，只有一个级别，消息全部通过“默认通知”渠道展示，等价于 EMUI 10.0的重要级别消息。

不同消息级别呈现样式对比：

| 消息级别 | 在通知中心的显示 | 在状态栏上显示 | 锁屏通知 | 响铃 | 振动 |
| -------- | ---------------- | -------------- | -------- | ---- | ---- |
| 重要     | 正常显示         | 支持           | 支持     | 支持 | 支持 |
| 一般     | 正常显示         | 否             | 否       | 否   | 否   |

分类规则：

- 从开发者发送的通知消息的标题与内容获取到消息的类别。
  消息类别包括但不限于如下：营销类、功能类、生活类、社交类、交易类、工作类、告警类、其他类。

- 根据得到的消息的类别映射得到消息的级别。
  消息级别划分为一般、重要两个级别。

  举例来说，应用发送的内容推荐（影音、阅读、视频类应用的资讯等），调研（发送问卷以获得到受访者的态度和意见）会智能划分为一般通知。物流状态信息，例如已发货、签收、派送中、取件等会智能划分为重要通知。

>! 通知智能分类仅在中国大陆终端设备上支持，海外暂不支持。

### 华为通知渠道创建

华为推送支持应用自定义通知渠道，客户端创建通知渠道，请选择以下任意一种方式创建：

1. 使用 Android API 创建通知渠道，详情请参见 Android 官方文档 [创建和管理通知渠道](https://developer.android.google.cn/training/notify-user/channels)。
2. 使用 TPNS SDK（1.1.5.4及以上的版本）创建通知渠道，详情请参见文档 [创建通知渠道](https://cloud.tencent.com/document/product/548/36659#.E5.88.9B.E5.BB.BA.E9.80.9A.E7.9F.A5.E6.B8.A0.E9.81.93)。

### 华为通知渠道使用

目前自定义渠道只能通过 Rest API 进行下发，控制台暂不支持，在您创建完成通知渠道后，可通过以下方式使用：

在 Rest API 请求参数 `Android` 结构体中设置 `hw_ch_id ` 参数，可实现华为通知渠道下发，详情请参见 [PushAPI](https://cloud.tencent.com/document/product/548/39064#.E8.AF.B7.E6.B1.82.E5.8F.82.E6.95.B0) 参数说明。

> ! 当您自定义 `hw_ch_id ` 字段时，TPNS 将为您自动设置华为推送下发通知的消息级别为“重要”；但遵照华为推送相关规则，最终展示效果仍将与华为推送智能分类计算出的级别共同决定，两者取低，例如：重要与一般取一般。详情请参见 [华为通知消息智能分类](https://developer.huawei.com/consumer/cn/doc/development/HMSCore-Guides/android-intelligent-classification-0000001050040120)。

推送示例如下：

```json
{
    "audience_type": "token",
    "token_list": ["005c28bf60e29f9a***2052ce96f43019a0b7"],
    "message_type": "notify",
    "message": {
        "title": "华为通知消息",
        "content": "测试内容",
        "android": {
            "hw_ch_id": "华为通知消息的channel_id"
        }
    }
}
```
