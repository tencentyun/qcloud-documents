OPush 平台针对个性化推送场景推出了不限量“私信”通道，开发者可以通过申请加入 OPPO 公私信公测。在完成私信通道的申请和创建后，可以通过 TPNS 服务端 API 推送，提高个性化推送的抵达率。
>?本文的“渠道”和“通道”是同一个概念。

## 通知渠道
从 Android8.0（API ≥ 26）开始，Android 要求开发者必须为所有的通知分配渠道，不同类的消息走不同的渠道发送。开发者可以设置每个渠道的通知行为，用户可以更改单个渠道的设置。此功能旨在解决以下问题：
- 越来越多的不重要应用通知给用户造成打扰。
- 用户可以选择性屏蔽部分通知，只接收自己认为重要的通知。


## OPPO 私信通道介绍
OPush 平台上默认的是公信通道，目前在原有基础上新增“私信”通道，对单个用户推送个性化信息时，不再受推送数量限制。以下是“公信”和“私信”的对比：

| 类型 | 公信 | 私信 |
| -------- | ---------------- | ------------ |
| 推送内容 | 热点新闻、新品推广、平台公告、社区话题、有奖活动等，多用户普适性的内容 | 个人订单变化、快递通知、订阅内容更新、评论互动、会员积分变动等，与单个用户信息强相关的内容 |
|推送对象 | 多个用户（也可单个用户推送） | 仅限单个用户   |
| 推送数量限制 | 所有公信类通道共享推送次数，当日达到次数限制后，所有公信类通道将不能再推送消息，目前单日推送数量为：累计注册用户数 * 2 | 不限量  |
| 配置方式 | 默认| 需要在 OPPO PUSH 运营平台上登记该通道，并将通道对应属性设置为“私信” |

>!OPPO 官方提醒：切记！一定不要利用私信通道用于普适性消息推送（如热点新闻、新品推广等），后台会实时监控，如违反运营规则，OPush 有权关闭您的私信通道权限。由此产生的后果，如调用接口异常，或使用私信通道发送的消息没到达用户等，由业务方自行承担。

## OPPO 私信通道申请
1. 进入 [OPPO开放平台](https://push.oppo.com)，在【应用配置】>【新建通道】中新建通道，通道 ID 与通道名称必填且需要与应用客户端保持一致，其他选项可不填。
![](https://main.qcloudimg.com/raw/20c0242e7558cdfac1bd6d6a79f0a219.png)
>!通道 ID 若一旦确定下来不能随意变更或被删除。
2. 目前 OPPO 私信通道需要邮件申请后才能生效，请按照以下要求发送邮件给 OPush 平台，详情参考 [OPPO PUSH通道升级公测邀请](https://open.oppomobile.com/wiki/doc#id=10614)。
```
公测申请条件：OPush 的累计用户数 ≥ 300,000即可申请加入公私信公测。
申请方式：发送邮件至 push@oppo.com 申请。邮件模板：
应用 ID：XXX
应用名称：XXX
累计用户数：XXX
私信专用通道名称：
私信专用通道 ID：
业务接口人联系微信：
XX应用申请接入 OPush 公私信公测，并承诺遵守运营规则，不使用私信通道推送任何营销消息。
```


## OPPO私信通道使用

1. 客户端创建通知渠道，请选择以下任意一种方式创建：
（1）使用 Android API 创建通知渠道，详见 Android 官方文档 [创建和管理通知渠道](https://developer.android.google.cn/training/notify-user/channels)。
（2）使用 TPNS SDK(1.1.5.4及以上的版本)创建通知渠道，详见文档 [创建通知渠道](https://cloud.tencent.com/document/product/548/36659#.E5.88.9B.E5.BB.BA.E9.80.9A.E7.9F.A5.E6.B8.A0.E9.81.93)。
2. Rest API 推送
在 Rest API 请求参数 Android 结构体中设置 `n_ch_id`、`n_ch_name` 参数，可实现根据通知渠道下发，具体参考 [PushAPI 参数说明](https://cloud.tencent.com/document/product/548/39064#.E8.AF.B7.E6.B1.82.E5.8F.82.E6.95.B0)。
>!目前 OPPO 私信通道通知只能通过 Rest API 进行下发，控制台暂不支持。

推送示例如下：

```
{
    "audience_type": "token",
    "token_list": ["005c28bf60e29f9a1c2052ce96f43019a0b7"],
    "message_type": "notify",
    "message": {
    "title": "测试标题",
    "content": "测试内容",
    "android": {
        "n_ch_id": "私信通道ID",
        "n_ch_name": "私信通道名称"}
  }
}

```
