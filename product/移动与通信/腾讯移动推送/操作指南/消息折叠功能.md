## 操作场景
在手机通知中心，当收到来自同一个 App 的多条通知时，系统会根据对应规则，将多条通知折叠起来，以免打扰用户。这样会减少 push 的曝光率，继而降低 push 运营的收益。
Android 原生系统和 iOS 系统都提供了相应设置方式，开发者可以根据业务的运营需求，通过此功能设置通知折叠分类，将相同类型的通知折叠在一起，提高通知的可读性。

## 适用范围

| 手机系统   | 系统版本 | SDK 版本| 推送通道 |
| -----------  | ------------|----------- -|------------ |
|Android| Android 7.0 +|TPNS SDK 1.2.0.1 + | TPNS 通道 |
|iOS| iOS 10 +|TPNS SDK 1.2.0.1 + | APNs 通道 |

## 操作步骤
### 	控制台使用
1. 登录 [移动推送 TPNS 控制台](https://console.cloud.tencent.com/tpns)，在左侧导航中选择【推送管理】>【推送任务】，单击【新建推送】>【高级设置】。
![](https://main.qcloudimg.com/raw/565e0fd7aa3f867d49dfc19369f1647b.png)
2. 设置消息折叠规则，如下图所示：
![](https://main.qcloudimg.com/raw/9b1a3112e801b9f4ecf1e3f59facaea8.png)
控制通知在设备通知中心是否折叠以及折叠方式有以下三种选项：
 - 系统默认：跟随操作系统的默认折叠规则
部分厂商系统规则如下：
	- 原生安卓：同一应用通知达到5条时折叠成一组。折叠时右侧数字为被折叠的未阅读通知总量，展开时最多显示8条通知内容。
	- 华为：同组通知达到2条时开始分组。折叠时右侧数字为被折叠的未阅读通知总量，展开时最多显示8条通知内容。
	- 小米：同组通知达到4条时开始分组，折叠时右侧数字为被折叠的通知数量（最大为7），展开时最多显示10条通知内容。
	-  魅族：同组通知达到4条时开始分组，折叠时顶部数字为通知总量，展开时可展示的通知条数很多，目前已知超过35条。
>?魅族手机提供的不重要通知功能，会将过多的通知收纳到右上角收纳盒子中，这些通知不会被折叠。可以通过在应用通知设置内开启“设为优先”来关闭此功能。
	-  OPPO：同组通知达到 4条时开始分组，折叠时右侧数字为被折叠的未阅读通知总量，展开时最多显示8条通知内容。
	-  vivo：同组通知达到 2条时开始分组，折叠时无数字显示被折叠的通知总量，展开时最多显示8条通知内容。
 - 不折叠：通知不会与相同应用其他通知折叠 。
 - 自定义：携带相同`thread_id`的通知会被合并折叠。
>?若通知优先级不高可通过设置此参数，将此类通知折叠，避免过多打扰用户，若通知比较重要希望用户优先看到，可设置为不折叠。

### Rest API 使用
若想要实现控制台“不折叠”和“自定义”的效果，则需要在 Push API `message` 字段中自定义设置 `thread_id` ，详情可参考 [PushAPI 可选参数](https://cloud.tencent.com/document/product/548/39064#.E5.8F.AF.E9.80.89.E5.8F.82.E6.95.B0) 说明。
推送示例如下：
```
{
    "audience_type": "token",
    "token_list": [
        "05da87c0ae******2dfa9e08d884aada5bb2"
    ],
    "message_type": "notify",
    "multi_pkg":true,
    "message": {
        "title": "推送标题",
        "content": "推送内容",
        "android": {
            "custom_content":"{\"key\":\"value\"}"
        },
        "thread_id":"活动_id",
		   "thread_sumtext":"运营活动"
				
    }
}
```
