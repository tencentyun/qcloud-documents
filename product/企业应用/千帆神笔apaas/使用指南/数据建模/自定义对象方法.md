## **功能简介**

在千帆神笔 aPaaS 中，  对象建模也引入了低码能力，支持用户自定义对象方法并在页面设计中调用。

 【使用须知】本功能属于平台高级能力，暂未全面开放，如您有意使用，请先邮件 plancklong@tencent.com 并提供您的租户 ID，平台审核通过后方可使用。 

## **新增对象方法**

1.找到对象右上角目录，打开【方法设置】，点击【添加方法】，填写方法名称、入参、出参、选择场景等。

![https://qcloudimg.tencent-cloud.cn/raw/80ad7571e1d2155c6b3d0dd0dd59ac84.jpg](https://qcloudimg.tencent-cloud.cn/raw/80ad7571e1d2155c6b3d0dd0dd59ac84.jpg)![https://qcloudimg.tencent-cloud.cn/raw/68a17cb140859e48a3da28453d418c83.jpg](https://qcloudimg.tencent-cloud.cn/raw/68a17cb140859e48a3da28453d418c83.jpg)

![https://qcloudimg.tencent-cloud.cn/raw/7e7c698107bca6dfebf0ca631a968330.jpg](https://qcloudimg.tencent-cloud.cn/raw/7e7c698107bca6dfebf0ca631a968330.jpg)

2.点击【Dataway表达式】进入到方法编码界面进行编码，编写完成后调试代码，调试成功后保存方法。

##### Dataway表达式简介：

- DataWay表达式兼容Python3语法，内置支持time，math， json，base64，random，hmac， hashlib等模块。

- dw_process（）作为入口函数，仅接受Message类型输入参数msg，返回值为DataWay表达式输出值。

- DataWay表达式捕出值仅支持bool，int，none，float，str，dict，list，Entity，MultiMap类型。

- msq包括id，seqid，vars，attrs，payload，error属性，可通过msg.xx访问，如msg.payload。

##### Dataway表达式编写指引：

https://help.apaas.cloud.tencent.com/docs/product/%E4%B8%93%E9%A2%98%E6%8C%87%E5%8D%97/DataWay

##### 常用内置模块函数：

- 查询函数：

  - 根据记录id查询详情： apaas.metadata.describeRecordByID(entityApiKey, recordId, token) 
  - 根据条件查询详情： apaas.metadata.describeRecordByCondition(entityApiKey, condition, token) 
  - 根据条件查询列表： apaas.metadata.describeRecordListByCondition(entityApiKey, condition, paging, token) 

- 创建/更新函数：

  - 创建记录： apaas.metadata.createRecord(entityApiKey, record, token) 

  - 创建记录： apaas.metadata.deleteRecordByID(entityApiKey, recordId, token) 

  - 更新记录： apaas.metadata.modifyRecordByID(entityApiKey, recordId, record, token) 

    

![https://qcloudimg.tencent-cloud.cn/raw/5be7fabd868ab3b8d4fe83c85798cbc4.jpg](https://qcloudimg.tencent-cloud.cn/raw/5be7fabd868ab3b8d4fe83c85798cbc4.jpg)

调试：

![https://qcloudimg.tencent-cloud.cn/raw/8edd315ea145e651d5cb102b752a2aba.jpg](https://qcloudimg.tencent-cloud.cn/raw/8edd315ea145e651d5cb102b752a2aba.jpg)

![https://qcloudimg.tencent-cloud.cn/raw/3d90b818ee38ac9e778b21845a7d8921.jpg](https://qcloudimg.tencent-cloud.cn/raw/3d90b818ee38ac9e778b21845a7d8921.jpg)



## **调用对象方法**

定义方法后，用户可在【页面设计】处，找到需要调用方法的页面，绑定某个按钮的点击事件，选择【自定义事件】后，编写代码调用刚才定义好的方法。

![https://qcloudimg.tencent-cloud.cn/raw/0d582d55b696dc3d3afe8060a37e79de.jpg](https://qcloudimg.tencent-cloud.cn/raw/0d582d55b696dc3d3afe8060a37e79de.jpg)![https://qcloudimg.tencent-cloud.cn/raw/323017153acf5d89dcc1742c9b9031a2.jpg](https://qcloudimg.tencent-cloud.cn/raw/323017153acf5d89dcc1742c9b9031a2.jpg)