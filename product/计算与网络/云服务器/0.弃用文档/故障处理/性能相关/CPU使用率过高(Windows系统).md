## 问题描述

CPU 使用率过高，容易引起服务响应速度变慢、服务器登录不上等问题。而引起 CPU 使用率过高的原因可能由硬件因素、系统进程、业务进程或者木马病毒等因素导致。您可以使用 [云监控](https://cloud.tencent.com/document/product/248/13466)，创建 CPU 使用率阈值告警，当 CPU 使用率超过阈值时，将及时通知到您。

## 排查思路
CPU 使用率过高排查的主要步骤为：
1. 定位消耗 CPU 的具体进程。
2. 对 CPU 占用率高的进程进行分析。
 - 如果是异常进程，可能是病毒或木马导致，您可以自行终止进程，或者使用安全软件进行查杀。
 - 如果是业务进程，则需要分析是否由于访问量变化引起，是否存在优化空间。
 - 如果是腾讯云组件进程，请 [提交工单](https://console.cloud.tencent.com/workorder/category) 联系我们进行进一步定位处理。

下面将介绍 Windows 系统如何定位 CPU 使用率过高的问题。

## 定位工具
- **任务管理器**：Windows 自带的应用程序和进程管理工具，展示有关电脑性能和运行软件的信息，包括运行进程的名称，CPU 负载，内存使用，I/O 情况，已登录的用户和 Windows 服务的信息。
- **进程**：系统上所有正在运行的进程的列表。
- **性能**：有关系统性能的总体统计信息，例如总体 CPU 使用量和正在使用的内存量。
- **用户**：当前系统上有会话的所有用户。
- **详细信息**：进程选项卡的增强版，显示进程的 PID、状态、CPU、内存的使用情况等进程的详细信息。
- **服务**：系统中所有的服务（包括并未运行的服务）。

## 处理步骤
### 通过 VNC 方式登录云服务器
1. 登录 [云服务器控制台](https://console.cloud.tencent.com/cvm/index)。
2. 在 “实例” 页面中，找到目标 CVM 实例，单击【登录】。如下图所示：
![](https://main.qcloudimg.com/raw/837d367b6ea081827c727b2d8cac0ae4.png)
3. 在弹出的 “登录Windows实例” 窗口中，选择【其它方式（VNC）】，单击【立即登录】，登录云服务器。

### 打开任务管理器
1. 根据您的实际操作习惯，选择打开任务管理器的方式。
 - 按快捷键 **Ctrl+Shift+Esc**。
 - 右键单击开始菜单栏，选择【任务管理器】。
 - 单击 <img src="https://main.qcloudimg.com/raw/87d894e564b7e837d9f478298cf2e292.png" style="margin: 0;">，选择 <img src="https://main.qcloudimg.com/raw/5b5e3abb2f39cb719a4119ba77b74447.png" style="margin: 0;">，输入 **taskmgr**，按 **Enter**。
2. 在打开的 “任务管理器” 窗口中，选择【详细信息】页签，单击【CPU】，以降序对 CPU 使用率进行排序。如下图所示：
![](https://main.qcloudimg.com/raw/1d679204fd1efd5e1358f454ccbdec3a.png)

### 分析 CPU 使用率过高的进程

CPU 使用率过高的进程主要分为以下类型：

####  系统进程

如果您发现系统进程占用大量 CPU 资源，请排查以下内容：
1. 仔细检查进程名。
部分病毒会通过使用跟系统进程相似的名称，迷惑您的眼睛。例如 svch0st.exe、explore.exe、iexplorer.exe 等。
2. 仔细检查进程对应的可执行文件的所在位置。
系统进程一般位于 `C:\Windows\System32`，并且会有完善的签名和介绍。
您可以在任务管理器中，右键单击待查看的进程，选择【打开文件位置】，即可查看具体可执行文件的位置。如下图所示：
![](https://main.qcloudimg.com/raw/09dca00652a301e804f9411658e4c46e.png)
如果进程位置不在 `C:\Windows\System32` 目录下，则表示服务器可能中了病毒，请手动或者使用安全工具进行查杀。

常见的系统进程如下：
- System Idle Process：系统空间进程，显示 CPU 空闲时间百分比
- system：内存管理进程
- explorer：桌面和文件管理
- iexplore：微软的浏览器
- csrss：微软客户端/服务端运行时子系统
- svchost：系统进程，用于执行 DLL
- Taskmgr：任务管理器
- Isass：本地安全权限服务

#### 异常进程

 如果占用大量 CPU 资源的是一些命名很奇怪的进程，则可能为木马病毒进程。建议您执行以下操作：
 1. 使用搜索引擎进行搜索，确认是否为木马病毒进程。例如 xmr64.exe（挖矿病毒）等。
 2. 确认后，使用安全工具进行查杀。
 
####  业务进程

如果发现占用 CPU 资源的是您的业务进程，例如 IIS、HTTPD、PHP、Java 等，建议进一步分析。
例如，判断当前业务量是否较大。
- 若业务量较大，建议您 [升级服务器配置](https://cloud.tencent.com/document/product/213/2178)。
- 若不升级服务器配置，可以考虑业务程序是否存在优化空间，请进行优化。

####  腾讯云组件进程

请 [提交工单](https://console.cloud.tencent.com/workorder/category) 联系我们进行进一步定位处理。


