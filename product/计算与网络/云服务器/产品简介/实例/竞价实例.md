## 什么是竞价实例
竞价实例（Spot）是云服务器 CVM 的一种新实例运作模式，它最核心的特点是折扣售卖和系统中断机制，即您可以以一定幅度的折扣购买实例，但同时系统可能会自动回收这些折扣售卖的实例。当您购买并获得一个竞价实例后，它的使用和按量计费的 CVM 实例基本毫无区别，包括控制台操作、远程登录、服务部署、关联 VPC 等。

- 相关链接：[常见问题 > 实例类 > 竞价实例](https://cloud.tencent.com/document/product/213/17817)
- 相关链接：[如何购买竞价实例](https://cloud.tencent.com/document/product/213/17926)

## 当前阶段特殊策略
- **固定折扣比例**：所有规格的竞价实例将以固定折扣出售。按同规格按量计费实例20%的价格出售，少量类型的实例可能微调。
- **系统主动中断（库存波动）**：当前阶段，系统暂不会因为市场价格大于用户出价的原因产生中断，但是会因为竞价实例资源池库存不足而产生中断。当库存不足时，系统会从已分配的竞价实例里随机回收。
- **全地域上线**：竞价实例已在腾讯云绝大部分地域上线，支持实例类型与按量计费模式同步，最新地域和实例类型请查看 [竞价实例 - 竞价实例支持地域和类型 >>](https://cloud.tencent.com/document/product/213/17817#.E5.BD.93.E5.89.8D.E7.AB.9E.E4.BB.B7.E5.AE.9E.E4.BE.8B.E6.94.AF.E6.8C.81.E5.93.AA.E4.BA.9B.E5.9C.B0.E5.9F.9F.E5.92.8C.E5.AE.9E.E4.BE.8B.E7.B1.BB.E5.9E.8B.E5.8F.8A.E8.A7.84.E6.A0.BC.EF.BC.9F)。

## 产品特点
### I. 高性价比
![](https://main.qcloudimg.com/raw/9ff933a9f597d0df46f44437980fb13b.png)
竞价实例以按量计费实例的折扣价出售，最低1折。
- **折扣幅度**：竞价实例的价格以同规格按量计费实例为基准，在此之上进行折扣售卖，折扣区间为10%到原价。
- **折扣涉及部分**：折扣仅涉及云服务器 CPU 和内存部分，其他部分如系统盘、数据盘、带宽、收费镜像等云服务器关联收费项均不受竞价折扣影响。
- **价格波动**：这个折扣比例在一段时间内是稳定的，但是当可用区发生大规模购买行为时，价格会产生波动（当前阶段，折扣比例将固定为2折）。

### II. 系统中断机制
![](https://main.qcloudimg.com/raw/1098ebe6094a57d17beab5e23954a602.png)
不同于按量计费和包年包月实例只能由用户主动释放，竞价实例会被系统后台中断，系统会根据当前价格和资源池存量等综合情况判断是否中断已分配的竞价实例。
![](https://main.qcloudimg.com/raw/a1dab91390022aa00be10b5bcea7b05a.png)
- **价格原因中断**：当市场价格大于您的最高指定出价时，实例将会被回收（当前阶段，市场价格将会固定）。
- **库存原因中断**：当该类型资源池库存整体紧张时，系统将根据缺口回收竞价型实例；当库存恢复时，您又可以申请到竞价实例。

## 不适用场景
由于系统中断机制的存在，您并不能完全掌握实例的生命周期，所以建议避免在竞价实例上运行对稳定性要求极高的服务，例如：
- 数据库服务
- 没有采用负载均衡的在线服务、网站服务
- 分布式架构里的核心主控制节点
- 长时间（10+小时）的大数据计算作业

## 适用场景和行业
### 适用场景
- 大数据计算
- 采用了负载均衡的在线服务和网站服务
- 网络爬虫业务
- 其他细粒度或支持断点续算的计算场景

### 适用行业
- 基因测序和分析
- 药物晶型分析
- 视频转码、视频渲染
- 金融、交易数据分析
- 图片和多媒体处理
- 科学计算（地理、流体力学等）

## 限制
- **配额限制**：不同于云服务器的台数限制，竞价实例以用户在可用区下拥有的所有竞价型实例的 vCPU 核心数之和作为配额限制指标，当前阶段每个账号每个可用区最多可拥有50个 vCPU 核心之和的竞价实例（如需提升配额可通过工单申请）。
- **操作限制1**：竞价实例不支持升降配置。
- **操作限制2**：竞价实例不支持转包年包月。
- **操作限制3**：竞价实例不支持关机不收费。
- **操作限制4**：竞价实例不支持重装系统。

## 最佳实践
### I. 切分任务粒度
- 长时间作业拆成细粒度的作业，减少被中断可能性。
- 使用类似 EMR 这样天然具有切分思维的大数据套件。

### II. 通过负载均衡在保证在线和网站服务的稳定性
- 接入层使用负载均衡，例如 CLB。
- 后端资源采用部分按量计费实例 + 大量竞价实例的配比模式。
- 监听竞价实例中断情况，从 CLB 中移除即将中断的实例。

### III. 支持断点续算的计算调度模式
- 将计算中间结果放到 COS/CFS/NAS 等永久存储产品上。
- 通过 Metadata 感知即将中断的实例，在2分钟保留期内将计算结果保存。
- 待竞价实例再次启动时，继续上一次的运算。
