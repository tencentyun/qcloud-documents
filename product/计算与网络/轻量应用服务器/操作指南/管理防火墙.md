## 操作场景
防火墙是保障轻量应用服务器实例网络安全的重要手段，所提供的安全防护作用等同于云服务器中的安全组。您可以通过配置防火墙规则，允许或禁止轻量应用服务器实例对公网或私网的访问。
>? 防火墙只能对实例的入流量进行控制，出流量默认允许所有请求。
>

## 防火墙规则
### 配额限制
每个轻量应用服务器的实例可创建的防火墙规则数量限制：**100个**

### 组成部分[](id:CompositionDescription)
轻量应用服务器实例的防火墙中可以包含多条防火墙规则。每条防火墙规则包括如下组成部分：
<table>
<tr>
<th width="10%">组成部分</th><th>说明</th>
</tr>
<tr>
<td><b>应用类型</b></td>
<td>
<ul class="params">
<li>自定义：您可以按需定义协议和端口。</li>
<li>预置的应用类型：提供常用的防火墙规则模板，如 Windows登录(3389)、Linux登录(22)等。若选择预置的应用类型，则对应的协议和端口将会自动填入且不可修改。</li>
</ul>
</td>
</tr>
<tr>
<td><b>来源</b></td>
<td>指定的单个 IPv4 地址或 IPv4 地址范围。</td>
</tr>
<tr>
<td><b>协议</b></td>
<td>协议类型，可选择 TCP、UDP、ICMP 其中一种。</td>
</tr>
<tr>
<td><b>端口</b></td>
<td>协议端口，指定的单个或多个端口。</td>
</tr>
<tr>
<td><b>策略</b></td>
<td>
<ul class="params">
<li>允许：放行该端口相应的访问请求。</li>
<li>拒绝：直接丢弃数据包，不返回任何回应信息。</li>
</ul>
</td>
</tr>
<tr>
<td><b>备注</b></td>
<td>自定义，简短地描述规则，便于后期管理。</td>
</tr>
</table>

### 规则优先级
- 防火墙内规则具有优先级。
规则优先级通过规则在列表中的位置来表示，列表顶端规则优先级最高，最先应用；列表底端规则优先级最低。
- 若有规则冲突，则默认应用位置更前的规则。
- 当有流量进入对应防火墙的实例时，将从防火墙规则列表顶端的规则开始逐条匹配至最后一条。如果匹配某一条规则成功，允许通过，则不再匹配该规则之后的规则。
若您需调整防火墙已有规则优先级，请参考 [修改防火墙规则优先级](#AdjustPriority)。

## 操作步骤
>?您可参考此步骤添加或删除防火墙规则，修改立即生效。

### 添加防火墙规则

1. 登录 [轻量应用服务器控制台](https://console.cloud.tencent.com/lighthouse/instance/index)，选择并进入该实例的详情页。
2. 在实例详情页中，选择【防火墙】页签，并单击【添加规则】。如下图所示：
![](https://main.qcloudimg.com/raw/dbeee387c50cb9a743d2090f3ec80e33.png)
>? 轻量应用服务器创建后，默认放通 ICMP 协议，默认开启80端口（ HTTP 服务）、443端口（ HTTPS 服务）、22端口（ Linux SSH 服务）和3389端口（ Windows RDP 服务）。
>
3. 在弹出的“创建新的规则”窗口中，参考以下信息进行添加。如下图所示：
本文以添加放通来源 IP 为`192.168.1.1`，协议类型 `TCP`，端口为`3306-20000`的规则为例。请您结合实际情况进行操作，规则参数说明请参见 [组成部分](#CompositionDescription)。
![](https://main.qcloudimg.com/raw/8d528e8c7e02ae482113f41a341b40af.png)
 - **应用类型**：本文需自行设置协议类型及端口，则选择“自定义”。
 - **限制来源**：本文需限制源 IP，则勾选“启用”。
 如不勾选启用，则该规则对所有 IPv4 源地址均生效。 
 - **源IP地址**：防火墙规则仅对输入的源 IP 地址生效。支持以下输入格式：
    - **指定单个 IP**：例如 `192.168.1.1`。
    - **指定 CIDR 段**：例如 `192.168.1.0/24`。
    - **所有 IPv4 地址**：`0.0.0.0/0`。
 - **协议**：可选择 TCP、UDP 或 ICMP，本文以选择 “TCP” 为例。
 - **端口**：可指定单个或多个端口，范围需在1到65535之间，多个端口范围之间使用符号 `,` 进行分隔。端口支持格式如下：
    - **单个端口**：例如 `80`。
    - **多个离散端口**：例如 `80,443`。
    - **连续端口**：例如 `3306-20000`。
    - **所有端口**：`ALL`。
 - **策略**：默认选择“允许”。
    - **允许**：放行该端口相应的访问请求。
    -  **拒绝**：直接丢弃数据包，不返回任何回应信息。
 - **备注**：自定义，简短地描述规则，便于后期管理。
5. 单击【确定】即可添加防火墙规则。


### 删除防火墙规则
1. 登录 [轻量应用服务器控制台](https://console.cloud.tencent.com/lighthouse/instance/index)，选择并进入该实例的详情页。
2. 在实例详情页中，选择【防火墙】页签。
3. 在【防火墙】页签中，选择需要删除的防火墙规则所在行右侧的【删除】。如下图所示：
![](https://main.qcloudimg.com/raw/f7f84201f84a39bd20e2b44bce0bf9c2.png)
4. 在弹出的提示框中，单击【确定】，即可删除对应的防火墙规则。


## 相关操作
### 修改防火墙规则优先级[](id:AdjustPriority)
1. 登录 [轻量应用服务器控制台](https://console.cloud.tencent.com/lighthouse/instance/index)，选择并进入该实例的详情页。
2. 在实例详情页中，选择【防火墙】页签，并单击【排序】。
3. 选择需调整规则前的<img src="https://main.qcloudimg.com/raw/1b4e7395b052e5ce8f60d973c7db72b8.png" style="margin:-4px 0px">，拖动至所需位置后松开鼠标。如下图所示：
![](https://main.qcloudimg.com/raw/488d644b4e7a56b00b65d4cefebdd6b8.png)
4. 单击列表下方【保存】即可完成防火墙规则优先级调整。

<style>
.params{margin-bottom:0px !important}
</style>
