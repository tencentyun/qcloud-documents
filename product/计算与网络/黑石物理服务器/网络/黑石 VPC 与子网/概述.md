### VPC 私有网络
私有网络（Virtual Private Cloud）能帮助您在黑石构建出独立的网络空间，与您在数据中心运行的传统网络极其相似，但是托管在黑石私有网络内的是您在黑石上的服务资源，包括：物理服务器、负载均衡、数据库等黑石服务资源。黑石私有网络为您提供以下功能：
- 通过控制台和 API 自定义网段划分、IP 地址等
- 通过弹性公网 IP 、NAT 网关等灵活访问 Internet
- 通过 VPN 和专线接入将私有网络与您的数据中心连通
- 通过对等连接服务可实现全球同服和两地三中心容灾

用户在创建 VPC 时，需要以无类域间路由（CIDR）块（例如 10.0.0.0/16）的形式为 VPC 指定 IP 地址组。黑石私有网络有可用区属性，比如 VPC A 处于广州一区，用户无法跨可用区创建 VPC 。

### 子网
子网是 VPC 内的 IP 地址块，私有网络中的所有黑石资源都必须部署在子网内。子网具有可用区属性，如下图所示，在创建 VPC 后，您可以在私有网络所属可用区中添加子网。可用区设计目的是隔离其他可用区的故障，通过启动独立可用区内的实例，您可以保护您的应用程序不受单一位置故障的影响。
![](https://main.qcloudimg.com/raw/4b27c9dfac31fed19e0849f701faed35.png)

### 私有网络的 IP 地址
您可以通过指定 CIDR（无类别域间路由）实现对私有网络和子网整体 IP 划分，黑石私有网络中使用的 IP 地址分为三类：
- 内网IP地址，是 VPC 内的物理服务器必须指配的 IP 地址，用于 VPC 中物理服务器之间的通信，无法用于 Internet 通信
- 公网 IP 地址，是用于 Internet 访问的 IP 地址，并可用于物理服务器与 Internet 之间或与其他具有公共终端节点的腾讯云资源（如 CDB 等）之间的通信
- 弹性 IP（EIP），是可以独立申请的公网 IP 地址，支持与 物理服务器/NAT 网关实例的动态绑定和解绑

### CIDR
CIDR（无类别域间路由，Classless Inter-Domain Routing）是由用户指定的独立网络空间地址块，通过 IP 和掩码结合，实现对网络的整体划分。以 10.1.0.0/16 为例，斜杠左边为网络块的 IP，斜杠右边为网络块的掩码。通过设定掩码的大小就可以调整网络块的大小。网络块包括的 IP 数 = 2^(32-掩码)，因而 10.1.0.0/16 网络块最多包含 65536 个 IP 地址。

目前私有网络支持三个网段内网IP：
- 10.0.0.0 - 10.255.255.255 (10/8 前缀)
- 172.16.0.0 - 172.31.255.255 (172.16/12 前缀)
- 192.168.0.0 - 192.168.255.255 (192.168/16 前缀)
掩码范围：允许最小为 /16 掩码，最大为 /28 掩码

在规划 CID R时需要注意：
- 私有网络在创建时候必须指定 CIDR，创建后不可修改
- 子网的 CIDR 必须是所在私有网络 CIDR 的一部分
- 子网的 CIDR 掩码范围小于 /22 时，由于 Linux 操作系统的 ARP 表项默认阈值是 1024，可能导致操作系统 ARP 表溢出，可通过调大 net/ipv4/neigh/default/gc_thresh 值解决
- 建立对等连接的私有网络之间的 CIDR 不能重叠
- VPN 连接中每条 SPD 策略对应一个本端网段（私有网络网段）和对端网段（您的 IDC 网段），本段网段和对端网段不能重叠

