


>?
- 云函数 SCF 计划于2021年01月29日起进行日志服务升级，接入腾讯云日志服务 CLS，此后新增函数需要指定日志投递主题或使用默认投递日志能力。具体操作请参见 [操作指引文档](https://cloud.tencent.com/document/product/583/39536)。
- 本次变更对存量函数无影响，存量函数日志迁移到 CLS 预计于2021年02月中下旬启动。






## 背景

腾讯云 [日志服务 CLS](https://cloud.tencent.com/document/product/614) 提供一站式的日志数据解决方案。您无需关注扩缩容等资源问题，五分钟快速便捷接入，即可享受从日志采集、日志存储到日志内容搜索、统计分析等全方位稳定可靠的日志服务。CLS 可帮助您轻松解决业务问题定位、指标监控、安全审计等日志问题，降低日志运维门槛。

SCF 接入 CLS 后，函数日志可支持：

- **实时索引**：采集的日志数据实时建立索引，构建成功即可检索。
- **灵活检索**：支持全文检索、多关键词检索、范围检索、模糊检索等功能。
- **灵活投递**：可自定义日志投递位置和日志存储周期，支持将指定日志投递至其他云产品中，满足存储或其他计算需求。例如，在指定的 COS 存储桶中，对日志进行生命周期管理等，满足日志审计需求。

## SCF 日志服务升级详情

- 自2021年01月29日起，新建函数如未指定日志投递主题将使用默认投递日志能力，函数调用日志将按照函数日志配置投递到指定主题。
- 默认投递日志时，SCF 将会为您开通日志服务并将函数调用日志投递至 SCF 专用日志集下的日志主题中，SCF 专用日志集和日志主题分别以 `SCF_logset` 和 `SCF_logtopic` 为前缀命名，如不存在将自动创建。函数调用日志默认保留 7 天，您可在 [日志服务控制台](https://console.cloud.tencent.com/cls/logset) 查看及管理。
- 腾讯云日志服务 CLS 商业化后，腾讯云仍旧为所有用户在每个地域提供一定量的免费额度，SCF 专用日志主题将会占用该免费额度，日志计费详情请参见 [CLS 计费指引](https://cloud.tencent.com/document/product/614/47116)。
- 在发布窗口期（2021年01月25日 - 2021年01月29日）SCF 投递至 CLS 的日志格式将按地域逐步调整，更新后的日志格式请参见 [操作指引文档](https://cloud.tencent.com/document/product/583/39536)，相比于当前投递到 CLS 的函数日志格式，增加了字段 `SCF_LogTime`，`SCF_Duration`，`SCF_MemUsage`，`SCF_StatusCode` 和 `SCF_RetryNum`，下线了字段 `SCF_Index`。
- SCF 日志接入 CLS 后，依然为异步调用的函数保留返回数据。返回数据将写入 `SCF_Message`，格式为 `Response RequestId:xxx RetMsg:xxx` 。
>! SCF_Message 的值长度限制为8KB，超出时将截取前8KB。



