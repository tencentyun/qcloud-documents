
## 重试策略
在函数调用的过程中，可能有多种原因导致函数调用失败。云函数平台内置了重试策略，可对调用失败的事件自动进行重试。重试策略如下：

### 平台级错误
**错误类型**：平台内部错误、计算资源不足等。

**重试策略**：持续重试，当无服务器云函数（SCF）后台收到告警后，对目前调用失败的事件会先按指数退避进行重试。当重试间隔超过1小时，每隔1小时重试一次，持续重试24小时。如果用户配置了死信队列，超过时间仍失败的事件会被发送到死信队列由用户进行进一步处理，否则，事件将被函数平台删除。

### 用户级错误
**错误类型**：代码报错、执行超时、资源超限等。

**重试策略**：调用失败后，函数将自动重试两次，第一次与原事件间隔1min，第二次与第一次间隔2min。在自动重试的同时，函数仍可正常处理新的触发事件。如果配置了死信队列，三次失败后的事件将传入死信队列，否则，事件将被函数平台删除。

## 死信队列
根据无服务器云函数的重试规则，重试超过次数限制仍失败的事件会被丢弃或传送至用户指定的 CMQ 主题或 CMQ 队列。死信队列由用户自行配置，用于收集错误时间信息、分析失败原因。未配置死信队列的函数将在重试次数用尽后丢弃事件。

### 死信队列消息属性
- **RequestID**：事件唯一标识
- **ErrorCode**：事件错误码
- **ErrorMessage**：错误信息

## 死信队列创建流程
>?无服务器云函数目前支持 CMQ 的主题模式和队列模式作为死信队列，您可自行选择配置。
>
1. 登录 [CMQ 消息队列控制台](https://console.cloud.tencent.com/cmq/index?rid=1)，创建您的死信队列。
>!选择主题模式时，由于筛选条件的设置，DLQ 信息可能无法通过 Topic 到达其目标。CMQ 支持标签过滤与路由匹配两
>种筛选方案，为了确保您的订阅者可以收到所有错误信息，请在添加订阅者时标签栏筛选设为**空**，BindingKey 筛选
>填**“#”**。
>
2. 登录 [云函数控制台](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)，创建您的函数。
 函数的运行角色必须拥有 CMQ 的 Topic 与 Queue 访问权限，SCF 默认运行角色已为您配置此权限。如果使用自定义角色，请注意添加权限，您可以在“新建函数”页面或“函数配置”页面进行死信队列的配置。




