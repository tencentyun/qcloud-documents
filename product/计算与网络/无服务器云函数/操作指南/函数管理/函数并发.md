云函数是通过并发实例来进行请求或事件的处理，本文中将并发实例称为并发或实例。

## 并发工作说明
云函数当前的一个并发实例在同一时刻仅处理一个事件。且在当前事件未处理完成返回到并发实例之前，后续事件或请求不会进入当前并发实例。在云函数平台接收到同步请求或异步请求，传递至并发实例进行处理时，均按照此逻辑执行。详细说明如下：
- **异步请求**：异步事件会先进入云函数平台的队列，并按照先进先出的原则依次处理异步请求。异步请求会根据队列长度、当前函数并发数等情况，选择合适的并发处理方式，拉起足够处理事件的并发依次处理事件。
- **同步请求**：同步事件到达云函数平台后，平台将会检测是否有空闲并发实例。如有，则事件将会立刻发送给空闲并发实例进行处理。如没有，则平台将会启动新的并发实例来处理事件。


## 并发限制
- 当前单一函数的总并发数限制为300，即一个函数最多启动300个并发实例。
- 并发实例数限制由函数的多个版本共享，即如果已有函数版本1的200个并发在使用中，则函数版本2仅支持再启动100个并发。


## 并发扩容
在函数当前的并发实例不足以处理请求事件时，云函数平台将会启动新的并发实例来处理事件。

新并发的扩容速度，按账号在地域维度上限制为500个/分钟，即在1分钟内，最多可以启动500个新的并发实例。如在1分钟内已经达到了当前限制，则将无法再启动新的并发实例，持续到下1分钟。在此期间有新的并发扩容请求，将会产生扩容受限错误。

## 并发复用
当并发实例处理完成事件请求后，不会立刻被回收，而是按照一定的时间进行保留。在并发实例保留期间，如有新的请求事件需要处理，将会优先使用保留中的并发实例，从而实现事件的快速处理，不用等待重新启动新的并发实例。并发保留的时间由云函数平台根据情况动态调整，故函数业务代码中不能假设某个特定保留时间进行程序编写。


## 并发监控

函数的并发在处理实际请求时，该并发会被标记为执行并发。从云函数的监控中，可以查询到函数、函数某个具体版本、别名的执行并发。由于执行并发的采集有一定的时间间隔，如函数的执行时间很短而并发较高，则当前监控可能会有一定偏差。
