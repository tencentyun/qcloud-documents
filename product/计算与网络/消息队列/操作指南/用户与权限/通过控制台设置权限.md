## 操作场景
本文以指定某用户拥有 CMQ 队列模型的 **消费消息及批量消费消息写权限** 为例，演示如何设置 CMQ 权限。

## 权限说明
接入 CAM 后，子账号除了可以查看 list ，默认是没有其他操作权限的（登录控制台用的是子账号的密钥），需要主账号通过 CAM 授权，才有访问权限。

控制台会调用 CMQ API 接口，因此子账号需要在控制台查看队列、主题、订阅信息时需要对控制台调用的 CMQ API 接口授予权限，否则子账号查看控制台会报没有权限的错误。不同的控制台界面所需要授权的接口如下：
- 控制台查看队列列表： 授权 ListQueue 接口
- 控制台查看主题列表： 授权 ListTopic 接口
- 控制台查看订阅列表： 授权 ListSubscriptionByTopic 接口

子账号如果要访问 CMQ 控制台，需要主账号授予其对应的接口权限。**子账号通过控制台查看监控数据需要对云监控接口进行 CAM 授权**。


## 操作步骤
### 创建子用户
1. 登录【[访问管理控制台](https://console.cloud.tencent.com/cam)】>【用户】>【用户列表】，单击左上角的【新建用户】。
2. 在新建用户页面，您可以通过快速创建、自定义创建、微信/企业微信导入三种方式创建子用户，具体操作方法请参考访问管理的 [新建子用户](https://cloud.tencent.com/document/product/598/13674) 文档。
3. 在【用户】>【用户列表】中，即可查看已添加的子用户。


### 新建自定义策略
您可以创建某自定义策略指定开启具体 API 接口的权限，下面以指定 CMQ Queue 的写权限（消费消息、批量消费消息）为例：

1. 登录【访问管理】>【[策略](https://console.cloud.tencent.com/cam/policy)】，单击左上角的【新建自定义策略】。
2. 在选择创建策略方式中，选择**按产品功能或项目权限创建**，进入配置服务类型页面。
3. 在配置服务类型中，填写策略名（如 consumer_policy），在列表中找到并勾选队列模型（没有找到请确认是否已经开通 CMQ 服务），完成后单击【下一步】。
![](https://main.qcloudimg.com/raw/ed39239d7db66d6f035087cf9c33156f.png)
4. 在开启权限中，开启消费消息、批量消费消息的权限，完成后单击【下一步】。
![](https://main.qcloudimg.com/raw/46196697154e13a04556262a55998819.png)
5. 在关联对象中，对已开启的权限配置策略的关联对象，可以选择“所有对象”，或者选 “按对象” 后选择某个队列，选择完毕后单击【确定】，完成配置。
6. 单击【完成】，即可完成自定义策略创建。

关于 CAM 策略的其他详细说明可参考 [策略](https://cloud.tencent.com/document/product/598/10601) 文档。
>?CMQ 的 list 接口权限默认全部开放（即登录 CMQ 的控制台，可以在控制台看到具体的资源列表），具体查看的资源内容可以通过权限控制。

### 子用户登录
使用子账号登录后，若找不到对应的资源，请在控制台右上角，单击切换协作者开发商帐号。
![](https://main.qcloudimg.com/raw/80bab30f645d17f8b728927e85a01501.png)
