## 产品概述

腾讯云消息队列（Cloud Message Queue，以下简称CMQ）是分布式的消息队列服务，用于存储进程间传输的消息，为分布式部署的不同应用之间或者一个应用的不同组件之间提供基于消息的可靠的异步通信服务。消息被存储在高可靠、高可用的消息队列中，多进程可以同时读写，互不干扰。使用腾讯云CMQ，用户可以在执行不同任务的应用程序的分布式组件之间传递信息，既不会丢失消息，也不要求各个组件始终处于可用状态。

队列在数据发送端以及数据接收端之间起到缓冲作用。这样，在数据发送端的工作速度快于数据接收端的情况下，或者在数据发送端或数据接收端仅间歇性地连接到网络的情况下，队列可解决因此而产生的问题。

消息队列中的“消息”指同一台计算机/不同计算机的进程间传送的数据，“消息队列”是在消息的传输过程中保存消息的容器。消息被发送到队列中，队列充当中间人将消息从它的源中继到它的目标。

下图是一个描述传统进程通信模式的例子：传统的进程通信模式由客户端请求服务器端的服务并等待服务器的响应。然而这种模式有很多弊端，比如当网络状况不好的情况下客户端的请求可能会丢失；又如服务器端处理时间过长可能导致客户端长时间等待以致请求超时而失败等。
![](//mccdn.qcloud.com/static/img/6c066f82f7e94e6ee58c782325860c02/image.jpg)

为此，腾讯云引入了消息队列服务进行消息分发和管理。使用腾讯云CMQ，您可以分离应用程序的组件以便其独立运行，同时还可以简化组件间的消息管理。分布式应用程序的任何组件均可将消息存储在队列中，腾讯云 CMQ 确保每条消息至少传送一次，并且支持多次读取和写入。单个队列可由多个分布式应用程序组件同时使用而无需这些组件之间的互相协作。所有组件均可使用 CMQ API 以编程方式检索和操作消息。


## 应用场景概述


在需要进行异步通信的应用情景中推荐使用CMQ。例如：

- 应用需要确保消息的可靠传递，即使发送消息时接收者由于断电、宕机或cpu负载过高等原因不可用，消息也可以在接收者可用时被送达。传统的消息队列把消息储存在内存中，故而不具备这一功能。腾讯云CMQ分布式消息队列中的消息会被持久化保存，直到接收者成功获取它。

- 需要在访问量与日俱增、囤积在队列中的消息数日益增长的情况下也能正常运转。传统的消息队列把消息存在本地内存中，单机的处理能力和内存容量都是有限的，不具备可扩展性。腾讯云CMQ的分布式架构保证了其扩容的简易性，更重要的是扩容对CMQ的使用者是完全透明的。

- 两个服务在网络不能互通或者应用的路由信息（比如ip和端口）不确定的情况下需要通信。例如，两个腾讯云上的服务在不知道对方地址的情况下需要进行通信，则可以通过约定队列名，一个向队列发送消息，一个从队列中收取消息而实现。

- 系统组件之间或者应用之间通信较多，需要组件或者应用自身维护彼此的网络连接，而且通信的内容不仅一种。这时，使用传统的架构会使得系统设计复杂。例如：当有一个中央处理服务需要向多个任务处理服务分派任务时（类似于master-worker模式），master需要维护与所有worker的连接，并判断worker是否开始处理任务从而决策是否需要重新分派任务。同时，worker的任务结果也需要汇报给master。要在一个层面维护这样的系统会导致设计复杂，实现难度和维护成本大。如下图所示，使用腾讯云CMQ减轻两方的之间耦合性会使系统简洁高效许多。
![](//mccdn.qcloud.com/static/img/c39a0f8227943738dceb85575f56e4eb/image.jpg)

- 系统组件之间或者应用之间耦合较紧，尤其对依赖的组件可控性较弱的情况下，希望降低耦合度。比如公司业务CGI收到用户提交的内容，将部分数据存储在自身的系统中，并将处理后的数据转发给其他业务应用（如数据分析系统、数据存储系统等）。传统的解决方案是服务间通过socket建立连接，此时如果接收方的IP或端口改变，或换了另一个接收方，则需要数据发送者进行修改。使用腾讯云CMQ，发送者和接收者对彼此信息无感知，耦合度大大降低。
