>?
>- 目前 CMQ 正在全面升级中（预计2020年9月完成），升级后将作为一款新型消息队列产品推出。
>- 新版的消息队列计费模式基本和旧版 CMQ 保持一致，我们会尽量减少原有客户迁移至新队列后在使用成本上受到的影响。

现阶段，腾讯云消息队列 CMQ 在队列服务和主题模式的请求次数费用与消息堆积费用均为免费。
2020年4月3日至2020年10月31日期间，CMQ 减免公网访问产生的流量费用，优惠结束后将按照以下方式收取。
- 如果您是公网访问 CMQ 服务，公网入流量费用免费，公网出流量将会产生流量费用，具体流量费用请参照 [公网计费模式（按流量计费）](https://cloud.tencent.com/document/product/213/10578#.E8.AE.A1.E8.B4.B9.E7.B1.BB.E5.9E.8B) 。
- 如果您是内网访问 CMQ 服务，出流量和入流量均免费（推荐您使用内网访问）。
 
## Queue 价格
**费用组成**：请求次数费用 + 消息堆积费用 + 出流量费用。
**计费方式**：所有费用按地域分别收取，每小时进行一次结算。

>!当前 CMQ 的请求次数费用和消息堆积费用暂未正式扣费。正式扣费前将通过邮件、短信通知您，请各位开发者放心使用。


### 请求次数
单地域下，用户开通 CMQ 服务后，腾讯云将对**每小时**内消息队列的 API/SDK 请求次数进行统计。请求次数以百万为单位，精确到小数点后两位。请求次数单价为**2.00元/百万次**，每小时结算一次。

#### 示例1
2016年5月20日16:00 - 17:00，用户总请求次数为1,323,454次。则计算的请求次数为1.32（百万次），本时间段请求次数费用为1.32 × 2.00 = 2.64元。
#### 示例2
2016年5月20日18:00 - 19:00，用户总请求次数为181,000次。则计算的请求次数为0.18（百万次），本时间段请求次数费用为0.18 × 2.00 = 0.36元。

### 消息堆积（包括消息回溯）
每小时 CMQ 将对单地域下的所有消息收取堆积费用，计算公式如下：
```
堆积消息费用 ＝ 消息总数 × 堆积消息单价
```
其中堆积消息单价为**0.010元/百万条/小时** 。消息总数的统计以百万为单位，单小时内消息总数是每分钟消息堆积总数的平均数（即每小时抽取60个点取平均值）。计算精确到小数点后两位。消息回溯费用会合并在消息堆积费用里，一起计算。

#### 示例
2016年5月20日16:00 - 17:00，A 队列的堆积消息总数量为1,323,450条，则本段时间内 A 队列的消息堆积费用为 0.01 × 1.32 = 0.01元。

### 出流量
腾讯云网络流量计费原则：入流量免费，出流量计费（现阶段，公网流量费正常收取，建议您使用内网 API 地址进行内测）。

| 流量类型 | 定义 | 用量 |单价 |
|---------|---------|---------|---------|
| 入流量 | 数据传入至 CMQ |所有 |免费 |
| 内网出流量（同地域） | 同一个地域内的业务系统，使用消息队列的内网域名从 CMQ 主动获取数据或 CMQ 主动推送数据至此业务系统，产生的流量（经由腾讯云内网） |所有 |免费 |
| 外网出流量 | 同一个地域内的业务系统，使用消息队列的 Internet 域名从 CMQ 主动获取数据或 CMQ 主动推送数据至此业务系统，产生的流量（经由 Internet） |所有 |中国大陆（内地）：0.80元/GB；中国香港：1.00元/GB；其他地区：0.50元/GB |

## Topic 价格
**费用组成**：API 请求费用 + 消息堆积费用 + 出流量费用
**计费方式**：按量计费（按小时计费）、分地域（所有费用按地域，分别收取）
>!当前 CMQ 的 API 请求费用和消息堆积费用暂未正式扣费。正式扣费前将通过邮件、短信通知您，请各位开发者放心使用。


### API 请求
- 当前允许发布的消息最大限制为64KB，每64KB区块的已发布数据以1次请求计费（不足64KB以64KB计费）。配置某个 Topic 的订阅者，API 也以1次请求计费。例如，有30个订阅者，1次负载为64KB的 API 调用将以30次请求计费。 
- **消息发布单价**： 2元/百万条。
计费规则进行四舍五入，计算到小数点后两位，如消息发布为1,431,321条（143万条），则收2.86元。
- **计费场景**
当设定某 Queue 作为 Topic 的订阅方时，Topic 投递消息后，会收取两部分的费用：Queue 接收消息的 API 请求费用，以及 Topic 的消息投递费用。

### 消息堆积
如存在消息堆积在 Topic 的情况（未发布、或多次重试后失败的堆积），堆积消息费用计算公式如下： 
```
堆积消息费用 ＝ 消息总数 × 堆积消息单价
```
**堆积消息单价**： 0.010元/百万条/每小时
扣费以该小时内的平均消息堆积数计算，1小时内采样60个点，计算平均值。
计费规则进行四舍五入，计算到小数点后两位，如消息堆积数为1,431,321条（143万条），则收0.01元。


#### 计费示例
在2016年5月20日16：00 - 17：00，A Topic 的堆积消息总数量为1,323,450条，则该小时，A 队列的消息堆积费用为0.01元。

### 出流量
腾讯云流量计费原则：Topic 入流量免费，Topic 发布订阅的出流量收费（内测期，公网流量费正常收取，建议您使用内网 API 地址进行内测）。
**收费标准**：中国大陆（内地）：0.80元/GB；中国香港：1.00元/GB；其他地区：0.50元/GB。
**收费维度**：针对某个 Topic，单独收费；有多个 Topic 时，出流量会叠加。

| 流量类型	| 定义	| 用量 |	单价 |
|---------|---------|---------|---------|
| 入流量	| 数据传入至 CMQ	| 所有	| 免费 |
| 内网出流量（同地域）|	同一个地域内，在腾讯云内网，CMQ-Topic 投递数据，产生的流量（使用腾讯内网） |	所有	| 免费 |
| 外网出流量 |	CMQ 订阅投递消息，产生的流量（使用公网）|	所有	| 中国大陆（内地）：0.80元/GB；中国香港：1.00元/GB；其他地区：0.50元/GB |







