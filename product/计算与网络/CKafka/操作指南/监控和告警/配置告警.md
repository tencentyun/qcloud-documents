## 操作场景

腾讯云默认为所有用户提供云监控功能，无需用户手动开通。用户在使用了腾讯云某个产品后，云监控才可以开始收集监控数据。

消息队列 CKafka 支持监控您账户下创建的资源，包括实例、Topic、Consumer Group，帮助您实时掌握资源状态。您可以为监控指标配置告警规则，当监控指标达到设定的报警阈值时，云监控可以通过邮件、短信、微信、电话等方式通知您，帮助您及时应对异常情况。

## 操作步骤
### 配置告警规则

创建的告警会将一定周期内监控的指标与给定阈值的情况进行比对，从而判断是否需要触发相关通知。当CKafka 状态改变而导致告警触发后，您可以及时进行相应的预防或补救措施，合理地创建告警能帮助您提高应用程序的健壮性和可靠性。

>?请务必对实例配置告警，防止因突发流量或者到达规格限制而导致的异常。

1. 登录 [CKafka 控制台](https://console.cloud.tencent.com/ckafka)。
2. 在实例列表中，单击操作列的**配置告警**可以直接跳转到告警配置页面。
3. 在告警策略页面，选择好策略类型和要设置告警的实例，设置好告警规则和告警通知模板。
   - **策略类型**：选择**消息服务CKafka**。
   - **告警对象**：选择需要配置告警策略的 CKafka 资源。
   - **触发条件**：支持**选择模板**和**手动配置**，默认选择手动配置，手动配置参见以下说明，新建模板参见 [新建触发条件模版](#新建触发条件模板)。
     >- 指标：例如“磁盘使用百分比”，选择统计粒度为1分钟，则在1分钟内，磁盘使用百分比连续N个数据点超过阈值，就会出发告警。
     >- 告警频次：例如“每30分钟警告一次”，指每30分钟内，连续多个统计周期指标都超过了阈值，如果有一次告警，30分钟内就不会再次进行告警，直到下一个30分钟，如果指标依然超过阈值，才会再次告警。
     
	推荐配置告警策略的指标参见 [CKafka 推荐监控告警策略](#CKafka推荐监控告警策略)。
   - **通知模板**：选择通知模版，也可以新建通知模版，设置告警接收对象和接收渠道。
4. 单击**完成**，完成配置。

有关告警的更多信息，请参见 [云监控告警服务](https://cloud.tencent.com/document/product/248/50398) 。

### 新建触发条件模板[](id:新建触发条件模板)

1. 登录 [云监控控制台](https://console.cloud.tencent.com/monitor/)。
2. 在左侧导航栏中，单击**触发条件模板**，进入触发条件列表页面。
3. 在触发条件模板页单击**新建**。
4. 在新建模板页，配置策略类型。
   - **策略类型**：选择**消息服务CKafka**。
   - **使用预置触发条件**：勾选此选项，会出现系统建议的告警策略。
5. 确认无误后，单击**保存**。
   ![](https://main.qcloudimg.com/raw/0313713fbda620c46c7dce64fcff6a50.png)
6. 返回新建告警策略页，单击**刷新**，就会出现刚配置的告警策略模板。
   ![](https://main.qcloudimg.com/raw/e3dcb4d55755fac09ebb004e96622bcd.png)

## CKafka 推荐监控告警策略[](id:CKafka推荐监控告警策略)

影响业务数据稳定性的指标请参见 [CKafka 数据可靠性说明](https://cloud.tencent.com/document/product/597/36186)。

根据历史用户反馈统计，建议对 CKafka 以下3个维度（共6项指标）配置告警策略，请您根据实际情况合理配置告警策略。

**实例监控**：
<style>
table th:nth-of-type(1) {
width: 30%;        
}
</style>

| 监控指标             | 说明                                                   |
| -------------------- | ------------------------------------------------------ |
| 生产峰值带宽（MB/s） | 实例生产消息时产生的最大流量（不包含副本产生的流量）。 |
| 消费峰值带宽（MB/s） | 实例消费消息时产生的最大流量（消费时无副本的概念）。   |
| 磁盘使用百分比（%）  | 当前磁盘占用与实例规格磁盘总容量的百分比。             |
| 实例连接数（个）     | 客户端与服务器的连接数。                               |

**Topic 监控**：

| 监控指标             | 说明                                                         |
| -------------------- | ------------------------------------------------------------ |
| 已占用磁盘容量（MB） | Topic 实际占用磁盘的消息总量（不包含副本），按照所选择的时间粒度取最新值。 |

**消费分组**：

| 监控指标               | 说明                   |
| ---------------------- | ---------------------- |
| 未消费的消息条数（条） | 消费分组未消费消息数。 |

