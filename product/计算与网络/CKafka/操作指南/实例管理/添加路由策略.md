## 操作场景

该任务指导您在使用消息队列 CKafka 时，通过控制台配置路由接入规则，增强对公网/内网传输中的用户网络访问控制。关于公网的访问请参考 [配置 ACL 策略](https://cloud.tencent.com/document/product/597/31528)。

>?
>- 消息队列 CKafka 支持 SASL_SSL 和 SASL_PLAINTEXT 认证方式，其中 SASL_SSL 接入方式仅专业版实例支持。
>- 一个实例最多创建5条路由。选择 SASL_PLAINTEXT 接入方式的路由有且仅可以有一条，例如路由类型为公网域名接入选择了 SASL_PLAINTEXT 接入方式，则创建其他的路由时不可以再选择 SASL_PLAINTEXT 接入方式。

## 操作步骤

<dx-tabs>

::: VPC\s网络

**操作场景**：您购买实例时选择私有网络并选择了相应的 VPC 环境（例如 VPC A），表示仅能所选择的 VPC A 访问您的消息队列 CKafka 服务（生产数据、消费数据等）；若后续使用过程中发现其他 VPC 环境（例如 VPC B）有需求访问 VPC A 内的消息队列 CKafka 服务，则可以通过配置接入方式，选择 VPC 网络的路由策略。<br>

**操作建议**：为了保证安全性，该接入方式提供用户管理和 ACL 策略配置，以管理用户访问权限，请酌情配置。<br>

**操作步骤**：
1. 登录 [CKafka 控制台](https://console.cloud.tencent.com/ckafka)。
2. 在左侧导航栏单击**实例列表**，单击目标实例的“ID/名称”，进入基本信息页。
3. 在实例基本信息页面，单击接入方式模块中的**添加路由策略**。
4. 在弹窗中，路由类型选择 **VPC 网络**，选择好接入方式和网络。
![](https://main.qcloudimg.com/raw/b3db412a49930a0a38a3f8a6c1ab1867.png)
5. 单击**提交**，完成 VPC 网络添加。

控制台上提供的 VPC 网络访问地址（例如 `172.16.0.12:9092` ），用于获取后端服务的通讯地址，真实访问地址中端口可能存在多个，请在您的服务器上放通9092后的所有端口，以便服务可以正常访问。

::: 

::: 公网域名接入
**操作场景**：当您的消费者或者生产者处于自建机房或其他云服务时，可以通过公网访问方式对消息队列 CKafka 内的数据进行生产和消费。<br>

**操作建议**：为了保证安全性，Kafka 提供了多种安全认证机制，主要分为 SSL 和 SASL2 大类。其中 SASL/PLAIN 是基于账号密码的认证方式，比较常用。消息队列 CKafka 支持 SASL_PLAINTEXT 和 SASL_SSL 认证，请您在选择公网域名接入时酌情配置接入鉴权方式。<br>

**操作步骤**：

1. 登录 [CKafka 控制台](https://console.cloud.tencent.com/ckafka)。
2. 在左侧导航栏单击**实例列表**，单击目标实例的“ID/名称”，进入基本信息页。
3. 在实例基本信息页面，单击接入方式模块中的**添加路由策略**。
4. 在弹窗中，路由类型选择 **公网域名接入**，选择好接入方式和网络。
![](https://main.qcloudimg.com/raw/e61a8b9acfe3d1e5fa71c8cabdbe9965.png)
5. 单击**提交**，完成公网路由策略添加。
>?CKafka 默认提供3Mbps 免费公网带宽，专业版实例可以额外升配公网带宽，最高可提升至198Mbps。具体操作参考 [升配公网带宽](https://cloud.tencent.com/document/product/597/61319#.E5.8D.87.E9.85.8D.E5.85.AC.E7.BD.91.E5.B8.A6.E5.AE.BD)。
:::
</dx-tabs>

