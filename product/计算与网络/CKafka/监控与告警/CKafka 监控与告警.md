腾讯云默认为所有用户提供云监控功能，无需用户手动开通。用户在使用了腾讯云某个产品后，云监控才可以开始收集监控数据。

消息队列 CKafka 支持监控您账户下创建的资源，包括实例、Topic、Consumer Group，帮助您实时掌握资源状态。您可以为监控指标配置告警规则，当监控指标达到设定的报警阈值时，云监控可以通过邮件、短信、微信、电话等方式通知您，帮助您及时应对异常情况。

## 监控指标说明

以下是 CKafka 监控指标相关说明。其中备注**推荐**字样的指标是根据历史用户反馈统计建议对其配置监控和告警策略，请您根据实际情况合理配置监控和告警策略。

### 实例监控

| 监控指标                         | 说明                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| 生产流量（MB）                   | 实例的实际生产流量（不包含副本产生的流量），按照所选择的时间粒度统计求和。 |
| 消费流量（MB）                   | 实例的实际消费流量（不包含副本产生的流量），按照所选择的时间粒度统计求和。 |
| 生产条数（条）                   | 实例的实际生产消息条数，按照所选择的时间粒度统计求和。       |
| 消费条数（条）                   | 实例的实际消费消息条数，按照所选择的时间粒度统计求和。       |
| 已占用磁盘容量（MB）             | 实际占用磁盘的消息总量（包含副本），按照所选择的时间粒度取最新值。 |
| 落盘消息条数（条）               | 实际的落盘的消息总条数（不包含副本），按照所选择的时间粒度取最新值。 |
| 生产峰值带宽（MB/s）**（推荐）** | 实例生产消息时产生的最大流量（不包含副本产生的流量）。       |
| 消费峰值带宽（MB/s）**（推荐）** | 实例消费消息时产生的最大流量（消费时无副本的概念）。         |
| 磁盘使用百分比（%）**（推荐）**  | 当前磁盘占用与实例规格磁盘总容量的百分比。                   |
| 实例连接数（个）**（推荐）**     | 客户端与服务器的连接数。                                     |

### Topic 监控

| 监控指标                         | 说明                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| 生产流量（MB）                   | Topic 的实际生产流量（不包含副本产生的流量），按照所选择的时间粒度统计求和。 |
| 消费流量（MB）                   | Topic 的实际消费流量（不包含副本产生的流量），按照所选择的时间粒度统计求和。 |
| 生产条数（条）                   | Topic 的实际生产消息条数，按照所选择的时间粒度统计求和。     |
| 消费条数（条）                   | Topic 的实际消费消息条数，按照所选择的时间粒度统计求和。     |
| 已占用磁盘容量（MB）**（推荐）** | Topic 实际占用磁盘的消息总量（不包含副本），按照所选择的时间粒度取最新值。 |
| 落盘消息条数（条）               | Topic 的实际的落盘的消息总条数（不包含副本），按照所选择的时间粒度取最新值。 |

### 消费分组-Topic 监控

| 监控指标                              | 说明                                        |
| ------------------------------------- | ------------------------------------------- |
| 主题最大 offset                       | 当前主题中所有分区的最大 offset。           |
| 主题消费 offset（区分 offset 最大值） | 当前主题所有分区中消费组消费的最大 offset。 |
| 主题未消费消息数（条）                | 当前主题所有分区消费组未消费消息总和。      |
| 主题消费速度（条/分钟）               | 当前主题所有分区消费组消费速率总和。        |

### 消费分组-Partition 监控

| 监控指标                           | 说明                                    |
| ---------------------------------- | --------------------------------------- |
| 分区消费速度（条/分钟）            | 消费分组在该分区的消费速率（条/分钟）。 |
| 当前消费 offset                    | 消费分组该分区当前消费 offset。         |
| 当前分区最大 offset                | 当前 分区 最大 offset。                 |
| 未消费的消息条数（条）**（推荐）** | 消费分组在该分区下未消费消息数。        |


指标中英文对照详情参见文档 [CKafka 监控指标](https://cloud.tencent.com/document/product/248/12154)。

## 设置告警策略

创建的告警会将一定周期内监控的指标与给定阈值的情况进行比对，从而判断是否需要触发相关通知。当CKafka 状态改变而导致告警触发后，您可以及时进行相应的预防或补救措施，合理地创建告警能帮助您提高应用程序的健壮性和可靠性。

1. 登录 [CKafka 控制台](https://console.cloud.tencent.com/ckafka)。
2. 在实例列表中，单击操作列的【配置告警】可以直接跳转到告警配置页面。
3. 在告警策略页面，选择好策略类型和要设置告警的实例，设置好告警规则和告警通知模板。
   >!请务必对实例配置告警，防止因突发流量或者到达规格限制而导致的异常。
4. 单击【完成】。

有关告警的更多信息，请参考 [云监控创建告警](https://cloud.tencent.com/document/product/248/6215) 。

## 查看监控数据

1. 登录 [CKafka 控制台](https://console.cloud.tencent.com/ckafka)。
2. 在实例列表中，单击需要查看的“实例 ID/名称”，进入实例详情页。
3. 在实例详情页顶部，单击【监控】，选择要查看的实例资源标签，设置好时间范围，可以查看实例监控数据。
4. 在实例资源标签页面，单击右上角的【设置告警】，可以查看或者修改告警策略。

## CKafka 监控 API 文档

CKafka 监控 API 详情可参见如下文档：

- [主题监控](https://cloud.tencent.com/document/product/248/35239)
- [实例监控](https://cloud.tencent.com/document/product/248/35240) 
- [消费分组监控](https://cloud.tencent.com/document/product/248/35241)

