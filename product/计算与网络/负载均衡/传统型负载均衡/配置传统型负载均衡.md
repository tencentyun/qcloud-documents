创建传统型负载均衡实例后，您需要为实例配置监听器。监听器负责监听负载均衡实例上的请求，并依据均衡策略来分发流量至后端服务器上。

## 前提条件
您需要 [创建负载均衡实例](https://cloud.tencent.com/document/product/214/6149)，其中实例类型选择“传统型负载均衡”。

## 配置监听器
### 步骤1：打开监听器管理页面
1. 登录 [负载均衡控制台](https://console.cloud.tencent.com/clb)。
2. 在左侧导航栏，选择【实例管理】。
3. 在实例列表页单击需配置的实例 ID，进入实例详情页。
4. 单击【监听器管理】标签页，您也可以在列表页的操作栏中单击【配置监听器】。
![](https://main.qcloudimg.com/raw/6acf6318760f56bea78071b707845057.png)
4. “监听器管理”页面如下图所示。
![](https://main.qcloudimg.com/raw/d3b2a4f976cc042c98ebc58e158c95ee.png)

### 步骤2：配置监听器
在“监听器”模块下，单击【新建】，在弹出框中配置 TCP 监听器。
#### 1. 基本配置
<table>
<thead>
<tr>
<th width="15%">监听器基本配置</th>
<th width="70%">说明</th>
<th width="15%">示例</th>
</tr>
</thead>
<tbody><tr>
<td>名称</td>
<td>监听器的名称</td>
<td><span>test-tcp-80&nbsp;&nbsp;&nbsp;&nbsp;</span></td>
</tr>
<tr>
<td>监听协议端口</td>
<td>监听器的协议和监听端口<br><li>监听协议：CLB 支持的协议包括 TCP、UDP、HTTP、HTTPS，本例选择 TCP。</li><li>监听端口：用来接收请求并向后端服务器转发请求的端口，端口范围为1 - 65535。</li><li>同一个负载均衡实例内，监听端口不可重复。</li></td>
<td>TCP:80</td>
</tr>
<tr>
<td>后端端口</td>
<td>云服务器提供服务的端口，接受并处理来自负载均衡的流量</td>
<td>80</td>
</tr>
</tbody></table>

创建 TCP 监听器具体基本配置如下图所示：
![](https://main.qcloudimg.com/raw/76aa84bc0df967d224896c79545bed42.png)

#### 2.高级配置
| 高级配置    | 说明                    | 示例                                 |
| ------- | ------------------------ | ---------------------------------------- |
| 均衡方式 | TCP 监听器中，负载均衡支持加权轮询（WRR）和加权最小连接数（WLC）两种调度算法 <br><li>加权轮询算法：根据后端服务器的权重，按依次将请求分发给不同的服务器。加权轮询算法根据<strong>新建连接数</strong>来调度，权值高的服务器被轮询到的次数（概率）越高，相同权值的服务器处理相同数目的连接数。</li><li>加权最少连接数：根据服务器当前活跃的连接数来估计服务器的负载情况，加权最小连接数根据服务器负载和权重来综合调度，当权重值相同时，当前连接数越小的后端服务器被轮询到的次数（概率）也越高。</li> | 加权轮询 |
|会话保持状态 | 开启或关闭会话保持<br><li>开启会话保持后，负载均衡监听会把来自同一客户端的访问请求分发到同一台后端服务器上。</li><li>TCP 协议是基于客户端 IP 地址的会话保持，即来自同一 IP 地址的访问请求转发到同一台后端服务器上。</li><li>加权轮询调度支持会话保持，加权最小连接数调度不支持开启会话保持功能。</li> | 开启 |
| 会话保持时间 | 会话保持时间<br><li>当超过保持时间，连接内无新的请求，将会自动断开会话保持。</li><li>可配置范围30 - 3600秒。</li> | 30s |

具体配置如下图所示：
![](https://main.qcloudimg.com/raw/2853e15e291d37b1ae61dc230c33ffbb.png)

#### 3. 健康检查
| 健康检查配置    | 说明                    | 示例                                |
| ------- | ------------------------ | ---------------------------------------- |
| 健康检查状态 | 开启或关闭健康检查。TCP 监听器中，负载均衡实例向指定的服务器端口发 SYN 包进行健康检查。 | 开启 |
| 响应超时 | <li> 健康检查响应的最大超时时间。</li><li>如果后端云服务器在超时时间内没有正确响应，则判定为健康检查异常。</li><li>可配置范围：2 - 60秒，默认值2秒。</li> | 2s |
| 检测间隔 | <li>负载均衡进行健康检查的时间间隔。</li><li>可配置范围：5 - 300秒，默认值5秒。</li> | 5s |
| 不健康阈值 | <li>如果连续 n 次（n 为填写的数值）收到的健康检查结果失败，则识别为不健康，控制台显示为**异常**。</li><li>可配置范围：2 - 10次，默认值3次。</li> | 3次 |
| 健康阈值 |<li>如果连续 n 次（n 为填写的数值）收到的健康检查结果为成功，则识别为健康，控制台显示为**健康**。</li><li>可配置范围：2 - 10次，默认值3次。 </li> | 3次 |

健康检查具体配置如下图所示：
![](https://main.qcloudimg.com/raw/2c7e0e83bf52706830d324df44194f8f.png)

### 步骤3：绑定后端云服务器
在“监听器管理”页面，单击【绑定】按钮，在弹出框中选择需绑定的后端云服务器，绑定详情如下：
![](https://main.qcloudimg.com/raw/7b3aa29c2d682b1a8a07951197b34de8.png)

配置完毕的截图如下所示：
![](https://main.qcloudimg.com/raw/f1ab6ea6d8ad2975fffeb9c32561d385.png)

>?在传统型负载均衡中，如果您配置了多个监听器，绑定了多个后端云服务器，那么每个监听器都会按其配置转发给所有后端服务器。

### 步骤4：安全组（可选）
您可以配置负载均衡的安全组来进行公网流量的隔离，详情请参见 [配置负载均衡安全组](https://cloud.tencent.com/document/product/214/14733)。

### 步骤5：修改/删除监听器（可选）
如果您需要修改或删除已创建的监听器，请在“监听器管理”页面，选择已创建完毕的监听器，选择【修改】或【删除】来完成操作。
![](https://main.qcloudimg.com/raw/143740d1966cffccec58aaa0f624b630.png)
