## 使用场景

在伸缩组中，您可设置弹性扩容和弹性缩容活动，如果您希望在正式启动这些实例前进行自定义操作，生命周期挂钩功能就能帮助您完成：
- 伸缩组扩容出实例后需要延迟一段时间挂载到 CLB ，再对外提供服务。
- 伸缩组释放实例时执行数据备份操作。
- 伸缩组弹性扩容或者缩容时执行一些用户自定义操作。

>? 
> - 生命周期挂钩仅在自动创建或移出实例时生效，手动添加或移出实例时不受其影响。 
> - 一个伸缩组内仅可以创建10个生命周期挂钩。

## 工作方式

伸缩组创建生命周期挂钩后，当生命周期挂钩联动的伸缩活动类型发生时，伸缩活动被挂起，您可以在伸缩活动挂起的期间执行自定义操作。当生命周期挂钩超时时，该挂起会终止。 

## 生命周期挂钩属性

| 名称         | 说明                                                         | 示例         |
| ------------ | ------------------------------------------------------------ | ------------ |
| 名称         | 生命周期挂钩名称 ，仅支持中文、英文、数字、下划线、分隔符"-"、小数点 | fehwnl\_      |
| 伸缩活动类型 | 弹性缩容活动/弹性扩容活动                                    | 弹性缩容活动 |
| 超时时间     | 默认情况下实例保持等待状态的时间。 30 - 7200 （秒），必须为整数。 | 300          |
| 执行策略     | 执行策略包括【继续】和【拒绝】。<ul style="margin: 0;"><li>继续策略：挂起的伸缩活动将继续执行。</li><li>拒绝策略：针对弹性扩容活动，会直接释放已创建的 CVM 实例。针对弹性缩容活动，无影响。</li></ul>当一个伸缩组设置多个生命周期挂钩时，则顺序等待操作执行。但仅执行首个拒绝策略，后续生命周期挂钩的拒绝策略不生效。| 拒绝         |
| 通知方式     | 通知方式包括 CMQ 主题 和 CMQ 队列。选择通知方式后，您还需要选择具体的 CMQ 主题或者 CMQ 队列。 | CMQ 主题      |
| 通知标识     | 弹性伸缩每次推送消息到通知对象时，会同时发送您预先指定的通知标识，便于管理和标记不同类别的通知信息。 | 通知消息     |

## 创建生命周期挂钩

1. 登录 [弹性伸缩控制台](https://console.cloud.tencent.com/autoscaling/group)。
2. 选择您需要绑定生命周期挂钩的伸缩组，单击伸缩组 ID/名称，进入该伸缩组的详情页面。如下图所示：
![](https://main.qcloudimg.com/raw/187b45130a77a4e0d9a852190281e6ac.png)
3. 选择【生命周期挂钩】页签，单击【新建】。如下图所示：
![](https://main.qcloudimg.com/raw/2586e9fa872d8040a36b6eab7f9a289d.png)
4. 在弹出的“新建生命周期挂钩”窗口中，填写生命周期挂钩相关信息。如下图所示：
![](https://main.qcloudimg.com/raw/dba0ccae8ea1b4f247b44b6450202913.png)
>? 
> - 您在创建生命周期时，需要选择或新建 [CMQ](https://cloud.tencent.com/document/product/406/8435)。其中包括创建 [CMQ 主题](https://console.cloud.tencent.com/mq/topic?rid=1) 和 [CMQ 队列](https://console.cloud.tencent.com/mq/index?rid=1)。
> - 针对一个伸缩组设置多个生命周期挂钩的情况，顺序等待但只执行第一个拒绝策略，后续生命周期挂钩不生效。
> - 如果您不填写通知方式，默认不通知您。
> - 同一个伸缩组内生命周期挂钩名称不能重复。
> 

## 修改生命周期挂钩

1. 登录 [弹性伸缩控制台](https://console.cloud.tencent.com/autoscaling/group)。
2. 选择您需要修改生命周期挂钩的伸缩组，单击伸缩组 ID/名称，进入该伸缩组的详情页面。如下图所示：
![](https://main.qcloudimg.com/raw/187b45130a77a4e0d9a852190281e6ac.png)
3.  选择【生命周期挂钩】页签，在需要修改生命周期挂钩的行中，单击【修改】。如下图所示：
![](https://main.qcloudimg.com/raw/07f46b9319d20ee708dbccf4ab927d24.png)
4. 在弹出的“修改生命周期挂钩”窗口中，根据实际需求进行修改信息即可。

## 删除生命周期挂钩

1. 登录 [弹性伸缩控制台](https://console.cloud.tencent.com/autoscaling/group)。
2. 选择您需要删除生命周期挂钩的伸缩组，单击伸缩组 ID/名称，进入该伸缩组的详情页面。如下图所示：
![](https://main.qcloudimg.com/raw/187b45130a77a4e0d9a852190281e6ac.png)
3.  选择【生命周期挂钩】页签，在需要删除生命周期挂钩的行中，单击【删除】。如下图所示：
![](https://main.qcloudimg.com/raw/184eccec14aa3950683fde1c3dbc724f.png)
4. 在弹出的“删除生命周期挂钩”窗口中，单击【确认】。如下图所示：
![](https://main.qcloudimg.com/raw/61a128a36dda3eab83e026757763a8ed.png)
