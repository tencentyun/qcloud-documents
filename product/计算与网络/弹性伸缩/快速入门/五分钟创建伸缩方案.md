创建完整的弹性伸缩方案，您需要通过以下3步来完成：
![](https://main.qcloudimg.com/raw/05ef734d160c1c73061cf103cfb44d91.png)

<dx-alert infotype="explain" title="">
本文以通过弹性伸缩控制台操作为例，如果您更倾向于使用 API 方式，请参见 [API 使用示例](https://cloud.tencent.com/document/product/377/4232)。
</dx-alert>



## 步骤1：创建启动配置
启动配置定义了用于弹性伸缩的云服务器 CVM 实例的配置信息，包括 CVM 的镜像、存储、网络、安全组、登录方式和其他配置信息。

<dx-alert infotype="explain" title="">
创建启动配置服务**完全免费**，请放心创建。
</dx-alert>

 



### 选择区域
1. 登录弹性伸缩控制台，选择左侧导航栏中的 **[启动配置](https://console.cloud.tencent.com/autoscaling/config)**。
2. 在“启动配置”管理页面上方，选择启动配置的项目和区域。如下图所示：
![](https://main.qcloudimg.com/raw/b67b4a96e62f923e297755d590d652bf.png)
区域的选择限制了可手动添加的实例和可绑定的负载均衡。例如，如果启动配置的区域选择了广州，那么伸缩组里自动添加的即为广州的实例。区域为广州的伸缩组，将不能手动添加上海、北京、中国香港、多伦多等其他区域的实例，也不能绑定上海、北京、中国香港、多伦多等其他区域的负载均衡。
3. 单击**新建**，进入“创建启动配置”页面。



### 选择机型
在“选择机型”步骤中，参考以下信息设置启动配置名称、可用区及机型。如下图所示：
![](https://main.qcloudimg.com/raw/327cd653984e0ce08004a7c76d3c95fb.png)
- **启动配置名称**：自定义启动配置配置名称。
- **计费模式**：仅支持**按量计费**模式，详情请参见 [按量计费](https://cloud.tencent.com/document/product/213/2180#.E6.8C.89.E9.87.8F.E8.AE.A1.E8.B4.B9)。
- **可用区、机型**：选择期望和伸缩组绑定实例的机型。


### 选择镜像、存储及带宽
1. 创建启动配置可使用公共镜像、自定义镜像、共享镜像、镜像市场。详情请参见 [镜像概述](https://cloud.tencent.com/document/product/213/4940)。如下图所示：
![](https://main.qcloudimg.com/raw/ec75959dc99a80a814db79be32370cd7.png)
建议使用已经部署好环境的自定义镜像。原因如下：
	- 若您选择的是公共镜像，那么伸缩出来的实例是纯净的 OS，仍需要手动部署应用环境。
	- 若您选择的是自定义镜像，通过对已经部署好环境的 CVM 实例制作镜像，然后使用该镜像批量创建 CVM 实例， 则创建成功之后便具有和之前 CVM 实例一致的软件环境，以此可以达到批量部署的目的。
<dx-alert infotype="explain" title="">
如何制作“伸缩组期望绑定的实例”的镜像请参见 [创建自定义镜像](https://cloud.tencent.com/document/product/213/4942)。
</dx-alert>
2. 参考以下信息，设置启动配置中的磁盘。如下图所示：
![](https://main.qcloudimg.com/raw/66d6437e8abc4e2e60429f047f7a78f7.png)
如果系统盘选择了云硬盘，那么数据盘就可以选择数据盘快照：
	- 对于有大量数据的用户而言，会经常使用数据盘来存储数据。数据盘 A 创建了快照文件时，用户可使用该快照文件，快速克隆多块磁盘，达到快速部署服务器的目的。
	- 在弹性伸缩自动添加新的 CVM 实例时，如果启动配置数据盘指定了数据盘快照，结合云硬盘可支持启动 CVM 实例后自动挂载包含设定数据的数据盘能力，可满足数据自动拷贝的需求。
	- 若启动配置中指定数据盘快照，则需保证数据盘能被正确自动挂载，伸缩组才可成功自动扩容。您需要在设置弹性伸缩前对制作数据盘快照的原实例进行操作，使其支持在启动新的 CVM 实例时自动挂载数据盘。详情请参见 [自动挂载](https://cloud.tencent.com/doc/product/362/5564)。
3. 默认免费分配独立公网 IP，请根据实际情况选择网络计费模式。如下图所示：
![](https://main.qcloudimg.com/raw/24804c3851e904b72f034a9b1cfbfb3d.png)
<dx-alert infotype="explain" title="">
 弹性伸缩服务免费，新增的 CVM、硬盘和网络将根据 CVM 实例、硬盘和网络按量收费，该页面将根据您的设置显示价格。
</dx-alert>



### 设置信息
1. 在“设置主机”步骤中，选择登录方式、安全组。通过弹性伸缩服务新增的 CVM 实例默认免费享受云安全和云监控服务。如下图所示：
![](https://main.qcloudimg.com/raw/1dc03220f3983ac9e3980d3f0c31bf8b.png)
2. 确认配置并成功创建后，可在“启动配置”页面中查看已创建的启动配置。如下图所示：
![](https://main.qcloudimg.com/raw/9d14fe2701563f54773083954d321c43.png)

## 步骤2：创建伸缩组
伸缩组是遵循相同规则、面向同一场景的云服务器实例的集合。


### 新建伸缩组
1. 登录弹性服务控制台，选择左侧导航栏中的 **[伸缩组](https://console.cloud.tencent.com/autoscaling/group?rid=1)**。
2. 在“伸缩组”管理页面，单击**新建**。
3. 在弹出的“新建伸缩组”页面，参考以下信息填写伸缩组基本信息。其中 <label style="color:#e1504a;">*</label> 为必填项。如下图所示：
![](https://main.qcloudimg.com/raw/8b12685173a51c41eecdf35c9bd3282b.png)
 - **名称**：自定义伸缩组名称。
 - **最小伸缩数**：若当前 CVM 实例数小于最小伸缩数，弹性伸缩服务将自动添加实例，使其等于最小伸缩数。
 - **起始实例数**：定义了伸缩组初始 CVM 实例的数量。
 - **最大伸缩数**：若当前 CVM 实例数大于最大伸缩数，弹性伸缩服务将自动减少实例，使其等于最大伸缩数。
<dx-alert infotype="explain" title="">
伸缩组的当前 CVM 实例数将维持在最小伸缩数与最大伸缩数之间。
</dx-alert>
 - **启动配置**：选择已有的启动配置，您也可以新建启动配置。
 - **支持网络、可用区**：按需选择网络、可用区。
 单击**下一步**。
4. （可选）在“负载均衡配置”步骤中，选择关联已有负载均衡策略或新建负载均衡，并单击**下一步：其他配置**。
5. 在“其他配置”步骤中，参考以下信息设置移出策略及实例创建策略。
 - **移出策略**：当伸缩组要减少实例且有多重选择时，将根据移出策略来选择移出的实例。支持“移出最旧的实例”及“移出最新的实例”。
 - **实例创建策略**：
	 - **首选可用区（子网）优先**：根据已配置的可用区（子网）顺序，优先选择靠前的配置项，失败后自动按顺序重试，适合以某个可用区为主，其他可用区为辅的架构。
	- **多可用区（子网）打散**：系统将根据扩容时伸缩组内实例在不同可用区（子网）的分布情况，选择相对较少的可用区（子网）创建新的实例，适合需要均匀分布实例的架构。 
2. 单击**完成**即可完成创建，可在“伸缩组”页面中查看已创建的伸缩组。如下图所示：
![](https://main.qcloudimg.com/raw/82426e49161530ea7bc4e2ec061e2a62.png)

### 添加实例（可选）
1. 在 “[伸缩组](https://console.cloud.tencent.com/autoscaling/group?rid=1)” 页面，选择伸缩组 ID 进入该伸缩组详情页。
2. 选择**关联实例**页签，并单击**添加实例**。如下图所示：
![](https://main.qcloudimg.com/raw/1e6ce2cd65bbc7977cc4233a75091f4a.png)
3. 在弹出的“添加实例”窗口中，选择需绑定的实例，并单击**确定**。
<dx-alert infotype="explain" title="">
如遇到无法添加实例或者无法移出实例的情况，请检查伸缩组设置的最大伸缩数和最小伸缩数。
</dx-alert>



## 步骤3：创建伸缩策略

弹性伸缩组根据伸缩策略进行云服务器数量的增减：
- 创建**定时任务**，用于定时执行伸缩活动，您还可设置是否周期性执行。
- 创建**告警触发策略**，根据云监控指标（例如 CPU、内存使用率等）情况执行伸缩活动。

### 创建定时任务

如果您的负载变化情况是可以预知的，那么您可通过设置定时任务，对您的设备扩展活动进行规划。此功能可定时及周期性地自动增加或减少 CVM 实例，从而灵活应对业务负载变化，提高设备利用率，节省部署和实例成本。
1. 在 “[伸缩组](https://console.cloud.tencent.com/autoscaling/group?rid=1)” 页面，选择伸缩组 ID 进入该伸缩组详情页。
2. 选择**定时任务**页签，并单击**新建**。如下图所示：
![](https://main.qcloudimg.com/raw/a1d06d93d4050d152f900b6f285e0ff9.png)
3. 在弹出的“新建定时任务”窗口中，指定定时任务名称、伸缩组活动和重复周期等信息。
4. 完成设置后单击**确定**，即可查看该定时任务。如下图所示：
![](https://main.qcloudimg.com/raw/ef54a836859c85ddb95478c53589d4ad.png)

### 创建告警触发策略

如果您希望根据 CVM 指标情况调整业务部署，那么您可通过自定义告警触发策略，对您的设备扩展活动进行规划。当业务负载使得指标到达阈值时，该策略将帮助您自动增加或减少 CVM 实例数量，从而灵活应对业务负载变化，提高设备利用率，节省部署和实例成本。


<dx-alert infotype="explain" title="">
 - 伸缩组建立时均会默认建立一条 ping 不可达告警触发策略，以替换不健康子机。
 - 在使用告警触发策略之前，需要在 CVM 的镜像里安装新版本的云监控 Agent。详情请参见 [安装监控组件](https://cloud.tencent.com/document/product/248/6211)。
</dx-alert>


1. 在 “[伸缩组](https://console.cloud.tencent.com/autoscaling/group?rid=1)” 页面，选择伸缩组 ID 进入该伸缩组详情页。
2. 选择**告警触发策略**页签，并单击**新建**。如下图所示：
![](https://main.qcloudimg.com/raw/ed5e919d6180f0d581ceba0b414620a2.png)
3. 在弹出的“新建告警触发策略”窗口中，设置基于云监控性能指标（例如 CPU、内存、带宽等），自动为伸缩组增加或减少指定台数或指定百分比的 CVM 实例。
您还可通过“复制策略（选填）”，直接复制已有伸缩组的已有策略到当前伸缩组。如下图所示：
![](https://main.qcloudimg.com/raw/8ab25a30f5df7aa1103fefbb0757828d.png)
4. 完成设置后单击**确定**，即可查看该告警触发策略。如下图所示：
![](https://main.qcloudimg.com/raw/363b056d185c88aa6f6408b678ade808.png)


