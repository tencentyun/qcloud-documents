本文指导您如何快速创建私有连接服务，将 VPC 中部署的云服务共享给其他 VPC 访问。

## 背景信息
VPC 是您独有的云上私有网络，不同 VPC 之间默认完全隔离。您可以通过 Private Link 服务，实现腾讯云 VPC 与其他 VPC 上安全稳定的私有连接，简化网络架构，避免公网访问服务带来的潜在安全风险。

使用 Private Link 建立连接，您需要创建终端节点服务和终端节点。
## 场景示例
本文以下图业务场景为例。某公司业务分布在两个私有网络：VPC1 和 VPC2，因业务发展，公司在 VPC2 中部署了相关服务资源，且希望将 VPC2 中的业务共享给 VPC1 进行访问。为避免公网访问带来的潜在安全风险，使用腾讯云私有连接 Private Link 来实现 VPC1 到 VPC2 的安全内网访问方案。
![](https://main.qcloudimg.com/raw/2e3252331d564196240811a069cc48ff.png)

## 前提条件
+ 您已注册腾讯云账号，并已创建两个 VPC。
+ 在服务提供方 VPC2 中已创建内网4层 CLB 实例，并在 CLB 后端云服务器实例中部署相关服务资源，请确保后端云服务器实例可以正常处理负载均衡转发的请求，具体请参加 [负载均衡快速入门](https://cloud.tencent.com/document/product/214/8975)。
   >?为保证服务使用方能够正常访问腾讯云公共业务，例如 MySQL，请确保服务提供方 VPC2 中负载均衡后端云服务器关联的安全组已放通11.163.0.0/16地址段。

## 操作步骤

### 步骤1：服务提供方创建终端节点服务
>?本例默认服务提供方 VPC 中已创建4层内网 CLB，CLB 后端已关联了部署了业务的云服务器实例，且云服务器实例安全组已放通11.163.0.0/16网段。
>
1. 登录 [私有连接控制台]()。
2. 在左侧导航栏单击【终端节点服务】。
3. 单击【新建】，在弹出的新建终端节点服务界面，配置相关参数。
    ![](https://main.qcloudimg.com/raw/5d14cc87361e878b15cd9a00f0f7885f.png)
	参数含义：
 + 服务名称：自定义终端节点服务的名称。
 + 所在地域：终端服务节点所在地域。
 + 所属网络：选择所属 VPC，本例选择 VPC2。
 + 负载均衡：选择 VPC 下已创建的负载均衡，本例选择 VPC2 中已创建好的 CLB 实例。
 + 自动接受：指定终端节点服务是否自动接受终端节点发起的连接请求，默认为否，此处和白名单策略结合使用，遵循如下原则。
    + 如果是同账号，则默认自动加入白名单列表，而无论此处选择是或者否，系统都认为是自动接受，终端节点创建成功即为可用状态。
    + 如果是跨账号，选择【是】自动接受时，且终端节点在用户白名单中，终端节点创建成功即为可用状态。
    + 如果是跨账号，选择【否】不接受自动连接时，终端节点创建成功的初始状态为【待接受】，需等服务方接受后方可变更为可用。
4. 完成参数设置后，单击【确定】完成终端节点服务的创建。

### 步骤2（条件可选）：终端节点服务创建用户白名单
用于管理服务使用方的账户访问权限，由于本示例为同账号下 VPC 通信，默认已加入终端节点服务的白名单中，因此可跳过该步骤，如果是跨账号，请按步骤添加白名单。
1. 单击已创建的终端节点服务的 ID，进入详情页。
2. 单击【白名单】页签进入用户白名单管理界面。
3. 单击【添加】，进入【添加白名单用户】界面。
   ![](https://main.qcloudimg.com/raw/e87dcd2678d2f2d876a1911c8699aeb2.png)
4. 填写用户 UIN，并填写用户描述信息，如果需要添加多个用户，可以单击【添加】。
5. 完成用户白名单添加后，单击【确定】，添加成功的白名单展示在列表中。
   ![](https://main.qcloudimg.com/raw/474e01dcbf337a9e2c721a34450c8e10.png)
	 
### 步骤3：服务使用方创建终端节点
1. 单击左侧导航栏单击【终端节点】。
2. 单击【新建】，在弹出的新建终端节点界面，配置相关参数。
     ![](https://main.qcloudimg.com/raw/f665b332b1997f22e92784a6f60483fe.png)
    参数含义如下：
	 + 名称：自定义终端节点的名称。
	 + 所属地域：终端节点所在地域。
	 + 所属网络：选择终端节点所在的 VPC，本例选择 VPC1。
	 + 所属子网：选择终端节点所在的子网。
	 + IP 地址：终端节点的 IP 地址。可以指定 IP 地址，IP 地址为 VPC1 内的内网 IP，也可以选择自动分配 IP。
	 + 对端账户类型：选择需要访问的VPC的所属账户，我的账户说明是同账户VPC的访问，其他账户说明是跨账户VPC的访问，本例选择【我的账户】。
	   >?如果是跨账户，则需要将本账户的账号告知对端账户，且发起连接请求后，需要服务端接受后才可联通。
	 + 选择服务：输入终端节点服务的 ID 后单击【验证】，只有验证通过的服务才可建立连接。
3. 完成参数配置后，单击【确定】。

	 
### 步骤4（条件可选）：终端节点服务管理终端节点连接请求
如果是跨账户，则在终端节点建立发起连接请求后，告知对端账户本账户的 UIN，并需要在终端节点服务侧，选择【接受】或【拒绝】该请求，由于本例是同账号，可跳过该步骤。
1. 单击已创建的终端节点服务的 ID，进入详情页。
2. 单击【终端节点连接】页签进入终端节点连接管理界面。
3. 根据实际情况处理终端节点的状态连接请求，即选择【接受】或【拒绝】。

### 步骤5（可选）：为终端节点绑定安全组
为终端节点绑定安全组，可控制终端节点的入站流量，提高业务访问的安全性。
1. 单击终端节点 ID 进入详情界面。
2. 单击【安全组】页签。
3. 为终端节点绑定安全组。
     ![](https://main.qcloudimg.com/raw/81b02ab80e329cd9bf093c199736ab5e.png)

### 步骤6：服务使用方发起访问请求进行连接验证
在服务使用方创建 CVM，通过 VIP+VPORT（其中 VIP 为终端节点获取的 IP， VPORT 为终端节点服务 CLB 的 VPORT）访问服务提供方的后端服务。
>?如果跨账号，则 CLB 的 VPORT 信息需要由服务提供方告知服务使用方，而服务使用方的用户账号 UIN 信息也需要告知给服务提供方。
