## 操作场景
本文介绍如何通过容器服务控制台调整节点池配置。包含调整节点池全局配置、节点池配置、节点池下节点数量及启用或停用弹性伸缩操作。


## 前提条件

- 已创建可用节点池。详情请参见 [创建节点池](https://cloud.tencent.com/document/product/457/43735)。
- 已进入节点池列表。详情请参见 [查看节点池](https://cloud.tencent.com/document/product/457/43736)。

## 操作步骤

### 调整节点池全局配置<span id="adjustGlobalNodePool"></span>

1. 在“节点池列表”页面，单击“全局配置”模块右上角的【编辑】。如下图所示：
![](https://main.qcloudimg.com/raw/94e8b41f593dd6507ff9d9f4d9f89537.png)
2. 在弹出的“设置集群伸缩全局配置”窗口中，参考以下信息进行设置。如下图所示： 
![](https://main.qcloudimg.com/raw/9175321e4165d2d0c67c27be19af4e28.png) 
主要参数信息如下：
 - **自动缩容**：默认不勾选。开启自动缩容时，集群中节点空闲资源较多时将触发缩容。详情请参见 [集群自动扩缩容说明](https://cloud.tencent.com/document/product/457/32190)。
 - **缩容配置**：该配置项仅在开启自动缩容时显示，请根据实际需求进行设置。
    - **最大并发缩容数**：该数值表示为可以同时进行缩容的节点数，此处默认为“10”，可按需自定义设置。
>!此处只缩容完全空闲的空节点。如果节点上存在 Pod，则每次缩容最多一个节点。
>
    - **Pod 占用资源/可分配资源小于的值**：可设置 **Pod 占用资源或可分配资源**在占比小于设定值时开始判断缩容条件。占比值范围需确保在0 - 80之间。
    - **节点连续空闲**：可自定义设置节点连续空闲时间超过几分钟之后会被缩容。
    - **集群扩容**：可自定义设置集群首次判断扩容条件的时间点。
    - **不缩容节点**：请根据实际需求勾选以下配置项，确保不缩容以下特定类型的节点。
        - 含有本地存储 Pod 的节点。
        - 含有 kube-system namespace 下非 DaemonSet 管理的 Pod 的节点。
 - **扩容算法**：集群扩容时所依赖的算法准则，提供以下三种选择：
    - **随机**：有多个伸缩组时，随机选择一个伸缩组进行扩容。
    - **most-pods**：有多个伸缩组时，选择能调度更多 Pod 的伸缩组进行扩容。
    - **least-waste**：有多个伸缩组时，选择 Pod 调度后资源剩余更少的伸缩组进行扩容。
3. 单击【确定】，即可设置成功。

### 调整节点池配置
1. 单击目标节点池名片页右上角的【编辑】。如下图所示：
![](https://main.qcloudimg.com/raw/87a5b4313f1d67dfb0d068afa8090397.png)
2. 在弹出的“调整节点池配置”页面，参考以下信息进行设置。如下图所示：
![](https://main.qcloudimg.com/raw/496ec743f24b3bb7c37db680e7b17b51.png)
 - **节点池名称**：自定义。可根据业务需求等信息进行命名，方便后续资源管理。
 - **弹性伸缩**：根据实际需求进行勾选。
 - **节点数量范围**：节点数量将在设定的节点范围内自动调节，不会超出该设定范围。
 >! 该数量范围的设置，将影响 [调整节点池下节点数量](#adjustNodePool) 操作。例如，当前节点池的节点数量已达到该范围最大值时，节点数量将不再支持上调。
>
  - **Lable**：该节点池下所创建的节点将自动加上此处设置的 Label，方便后续根据 Lable 筛选、管理节点。单击【新增Lable】，即可进行 Lable 自定义设置。
 - **Taints**：节点属性，通常与 `Tolerations` 配合使用。此处可为节点池下的所有节点设置 Taints，确保不符合条件的 Pod 不能够调度到这些节点上，且这些节点上已存在不符合条件的 Pod 也将会被驱逐。
 >?Taints 内容一般由 `key`、`value` 及 `effect` 三个元素组成。其中 `effect` 可取值通常包含以下三种：
> - **PreferNoSchedule：** 非强制性条件，尽量避免将 Pod 调度到设置了其不能容忍的 taint 的节点上。
> - **NoSchedule：** 当节点上存在 taint 时，没有对应容忍的 Pod 一定不能被调度。
> - **NoExecute：**当节点上存在 taint 时，对于没有对应容忍的 Pod，不仅不会被调度到该节点上，该节点上已存在的 Pod 也会被驱逐。
> 
以设置 Taints `key1=value1:PreferNoSchedule` 为例，控制台配置如下图所示：
![](https://main.qcloudimg.com/raw/e554317ef5c178297d34eef3f9a7bfa7.png)
3. 单击【确定】并等待更新完成即可。



### 调整节点池下节点数量<span id="adjustNodePool"></span>
1. 单击目标节点池名片页右侧的【调整数量】。如下图所示：
![](https://main.qcloudimg.com/raw/9ca0c61a643d42098857069966c5a975.png)
2. 在弹出的“调整数量”页面，按需调整节点数量范围。如下图所示：
> ? 
> - 节点数量范围可在[ 调整节点池全局配置 ](#adjustGlobalNodePool)时进行设置。
> - 节点池已开启弹性伸缩时，该数量将会随着集群工作负载自动调整，可能会存在最终实际的节点数量与数量调整时所设置的值不一致的问题。
> 
![](https://main.qcloudimg.com/raw/71add01b63c47a550cf07825e3916ebc.png)
3. 单击【确定】等待数量调整完成即可。


### 启用/停用弹性伸缩
>? 执行启用/停用弹性伸缩操作时，仅建议在容器服务侧节点池处进行，以确保该状态能够同步至 Cluster-autoscaler。
>
1. 单击目标节点池名片页右上角的【更多】。如下图所示：
![](https://main.qcloudimg.com/raw/fa2114520fb455fdc7e8e7839545ff41.png)
2. 结合实际情况选择【启用弹性伸缩】或者【停用弹性伸缩】，并在弹出的窗口中单击【确认】即可。

## 相关操作
您可参考以下文档，了解更多节点池功能及操作：
- [创建节点池](https://cloud.tencent.com/document/product/457/43735)
- [查看节点池](https://cloud.tencent.com/document/product/457/43736)
- [删除节点池](https://cloud.tencent.com/document/product/457/43738)




