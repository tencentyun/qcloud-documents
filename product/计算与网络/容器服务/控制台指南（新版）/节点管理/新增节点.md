## 操作场景

您可以通过以下方式为集群添加节点。
- [新建节点](#createNode)
- [添加已有节点](#addExistingNode)

## 前提条件

已登录 [容器服务控制台](https://console.cloud.tencent.com/tke2) 。

## 操作步骤

[](id:createNode)
### 新建节点

1. 在左侧导航栏中，单击【[集群](https://console.cloud.tencent.com/tke2/cluster)】，进入 “集群管理” 页面。
2. 单击需要创建云服务器的集群ID，进入该集群详情页。
3. 选择页面左侧【节点管理】>【节点】，进入节点列表页面，单击【新建节点】。
4. 在 “新建节点” 页面，根据实际需求配置相关参数。如下图所示：
![](https://main.qcloudimg.com/raw/3b5c2e2e4293fab59d82072870e89c9e.png)
主要参数信息如下：
  - **计费模式**：提供【按量计费】和【包年包月】两种计费模式。详情请参见 [计费模式](https://cloud.tencent.com/document/product/213/2180)。
  - **可用区**：该参数仅用来筛选可用区下可用的子网列表。
  - **集群网络**：选择为本次新建节点分配 IP 的子网，单次创建节点操作只支持单子网。
  - **机型配置**：单击【请选择机型】，在弹出的“机型配置”窗口中参考以下信息按需选择：
    - **机型**：支持通过 CPU 核数、内存大小及实例类型进行筛选。详情请参见 [实例规格](https://cloud.tencent.com/document/product/213/11518) 和 [快速入门 Linux 云服务器](https://cloud.tencent.com/document/product/213/2936)。
    - **系统盘**：存储控制、调度云服务器运行的系统集合。支持查看所选机型的可选系统盘类型，请参考[ 云硬盘类型 ](https://cloud.tencent.com/document/product/362/2353)并根据实际需求进行选择。
    - **数据盘**：用于存储所有的用户数据。
  - **实例名称**：控制台显示的云服务器 CVM 实例名称，该属性受主机名命名模式限制。提供以下两种命名方式：
        - **自动命名**：主机名为自动命名模式，支持批量连续命名或指定模式串命名，最多输入60个字符。默认自动生成实例名，格式为 `tke_集群id_worker`。
        - **手动命名**：主机名为手动命名模式，实例名称与主机名相同，无需重新配置。
 - **登录方式**：提供以下三种登录方式，请根据实际情况进行选择。
    -  **立即关联密钥**：密钥对是通过算法生成的一对参数，是一种比常规密码更安全的登录云服务器的方式。详情请参见 [SSH 密钥](https://cloud.tencent.com/document/product/213/6092)。
     - **SSH密钥**：该配置项仅在选择【立即关联密钥】登录方式时出现，在下拉框中选用已有密钥即可。若需新建，请参考[ 创建 SSH 密钥](https://cloud.tencent.com/document/product/457/32189#.E5.88.9B.E5.BB.BA-ssh-.E5.AF.86.E9.92.A5.3Ca-id.3D.22ssh.22.3E.3C.2Fa.3E)。
    - **自动生成密码**：自动生成的密码将通过 [站内信](https://console.cloud.tencent.com/message) 发送给您。 
    - **设置密码**：请根据提示设置对应密码。
 - **安全组**：默认为创建集群时所设置的安全组，可根据实际需要进行更换或添加。
 - **数量**：创建实例数量，请根据实际需求进行设置。
5. （可选）单击“新建节点”页面中的【更多设置】，查看或配置更多信息。如下图所示：
![](https://main.qcloudimg.com/raw/0e590f5d9254552f7ae8bde1f1a953cf.png)
  - **CAM角色**：可为本批次创建的所有节点绑定相同的 CAM 角色，赋予节点该角色绑定的授权策略。详情请参见[ 管理实例角色](https://cloud.tencent.com/document/product/213/47668#.E6.93.8D.E4.BD.9C.E6.AD.A5.E9.AA.A4)。
  - **容器目录**：勾选即可设置容器和镜像存储目录，建议存储到数据盘。例如 `/var/lib/docker`。
  - **安全加固**：默认免费开通 DDoS 防护、WAF 和云镜主机防护，详情请参见[ T-Sec 主机安全官网页](https://cloud.tencent.com/product/cwp?_ga=1.173966502.440655928.1500464439)。
  - **云监控**：默认免费开通云产品监控、分析和实施告警，安装组件获取主机监控指标。详情请参见 [云监控 CM 官网主页](https://cloud.tencent.com/product/cm)。
  - **封锁初始节点**：勾选“开启封锁”后，将不接受新的 Pod 调度到该节点，需要手动取消封锁的节点，或在自定义数据中执行 [取消封锁命令](https://cloud.tencent.com/document/product/457/18824)，请按需设置。
  - **Label**：单击【新增Label】，即可进行 Label 自定义设置。可用于后续根据 Label 筛选、管理节点。
  - **自定义数据**：指定自定义数据来配置节点，即当节点启动后运行配置的脚本。需确保脚本的可重入及重试逻辑，脚本及其生成的日志文件可在节点的 `/usr/local/qcloud/tke/userscript` 路径查看。
 
[](id:addExistingNode)
### 添加已有节点

>!
- 当前仅支持添加同一 VPC 下的云服务器。
- 请勿添加公网网关 CVM 加入集群，该类型 CVM 重装加入集群后产生 DNS 异常，会导致该节点不可用。

1. 在左侧导航栏中，单击【[集群](https://console.cloud.tencent.com/tke2/cluster)】，进入 “集群管理” 页面。
2. 单击需要添加已有节点的集群ID，进入该集群详情页。
3. 选择【节点管理】>【节点】，单击【添加已有节点】。如下图所示：
![](https://main.qcloudimg.com/raw/777cbee357788b36b851c90436623962.png)
4. 在 “选择节点” 页面，勾选需要添加的节点，单击【下一步】。
5. 在 “云服务器配置” 页面，配置需要添加到集群的云服务器。
主要参数信息如下：
 - 数据盘设置：选择 “将容器和镜像存储在数据盘”。
    - 暂不设置： 不设置容器和镜像的存储路径，系统盘容量足够大或无数据盘的云服务器，或者数据盘需要后续手动挂载并使用的情况，建议选择不设置容器目录。
    - 将容器与镜像存储在数据盘：系统盘容量较小，或有数据盘的主机， 需接受格式化数据盘的情况，可选择设置容器与镜像的存储目录。
 - 操作系统：操作系统为集群级别，您可以前往集群详情页进行修改，修改后新增或重装的节点将使用新的操作系统。
 - 登录方式：
     - 设置密码：请根据提示设置对应密码。
    - 立即关联密钥：密钥对是通过一种算法生成的一对参数，是比常规密码更安全的登录云服务器的方式，具体详情可参阅 [SSH 密钥](https://cloud.tencent.com/document/product/213/6092)。
    - 自动生成密码：自动生成的密码，该密码将通过站内信发送给您。
 - 安全组：用于设置云服务器 CVM 的网络访问控制，请根据实际需求进行选择。您还可以单击【新建安全组】，放通其他端口。
6. 单击【完成】。





