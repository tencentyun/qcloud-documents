弹性网卡是一种虚拟的网络接口，您可以将云服务器绑定弹性网卡接入网络。弹性网卡在配置管理网络、搭建高可靠网络方案时有较大帮助。

弹性网卡具有私有网络、可用区和子网属性，只可以绑定相同可用区下的云服务器。一台云服务器可以绑定多个弹性网卡，具体绑定数量将根据主机规格而定。

## 基本信息

弹性网卡主要具有以下关联信息：

1.主网卡 或 辅助网卡：私有网络的云服务器创建时联动创建的网卡为主网卡，用户自行创建的网卡为辅助网卡，其中主网卡不支持绑定和解绑，辅助网卡支持绑定解绑。

2.主内网 IP：弹性网卡的主要内网 IP，在弹性网卡创建时由系统随机分配或用户自行制定，主网卡的主内网 IP 支持修改，辅助网卡的主内网 IP 不支持修改。

3.辅助内网 IP：弹性网卡主 IP 以外绑定的辅助内网 IP，由用户在创建弹性网卡或编辑弹性网卡时自行配置，支持绑定和解绑。

4.弹性公网 IP：与弹性网卡上的内网 IP一一绑定。

5.安全组：弹性网卡可以绑定一个或多个安全组。

6.MAC 地址：弹性网卡有全局唯一的 MAC 地址。


## 使用约束

根据 CPU 和内存配置不同，云服务器可以绑定的弹性网卡数和单网卡绑定内网 IP 数有较大不同，网卡和单网卡 IP 配额数如下表所示，您还可以查看 [VPC 其它产品的使用约束](https://cloud.tencent.com/doc/product/215/537)。

| 云服务器配置               | 弹性网卡数 | 网卡绑定 IP 数 |
| -------------------- | :---- | :-------- |
| CPU: 1 核   内存: 1G    | 2     | 2         |
| CPU: 1 核   内存: >1G   | 2     | 6         |
| CPU: 2 核             | 2     | 10        |
| CPU: 4 核   内存: < 16G | 4     | 10        |
| CPU: 4 核   内存: > 16G | 4     | 20        |
| CPU: 8~12 核          | 6     | 20        |
| CPU: >12 核           | 8     | 30        |

## 计费方式
免费，有关私有网络服务的更多价格信息，可以查看[私有网络价格总览](https://cloud.tencent.com/doc/product/215/3079)。

## 操作指南


### 查看弹性网卡

1)打开 [私有网络VPC控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)单击弹性网卡的【实例 ID】，进入弹性网卡详情页查看弹性网卡信息。

### 创建弹性网卡

1)打开 [私有网络VPC控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)单击左上角【创建】，在弹窗中选择弹性网卡的所在私有网络、子网。

4)选择弹性网卡分配的内网 IP ，可自动生成，也可手动指定。

5)单击【确认】，完成弹性网卡的创建。

### 绑定和配置弹性网卡（重要）

**步骤1：打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。**

**步骤2：单击左边栏【弹性网卡】，进入弹性网卡列表页。**

**步骤3：找到弹性网卡所在行，单击操作栏中的【绑定云服务器】（仅支持绑定和弹性网卡相同可用区的云服务器）。**

**步骤4：选择需要绑定的云服务器，单击【确定】完成弹性网卡的绑定。**



**步骤5：云服务器内配置新绑定的弹性网卡（非常重要）**
>注意：弹性网卡在控制台绑定后，需要在云服务器内进行配置后才可正常使用。以下是以 centos 7.2 为例的操作步骤：

a. 以管理员身份登录云服务器,执行以下命令


`cd /etc/sysconfig/network-scripts/`


b. 创建新网卡的配置文件 ifcfg-eth1 ：

输入命令：

`cp ifcfg-eth0 ifcfg-eth1`


然后输入命令修改配置文件内容：

`vim ifcfg-eth1`

把配置文件内容修改为：


`DEVICE='eth1'`

`NM_CONTROLLED='yes'`

`ONBOOT='yes'`

`IPADDR='192.168.1.62'  # 根据实际填写，此处写弹性网卡上的地址`

`NETMASK='255.255.255.192'  #根据实际填写，此处写子网掩码`

`GATEWAY='192.168.1.1'  #根据实际填写，此处写网关`


修改后保存配置文件并退出（在vim的末行模式下输入"wq!"并回车）。


**步骤6： 关闭rp_filter校验**


在etc/sysctl.conf中关闭反向过滤。

> 注： 反向过滤指系统在接收到一个IP包后检查该IP是不是合乎要求，不合要求的会丢弃。例如，用户在A网卡上收到一个IP包，发送IP为B。而给B的IP发送时应该用的网卡不是A，则会丢弃。由于默认路由走的是主网卡，所以开启反向过滤后，辅助网卡上的IP会ping不通。

打开配置文件：

`vim /etc/sysctl.conf`

把配置文件中原配置中的

`net.ipv4.conf.default.rp_filter = 1`

修改成：

`net.ipv4.conf.default.rp_filter = 0`
`net.ipv4.conf.all.rp_filter = 0`
`net.ipv4.conf.eth0.rp_filter = 0`
`net.ipv4.conf.eth1.rp_filter = 0`

**步骤7： 重启网络服务**

输入以下命令

`systemctl restart network`

**步骤8：检查和确认**

输入以下查看IP的命令

`ip addr`

确认辅助网卡和辅助网卡上的IP可见。参考下图：

![](https://mc.qcloudimg.com/static/img/682c0cda0fcbdbdb508785b12e102b4a/ip.png)

### 释放内网 IP

1)打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)单击弹性网卡的【实例 ID】，进入弹性网卡详情页查看弹性网卡信息。

4)单击【IP 管理标签页】，查看弹性网卡上已绑定的内网 IP 和弹性公网 IP。

5)单击内网 IP 所在行操作栏的【释放】按钮。

6)单击【确认】完成操作。

>注1：弹性网卡的主 IP 不支持释放，仅辅助 IP 支持释放。

>注2：内网 IP 解绑后，将自动解关联弹性公网 IP。

### 解绑云服务器

1)打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)找到弹性网卡所在行，单击操作栏中的【解绑云服务器】。

4)单击【确认】，完成弹性网卡的解绑。

>**Tips：**弹性网卡解绑后，将保留其关联的内网 IP、弹性公网 IP、安全组等信息。

### 删除弹性网卡

1)打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)找到弹性网卡所在行，单击操作栏中的【删除】。

4)单击【确认】，完成弹性网卡的删除。

>注1：弹性网卡删除后，将自动解关联内网 IP、弹性公网 IP 和安全组。

>注2：您只可以删除未关联云服务器的弹性网卡。

>注3：主网卡将在云服务器删除后一同删除。

### 绑定弹性公网 IP

1)打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)单击弹性网卡的【实例 ID】，进入弹性网卡详情页查看弹性网卡信息。

4)单击【IP 管理标签页】，查看弹性网卡上已绑定的内网 IP。

5)单击内网 IP 所在行已绑定弹性公网 IP 列的【绑定】按钮。

6)在弹窗内选择绑定【已有弹性 IP】列表中的 IP 或【新建弹性 IP】。

7)单击【确认】按钮，完成弹性 IP 绑定。

### 解绑弹性公网 IP

1)打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)单击弹性网卡的【实例 ID】，进入弹性网卡详情页查看弹性网卡信息。

4)单击【IP 管理标签页】，查看弹性网卡上已绑定的内网 IP 和弹性公网 IP。

5)单击内网 IP 所在行已绑定弹性公网 IP 列的【解绑】按钮。

6)单击【确认】按钮，完成弹性公网 IP 解绑。

### 修改主内网 IP

1)打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)单击弹性网卡的【实例 ID】，进入弹性网卡详情页查看弹性网卡信息。

4)单击【IP 管理标签页】，查看弹性网卡上绑定的主内网 IP。

5)单击主内网 IP 所在行操作列的【修改主 IP】按钮。

6)在弹窗内输入新的主内网 IP，单击【确认】完成修改。

### 修改弹性网卡所属子网

1)打开 [私有网络 VPC 控制台](https://console.cloud.tencent.com/vpc) 。

2)单击左边栏【弹性网卡】，进入弹性网卡列表页。

3)单击弹性网卡的【实例 ID】，进入弹性网卡详情页。

4)在弹性网卡详情页的基本信息页面中，单击所属子网的【更换】按钮。

5)在弹窗中选择弹性网卡需要更换的子网，并指定新的主IP。

6)单击【保存】按钮，完成弹性网卡的所属子网更换。

>注1：只有主网卡可以修改所属子网。

>注2：弹性网卡更改所属子网前，请先解绑所有辅助 IP。

>注3：弹性网卡更改所属子网只可以修改为同可用区下的其他子网。

## 常见问题
### Windows系统下，热插的弹性网卡重启后 IP 信息丢失如何处理？
目前热插的弹性网卡需要用户手动去设置 IP 信息，并且子机重启后 IP 信息会丢失。可下载以下工具进行设置。（工具链接：http://enipackage-1251740579.cosgz.myqcloud.com/NetCardIPSet%20%281%29.exe ）。

具体步骤：</BR>
1. windows云服务器下载工具；
  </BR>
2. 插入弹性网卡和绑定IP；</BR>
3. 运行已下载好的工具；



## API 概览
弹性网卡功能 API 概览如下表所示，有关 VPC 内其他资源的更多内容，可以查看[ VPC 所有 API 概览](https://cloud.tencent.com/doc/api/245/909)。


| 接口功能        | Action ID                                | 功能描述        |
| ----------- | ---------------------------------------- | ----------- |
| 创建弹性网卡      | [CreateNetworkInterface](https://cloud.tencent.com/doc/api/245/4811) | 创建弹性网卡      |
| 删除弹性网卡      | [DeleteNetworkInterface](https://cloud.tencent.com/doc/api/245/4813) | 删除弹性网卡      |
| 查询弹性网卡信息    | [DescribeNetworkInterfaces](https://cloud.tencent.com/doc/api/245/4814) | 查询弹性网卡信息    |
| 弹性网卡申请内网 Ip | [AssignPrivateIpAddresses](https://cloud.tencent.com/doc/api/245/4817) | 弹性网卡申请内网 IP |
| 弹性网卡退还内网 IP | [UnassignPrivateIpAddresses](https://cloud.tencent.com/doc/api/245/4819) | 弹性网卡退还内网 IP |
| 弹性网卡绑定云服务器  | [AttachNetworkInterface](https://cloud.tencent.com/doc/api/245/4820) | 弹性网卡绑定云服务器  |
| 弹性网卡解绑云服务器  | [DetachNetworkInterface](https://cloud.tencent.com/document/product/215/4822) | 弹性网卡解绑云服务器  |
