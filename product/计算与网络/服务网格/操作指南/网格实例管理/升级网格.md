TCM提供网格升级服务， 用户可将低版本的网格升级到高版本。升级过程遵循灰度升级原则，TCM将先部署新版本控制面，接下来由用户通过重启的方式将特定命名空间的业务数据面组件升级到高版本，当所有命名空间的业务数据面都切换到高版本并且用户确认业务正常后，可将低版本的控制面下线完成网格升级。灰度过程中，如果用户验证存在不兼容情况需要回滚，也可回退到上一个版本的控制面，取消升级。整个升级流程，如下图所示：

![升级流程](https://main.qcloudimg.com/raw/c31f033b73c16807336ca7261423ba40.svg)

1. 升级提示，当网格版本可升级时，网格界面将会提示有可升级的新版本：

   ![](https://main.qcloudimg.com/raw/f61a7da54bb53f84e22b1c9225029b7f.png)

   点击 前往查看 后，将在【组件管理】界面看到相同的升级提醒，点击提示，可进入升级界面：

   ![](https://main.qcloudimg.com/raw/9fd6878b2863babe1d1f585a1efc2cff.png)

   

   

   

2. 控制面升级，确认升级步骤提示后，TCM将开始部署控制面组件灰度版本：![](https://main.qcloudimg.com/raw/8a83a8af5a98b95a97e099fb77059b9f.png)

3. **数据面升级，用户自行按照命名空间维度滚动更新业务容器，升级数据面的sidecar，并验证业务是否正常。**此步骤需要用户线下完成，否则升级验证将无法校验通过。

4. 升级验证，当用户可在升级验证界面完成升级验证，验证开关打开，数据面将指向新版本的控制面，验证开关关闭，数据面将指向原始版本，点击确认完成最终修改。

   ![](https://main.qcloudimg.com/raw/0540b5fb60a78d6cbac2b622bdcc4dd4.png)

   当所有命名空间切换开关均打开时，数据面均切换到了新版本的控制面，点击确认将下线老版本控制面，完成升级；当所有命名空间切换开关均关闭时，数据面均切换到老版本控制面，点击确认将下线灰度版本的新控制面，完成升级回滚。

   ![](https://main.qcloudimg.com/raw/1f3c0ec4e6234956fb72af739ea29529.png)

   

