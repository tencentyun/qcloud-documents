## 准备构建材料

首先下载使用了 TSF SDK 的 Spring Cloud 应用 Demo JAR 包：[provider-demo-0.0.1-SNAPSHOT.jar](https://main.qcloudimg.com/raw/8a71b41fee7908a6a9a3bd5ef03572d5/provider-demo-0.0.1-SNAPSHOT.jar)。

在该 JAR 包同级目录下，编写 Dockerfile 文件：

```dockerfile
FROM centos:7

RUN echo "ip_resolve=4" >> /etc/yum.conf
RUN yum update -y && yum install -y java-1.8.0-openjdk

# 设置时区。这对于日志、调用链等功能能否在 TSF 控制台被检索到非常重要。
RUN /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
RUN echo "Asia/Shanghai" > /etc/timezone

ENV workdir /data/tsf/
ENV jar provider-demo-0.0.1-SNAPSHOT.jar

COPY ${jar} ${workdir}

WORKDIR ${workdir}
# JAVA_OPTS 在运行时被 bash 替换成环境变量中的值。使用 exec 以使 java 程序可以接收 SIGTERM 信号。
CMD ["sh", "-ec", "exec java ${JAVA_OPTS} -jar ${jar} 2>&1"]
```

## 构建镜像

在 `Dockerfile` 所在目录执行 `build` 命令：

```bash
docker build -t ccr.ccs.tencentyun.com/tsf_<账号 ID>/<应用名>:[tag] .
```

其中 `<账号 ID>` 表示用户腾讯云的账号 ID，`<应用名>` 表示控制台上的应用名。`tag` 为镜像的 tag，用户可自定义。帐号 ID 及应用名可以在 TSF 控制台的应用详情页中获得。

例如：

```bash
docker build -t ccr.ccs.tencentyun.com/tsf_12345678/tsf_test_app:v1.0 .
```

命令执行完成后，通过 `docker image ls` 查看创建的镜像。

![](https://main.qcloudimg.com/raw/7f46b8fc24feb8f397eb9c09f284d843.png)

