## 操作场景
该任务指导您通过 TSF 控制台，完成新建泳道、删除泳道和编辑泳道的操作。

## 前提条件
使用全链路灰度发布之前，需要先配置泳道。一条泳道相当于一个灰度环境，环境中包含应用中需要进行灰度测试的部署组。在 [全链路发布概述](https://cloud.tencent.com/document/product/649/43464) 中的示例图中，我们希望为不同微服务的版本2创建一条泳道，将微服务 A、B、D 部署版本2的部署组都放在一个泳道中。

假设当前访问链路为 gateway -> consumer -> provider。其中 consumer、provider 都有两个版本。希望通过请求参数 test = 1时配置流量通过网关访问到 consumer、provider 的版本1中。

## 操作步骤

### 新建泳道

1. 登录 [TSF 控制台](https://console.cloud.tencent.com/tsf)，在左侧导航栏单击【全链路灰度发布】。
2. 在全链路灰度发布页面单击【泳道配置】>【新建泳道】。
3. 填写泳道名称和备注，单击【下一步】。
 - 泳道名称：必填。最长60个字符，只能包括小写字母、数字及分隔符。
 - 备注：选填。最长200字符。
4. 在选择部署组页面，勾选需要导入泳道的部署组，单击【完成】。
![](https://main.qcloudimg.com/raw/a09e33e4cc19564b77ddbefb66062bb6.png)
此时，我们需要创建一个泳道，将 gateway、consumer 的版本1部署组、provider 的版本1部署组添加到这个泳道中。设置 gateway 为泳道的入口。

#### 过滤条件
- 用户可以通过选择命名空间类型、命名空间名称、应用名称和部署组名称进行筛选过滤部署组。默认提供了命名空间类型和命名空间名称作为过滤条件。
- 当用户希望切换命名空间时，单击当前已经选中的命名空间的名称，在弹出的下拉列表中切换。
- 当用户希望通过应用名称筛选部署组时，单击命名空间右侧的空白位置，便可弹出应用和部署组的下拉选项，如图所示。
![](https://main.qcloudimg.com/raw/ea57cbf2544afd5c54d52cc8c45697e7.png)


#### 泳道入口
- 全链路灰度发布规则配置后，会在泳道的入口部署组上对请求规则进行校验，以此来判断请求是否应该进入某一个泳道中。通常情况下，泳道入口是一个网关。
- 同一个泳道中支持多个入口，在请求经过每一个入口部署组时，都会判断请求是否应该进入泳道中。
- 配置方法：在选择部署组页面勾选需要被导入到泳道中部署组后，在穿梭框的右侧通过泳道入口开关<img src="https://main.qcloudimg.com/raw/f1301505e2665f9c9d17a669befc7571.png" style="margin:0;">配置。


#### 泳道与命名空间
- 当前 TSF 支持两种 [命名空间](https://cloud.tencent.com/document/product/649/15522)：全局命名空间和普通命名空间。
- 普通命名空间之间访问隔离，同一个泳道中不能包含不同普通命名空间中的部署组。
- 泳道中可以包含全局命名空间中的部署组和普通命名空间中的部署组。

>?当前 Mesh 应用不支持部署在全局命名空间中，不支持泳道中同时出现全局命名空间中的部署组和 Mesh 应用的部署组。

### 删除泳道
>!当泳道上已经绑定了全链路灰度发布的规则，则不能删除。

1. 登录 [TSF 控制台](https://console.cloud.tencent.com/tsf)，在左侧导航栏单击【全链路灰度发布】。
2. 在全链路灰度发布页面单击【泳道配置】，进入泳道配置列表页。
3. 选择目标泳道，单击操作列的【删除】。删除后，全链路灰度规则在该泳道上将不可用。


### 编辑泳道
1. 登录 [TSF 控制台](https://console.cloud.tencent.com/tsf)，在左侧导航栏单击【全链路灰度发布】。
2. 在全链路灰度发布页面单击【泳道配置】，进入泳道配置列表页。
3. 单击目标泳道 ID进入泳道详情页。
4. 在基本信息中，单击右上角的【编辑】，可以修改泳道名称和备注。
在部署组管理中，可以向泳道添加或移除部署组，也可以设置某个部署组为泳道入口。





