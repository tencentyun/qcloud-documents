## 操作场景

应用配置功能有两个入口，一个入口是在单个应用的应用详情页内，另一个入口是在**配置管理**模块的**应用配置**。应用配置功能**仅针对 Spring Cloud 应用和 Dubbo 应用生效**，应用配置支持如下功能：

- 创建配置项：一个配置项管理多个版本的配置。
- 生成新版本：基于历史版本生成新版本。
- 发布配置：支持发布配置到部署组。
- 发布情况：查看配置项的发布到哪些部署组。
- 回滚：回滚到上一个版本的配置。

>?原生应用与 Mesh 应用不支持分布式配置。

以下视频将为您介绍配置管理中应用配置及其他配置的使用方法：

<div class="doc-video-mod"><iframe src="https://cloud.tencent.com/edu/learning/quick-play/2039-24426?source=gw.doc.media&withPoster=1&notip=1"></iframe></div>

## 前提条件

在使用控制台的应用配置功能前，请确保已经按照 [分布式配置](https://cloud.tencent.com/document/product/649/16620) 配置了相关依赖项。

## 操作步骤

### 创建配置

1. 登录 [TSF 控制台](https://console.cloud.tencent.com/tsf/index)。
2. 在左侧导航栏，单击**配置管理** > **应用配置**。
3. 在应用配置页面顶部，选择目标应用。
4. 在配置列表标签页，单击**新建**。
   ![](https://main.qcloudimg.com/raw/d7d91aa6c169c8645601f1d6fa1ded2e.png)
5. 填写配置内容。
   - 配置名称：填写配置名。
   - 配置内容：按照 YAML 格式。YAML 格式规范参考 [YAML 格式介绍](https://cloud.tencent.com/document/product/649/17925)。
   - 标签：用于分类管理资源，可不选。详情参考 [标签](https://cloud.tencent.com/document/product/649/53869)。
   - 版本号：填写初始版本号。
   - 版本描述：填写初始版本的描述。
6. 单击**完成**。

> !单个应用配置版本的大小不能超过65535个字节，如果应用的配置超过了该上限值，可以分成多个应用配置项发布到同一个部署组，多个配置会合并成一份配置。

### 生成新版本配置

1. 在配置列表页，单击目标配置名称，进入详情页。
2. 在配置版本标签页，单击某个配置版本旁的**生成新版本**。 
   ![](https://main.qcloudimg.com/raw/39ef26ef8d8cabd3eeff71d89bf715bb.png)
3. 填写变更的新版本的配置内容和版本号。
> !新版本配置的版本号不能与原版本相同。
4. 单击**完成**。



### 发布配置

用户可以发布配置项的某个版本到部署组上。

1. 在配置列表页，单击目标配置名称，进入详情页。
2. 在配置版本标签页，单击某个配置版本旁的**发布**。 
3. 选择配置发布的目标部署组，填写发布描述。
4. 单击**下一步**，单击**完成**。



#### 配置合并逻辑说明

按照配置**下发时间**来排序执行合并（merge）。不同名的配置项中如果存在相同 key 会进行合并。合并规则：按照配置下发时间排序，离当前时间近的优先级较高。举例如下：

```
1. 创建配置项 config-abc，配置内容是 custom-key: value-1，发布时间 15:00:00
2. 创建配置项 config-bcd，配置内容是 custom-key: value-2， 发布时间15:00:01
```

最终在实例上生效的配置：`custom-key: value-2`



### 查看部署组的配置发布历史

用户可以单击操作列的**查看发布信息**查看该配置相关部署组的配置发布记录。

1. 在左侧导航栏，单击**配置管理** > **应用配置** > **查看发布信息**，进入发布情况页面。
2. 展开部署组，查看该部署组的配置发布记录。
3. 单击每条发布记录， 可查看配置发布前后区别。
   ![](https://main.qcloudimg.com/raw/e4204f5e8932e40f8fb4b01fb8893405.png)

### 回滚配置

回滚配置会将部署组的配置回滚到**上一次**发布的版本。

1. 进入**发布情况** 界面，查看部署组的发布历史。
2. 在相应部署组的操作中，单击**回滚**。
3. 可查看回滚前后配置变化，单击**提交**。
   ![](https://main.qcloudimg.com/raw/b6fbc1123302b7f3ef5adad209f6d5ab.png)
