工作流管理通过将不同任务单元进行逻辑组合构建任务的上下游依赖关系，适配复杂的业务场景满足不同业务领域用户的任务流程编排需求，并提供可视化流程引擎交互简单、操作方便，帮助您快速构建清晰精准的业务流应用。

## 应用场景

**发布流水线：**应用发布流水线需按照特定的流程如代码拉取、代码扫描、单元测试、编译构建、滚动发布，涉及多个组件按照严格的依赖顺序协作处理，通过应用分布式任务调度工作流编排能力可帮助企业快速实践落地 DevOps 理念适应微服务应用的发展。

**金融日切：**金融行业的日切需多个系统按照一定的顺序严格依次执行完成日切操作，使用任务编排功能，可轻松的完成任务依赖调整，直观地查看任务的执行进度。

## 功能特性

- 支持可视化流程编排：提供可视化流程编排引擎操作简单、流程清晰。
- 支持任务的串行、并行执行：支持任务串并行操作，满足不同的任务依赖场景。
- 支持 “且”、“或” 的逻辑节点：通过 “且”、“或” 逻辑组合适配复杂的逻辑关系。
- 支持“成功触发”、“失败触发” ：提供任务 “成功触发”、“失败触发” 满足条件判定需求。
- 支持核心任务节点：以核心任务节点成功判断该工作流的执行批次的执行结果。

## 操作步骤

该任务指导您通过 TSF 控制台，完成工作流的创建、执行、查看等详细操作流程。

> ?分布式任务调度当前发布的为 beta 版本，如果您在使用中有任何不便或诉求，欢迎 [提交工单](https://console.cloud.tencent.com/workorder/category?level1_id=876&level2_id=931&source=0&data_title=腾讯微服务平台%20TSF&step=1) 向我们反馈，我们将持续改进，非常感谢您的支持。

### 创建任务

1. 登录 [TSF 控制台](https://console.cloud.tencent.com/tsf/index)。 
2. 在左侧菜单栏中，找到**组件中心**分类，单击**分布式任务调度**>**工作流管理**，进入工作流管理页面。
3. 在工作流管理页面，单击**新建**，在新建任务的弹框中输入您的任务设置。
   ![](https://main.qcloudimg.com/raw/8e84d3149a4dae757a0be286b675b7d7.png)
4. 新建工作流分为两步骤：基本信息、任务流配置，两个步骤可单独保存。
5. 创建工作流基本信息：
	- **任务名称**：填写方便您理解的任务名称。
	- **触发方式**
		- 定时触发：触发方式为“定时触发”时，可通过 cron 表达式设置任务的执行时间（所设置的 cron 表达式需符合 Quartz 规范）。
		- 周期触发：通过设置任务触发的间隔时间来设置任务的执行时间；可支持 cron 表达式所不支持的周期设置。
	- **超时设定**：判定工作流批次超时的执行时长；执行时间超出此预设值且该工作流批次中仍存在任务未完成，将该工作流批次判断为“超时”。
![](https://main.qcloudimg.com/raw/9393042ceca25eac28d65d7a4c8a065a.png)

6. 任务流配置
	- **导入任务**：支撑将现有任务导入到工作流，任务仅能导入一个工作流，任务导入工作流后则不再按原有的定时、周期调度方式触发执行。新产生的任务批次需在**工作流任务**中进行查看，并无法针对单个工作流任务执行**重新执行**操作。
	- **新建任务：**新建任务触发方式为工作流触发，将任务从工作流移除后可在**任务管理**中对任务触发方式进行**编辑**更新为定时或周期触发。
	- **新建逻辑节点：**可在工作流新增逻辑节点 “且”、“或” 组合复杂的逻辑关系。
![](https://main.qcloudimg.com/raw/a5c9cad5b0c5a47bfec5cda2ebcc5bfd.png)
设置完成后，单击**保存**，所创建的任务将显示在任务列表中。

> ?
> - 每个工作流最多可导入或新建20个任务，如果您在使用中不满足诉求，欢迎 [提交工单](https://console.cloud.tencent.com/workorder/category?level1_id=876&level2_id=931&source=0&data_title=腾讯微服务平台%20TSF&step=1) 向我们反馈。
> - 任务节点必须包含一个上游节点，一个逻辑节点必须包含一个或多个上游节点且逻辑节点上下游必须是任务节点。

### 执行任务

1. 在 **[工作流管理](https://console.cloud.tencent.com/tsf/tct-workflow?rid=1)** 中，找到工作流管理列表中的目标工作流。
2. 单击操作列中的**更多**>**运行一次**，手动触发所选工作流的一次执行。
   工作流将无视所设置的触发方式和时间执行一次，您可在 **[执行记录](https://console.cloud.tencent.com/tsf/tct-exec)** 的**工作流**执行记录或**工作流详情**中**执行记录**查看此次执行的情况。

### 查看任务详情

1. 在 **[工作流管理](https://console.cloud.tencent.com/tsf/tct-workflow?rid=1)** 中，找到任务列表中的目标任务。
2. 单击工作流 ID，进入工作流的详情页，查看工作流信息和执行记录。
3. 工作流**基本信息**：可以查看工作流的触发方式、触发事件、超时时间等基本信息及任务流拓扑。可通过**编辑**更新工作流的基本信息和任务流拓扑。
   ![](https://main.qcloudimg.com/raw/ab699d36744aa3ac0c72ceda90d11818.png)
4. 工作流**执行记录**：可以查看工作流批次的历史执行记录，单击 **工作流批次ID** 或 **详情** 进入工作流**执行详情**展示任务流拓扑的执行状态，可以通过 **工作流批次ID** 进行模糊搜索或通过执行 **状态** 进行过滤，单击 **更多** 可对正在运行的工作流批次 **停止执行** 或对已经完成的批次 **重新执行** 。
   ![](https://main.qcloudimg.com/raw/76ca2fcf0eba9c9482cf2407c14ff0c7.png)

### 编辑任务

任务创建后，您可以在 **[工作流管理](https://console.cloud.tencent.com/tsf/tct-workflow?rid=1)** 中随时修改任务的设置及启用状态。

- 编辑任务设置
  - 方式一：在工作流列表页中找到目标工作流，单击操作列中的**编辑**
  - 方式二：进入目标工作流的工作流详情页，单击**基本信息**页右上方的**编辑**
    编辑完成后，单击**保存**，成功后任务的修改即实时生效，
- 启用 / 停用任务：您也可以通过工作流列表页，单击操作列中的**更多** > **启用/停用**，快速修改任务的启用状态。

> ?工作流的修改只对修改后触发的执行有效，不影响修改前已开始的执行。

### 删除任务

工作流创建后，您可以在 **[工作流管理](https://console.cloud.tencent.com/tsf/tct-workflow?rid=1)** 中随时删除任务。

1. 在工作流列表中的目标工作流。
2. 单击操作列中的**更多** > **删除**，工作流将被自动停用，不会再触发新的执行，但不影响已经开始的执行。
