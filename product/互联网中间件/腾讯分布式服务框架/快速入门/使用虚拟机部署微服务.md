在使用虚拟机部署微服务之前，请参考 [协作者与子账号使用TSF](https://cloud.tencent.com/document/product/649/16869) 文档检查自己是否已经有权限使用 TSF 产品的全部功能。

## 步骤 1：创建虚拟机集群

### 新建虚拟机集群

首先您需要创建虚拟机集群。集群是实例等云资源的集合。

1. 登录 [TSF 控制台](https://console.cloud.tencent.com/tsf/index)。
2. 在 [左侧导航栏](https://console.cloud.tencent.com/tsf?rid=1) 中，单击 [**集群**](https://console.cloud.tencent.com/tsf/cluster?rid=1)，进入集群列表页。
3. 在集群列表页，单击【新建集群】。
4. 设置集群的基本信息。
 - **集群名称**：集群名称，不超过 60 个字符。
 - **集群类型**：选择集群类型。
     - 虚拟机集群：虚拟机集群中的云服务器用于部署虚拟机应用。
     - 容器集群：容器集群中的云服务器用于部署容器应用。
 - **集群网络**：为集群内主机分配在云服务器网络地址范围内的 IP 地址。参阅 [集群及容器网络设置](https://cloud.tencent.com/document/product/649/16926)。
 - **容器网络**（仅适用于容器集群）：为集群内容器分配在容器网络地址范围内的 IP 地址。[集群及容器网络设置](https://cloud.tencent.com/document/product/649/16926)
 - **集群描述**：集群的描述，不超过 200 个字符。



### 将云服务器导入集群

在导入主机之前请先确定已经购买了腾讯云上的主机使用服务。

1. 在 [集群列表页](https://console.cloud.tencent.com/tsf/cluster?rid=1) 中，单击目标集群**ID/集群名**，进入集群详情页 。
2. 单击云服务器列表上方的 【**导入云主机**】 按钮。
3. 从集群所在 VPC 的云服务器列表中，选择需要添加到集群的主机。
4. 云服务器配置
 - 登录方式：提供三种对应登录方式。
     i. 设置密码：请根据提示设置对应密码。
       ii.立即关联密钥：密钥对是通过一种算法生成的一对参数，是一种比常规密码更安全的登录云服务器的方式。详细参阅 [SSH 密钥](https://cloud.tencent.com/document/product/213/6092?)。
       iii.自动生成密码：自动生成的密码将通过站内信发送给您。
 - 安全组：安全组具有防火墙的功能，用于设置云服务器的网络访问控制。
	![](https://main.qcloudimg.com/raw/5404780f7c1568d2f8da75c9e384343a.png)
5. 新添加的云服务器将出现在【ID/云主机名】列表中。 几分钟后刷新列表，操作成功，则云服务器的可用状态显示可用。 


## 步骤 2：创建虚拟机应用

1. 在 [左侧导航栏](https://console.cloud.tencent.com/tsf?rid=1)，单击 [**应用管理**](https://console.cloud.tencent.com/tsf/app?rid=1)，进入应用列表。
2. 在应用列表上方单击【新建应用】。
3. 设置应用信息后，单击【提交】按钮。
   - 应用类型：虚拟机应用将部署在云服务器上
   - 部署方式：选择虚拟机部署


## 步骤 3：创建部署组

1. 在 [应用列表](https://console.cloud.tencent.com/tsf/app?rid=1)，单击新建应用的 ID，进入应用详情页=> 部署组标签页。
2. 在应用详情页=> 部署组标签页的上方，单击【新建部署组】按钮。
3. 设置部署组相关信息。
 - 部署组名称：部署组的名称，不超过 60 个字符。
 - 集群：选择希望建立部署组的集群。可以选择上文建立好的集群。
 - 命名空间：选择希望建立部署组的命名空间。可以选择上文中建立好的命名空间。
 - 日志配置项：应用的日志配置项用于指定 TSF 采集应用的日志路径。参考 [日志服务](https://cloud.tencent.com/document/product/649/13697)。
4. 单击【提交】按钮。

## 步骤 4：在部署组中添加实例

1. 在部署组列表的右侧，单击【添加实例】。
![](https://main.qcloudimg.com/raw/1256b0927b646ca591ce95cc379a145f.png)
2. 选择要添加进部署组的云服务器，单击【提交】。
3. 在部署组的详情页，实例列表页面中显示出刚刚添加的云服务器。


## 步骤 5：上传程序包

1. 在 [左侧导航栏](https://console.cloud.tencent.com/tsf?rid=1)，单击 [**应用管理**](https://console.cloud.tencent.com/tsf/app?rid=1)，进入应用管理列表页。
2. 在 [应用管理列表页](https://console.cloud.tencent.com/tsf/app) ，单击目标应用的**ID/应用名**，进入应用详情页。
3. 在应用详情页的上方，单击**程序包管理**标签页，单击【上传程序包】按钮。
![](https://main.qcloudimg.com/raw/329bf72f05485be9477aa784656aaea9.png)
4. 在**上传程序包**对话框中填写相关参数。
  - 上传程序包：单击【选择文件】，选择编译为 jar 格式的程序包
  - 程序包版本：填写版本号，或单击【用时间戳作为版本号】
  - 备注：填写备注  
5. 单击【提交】按钮，程序包上传成功后出现在程序包列表中。

## 步骤 6：部署应用


1. 在部署组列表页的右侧，单击【部署应用】。
![](https://main.qcloudimg.com/raw/5913a88a12e8a8095cd470ae656b1388.png)
2. 选择程序包后，单击【提交】按钮。
3. 应用部署成功后，部署组中的**已启动/总机器数**数值发生变化。
![](https://main.qcloudimg.com/raw/fb58fc2d6b9b3fa3e55746b09b3f720f.png)

