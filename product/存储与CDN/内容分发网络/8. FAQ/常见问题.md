## 1.基础介绍
### 1.1腾讯云CDN节点分布，有没有海外节点？
目前已经有海外节点分布。腾讯云CDN开放了腾讯十多年的节点积累，截至到2015年初，我们已经开放了500+个国内节点，分布在6个地区，28个省份，20+个运营商，带宽总量超过20T。并且在2014年，腾讯云CDN已覆盖香港和美国节点，2015年将扩大海外资源分布，支持全面的海外加速。
### 1.2CDN节点的数据是实时更新吗？
不会实时更新。CDN节点根据您在控制台上到期时间来更新缓存，如果您继续更新某个文件缓存，可以通过手动刷新的方式使cdn节点的文件保持最新状态。
### 1.3CDN支持https吗？
https目前处在邀请测试阶段，暂时还不提供申请，还请谅解。我们正在完善此特性，一旦产品成熟，我们会第一时间公布，敬请期待。
### 1.4中间源的作用是？
中间源即：中间源服务器，是位于业务服务器（即源站）和CDN节点的一个中间层的回源服务器。中间源服务器可缓存CDN节点的回源访问，降低业务服务器（即源站）的访问压力。
注：中间源配置只有在“自有源”方式接入下才可使用。
### 1.5CDN加速支持非80端口吗？
目前只支持80、443、8080 三个端口。
### 1.6CDN是否支持泛解析？
已经支持泛域名接入。

## 2.接入相关
### 2.1接入腾讯云cdn，需满足什么条件？
必须同时满足以下三个条件：1) 加速的域名必须在工信部成功备案;2) 源站的80端口必须开放;3) 网站内容需合法；
### 2.2接入腾讯云cdn，源站需要改造吗？
基本不需要，但为了达到更优的加速效果，建议您先做动静分离，动态文件和静态文件放在不同的域名下面，只对静态资源做加速。
### 2.3cdn域名审核通过之后，状态会变成“部署中”，这个状态需要多久会变成“已启动”？
CDN“部署中”状态持续时间不超过30分钟，若您的域名“部署中”状态超过30分钟，您可及时提交工单联系我们协助您处理。
### 2.4腾讯云cdn的配置时效是多长时间？
CDN配置设置时间一般≤30分钟，若您的配置设置等待时间超过30分钟，您可及时提交工单联系我们协助您处理。

## 3.日常使用
### 3.1cdn只能关闭，不能删除是什么原因？
请检查用户是否是协作者身份。
### 3.2接入cdn之后，无法修改相关参数？
若无法修改CDN相关配置参数，请先检查您的域名状态是否为“部署中”，若状态为“部署中”即CDN正在配置该域名的参数信息，待域名状态变更为“已启动”后，您即可对该域名的相关CDN参数进行修改。
### 3.3.CDN自有源，可以设置不缓存某种文件吗？缓存时间设置成0，是否就是不缓存？
您可以按照目录和文件类型设置对应的缓存时间；若缓存时间设置为0，即CDN节点不缓存该资源，用户每次发送访问请求至CDN节点时，CDN节点都需回源站拉取相应资源。相关缓存设置可参照：
http://www.qcloud.com/doc/product/228/CDN%E9%85%8D%E7%BD%AE%E6%89%8B%E5%86%8C#cdn配置管理：缓存时间
### 3.4在CDN管理下关闭接入域名，关闭后CDN节点上的文件会怎么样？
若您关闭当前已接入CDN的域名的CDN服务，则：CDN节点将会保留对应域名的接入配置，但不在产生CDN流量，该域名下的请求都将直接回源；
在做此操作前，请确认您已将该域名的CNAME设置修改为对应A记录，否则该域名将无法访问；同时需确认您的源站带宽处理能力是否足够，否则会影响您域名的正常访问。
### 3.5是否支持源站的cache-control设置?
腾讯云CDN默认支持源站的cache-control设置。
### 3.6 托管源容量如何提升？
  为保证部分客户在使用托管源中，由于容量不足，导致无法及时上载相关数据，导致客户的业务上线受到一定影响。根据用户消费情况，执行以下消费带宽与容量对应的自动规则，达到相应消耗带宽，托管源容量将实现自动扩容。
扩容描述：
1)	扩容对象：所有在网客户。
2)	策略：针对已经扩容到对应等级容量的用户，监控容量超过80%，提取客户近30天平均带宽，判断平均带宽是否符合升级要求，符合就启动对应策略执行扩容当前容量50%，扩容上限不超过下表对应空间值。如果客户在网不满30天，计算当前统计的平均带宽。
3)	针对已经扩容到超多对应容量的客户，容量不收回，不扩容。
4)	针对特殊需求，请提工单额外申请并说明申请缘由。
自动扩容对应关系：

| FTP带宽/容量对应表 | 带宽       | FTP容量上限（G） |
| ----------- | -------- | ---------- |
| 1           | <1G      | 6          |
| 2           | 1-1.5G   | 15         |
| 3           | 1.5-2.5G | 25         |
| 4           | 2.5-5G   | 50         |
| 5           | >5G      | 50         |



| SVN带宽/容量对应表 | 带宽       | SVN容量上限（G） |
| ----------- | -------- | ---------- |
| 1           | <1G      | 6          |
| 2           | 1-1.5G   | 10         |
| 3           | 1.5-2.5G | 18         |
| 4           | 2.5G-5G  | 36         |
| 5           | >5G      | 36         |




### 3.7接入cdn之后，如何绑定CNAME?
可以参考如下链接中文档说明:http://bbs.qcloud.com/forum.php?mod=viewthread&tid=5090&extra=page%3D1
### 3.8动态文件如何设置缓存？
可以参考如下链接中文档说明:http://bbs.qcloud.com/forum.php?mod=viewthread&tid=5351&page=1&extra=#pid21436
### 3.9源站IP可以配置多个吗？
您可配置多个源站IP；当您配置了多个IP后，CDN在回源请求时会依次访问所填的全部IP，当有回源IP不可用时，CDN回源请求会智能跳过，访问下一个可用的IP。
### 3.10如何设置缓存时间？
可以参考如下链接中文档说明:https://www.qcloud.com/doc/product/228/3175
### 3.11CDN刷新支持对目录刷新吗？
目前CDN已经支持目录刷新，支持对URL刷新。您可在腾讯云CDN管理台进行url刷新，也可通过调用api方式进行刷新，对应api地址如下：https://www.qcloud.com/doc/api/231/3946

### 3.12腾讯CDN支持跨域访问吗？
  腾讯云CDN在处理跨域访问时，是不做跨域限制，如果用户网站需要跨域访问，需要在自身网站中配置Access-Control-Allow-Origin字段即可。配置可参考如下方法（免责声明：以下两种方法仅供参考，如有问题，请根据您网站实际情况配置）：
  ● Apache配置方法
1. httpd.conf
   去掉注释LoadModule headers_module modules/mod_headers.so
2. 修改以下配置
   1.conf/extra/httpd-ssl  
   1.    <VirtualHost>  
   2.    ...  
   3.    Header add Access-Control-Allow-Origin *  
   4.    </VirtualHost>  


增加需要跨域访问的域名，如 Header add Access-Control-Allow-Origin http:// www.qcloud.com 
1. 重启apache
   详细参考文档：http://www.w3.org/TR/cors/
   ● Nginx配置方法
   nginx中配置跨域支持功能
   在nginx.conf中配置
   http {
   ......
   add_header Access-Control-Allow-Origin *;
   ......
   }
   增加需要跨域访问的域名，如 add_header Access-Control-Allow-Origin http:// www.qcloud.com; --指定允许的url;
   配置项详细解释：http://www.w3.org/TR/cors/#access-control-allow-methods-response-header 。
   免责声明：以上两种方法仅供参考，如有问题，请根据您网站实际情况配置。
## 4.问题排查
### 4.1接入cdn之后网站打不开，如何排查？
1) 请先检查接入域名的CDN状态是否为“已关闭”，若为“已关闭”状态则对应网页无法打开；若非“已关闭”状态时，可按照下列2)、3)步骤进一步检查；
2) 通过ping或nslookup检查该域名的cname解析是否已生效;
3) 检查源站是否能正常访问。
### 4.2命中率低是什么原因呢？
影响命中率的几个原因：
1)缓存配置问题，如缓存时间较短；
2)Http Header导致无法缓存，请检查源站cache-control或expires的设置;
3)源站类型，可缓存的内容少;
4)网站访问量低，过期时间短，命中的文件少，导致频繁回源。
### 4.3如何判断用户访问的是哪个CDN节点 ？
您可通过nslookup和ping命令可以获取用户访问的CDN节点的IP和延时丢包等基本的排错信息。
### 4.4为什么同名文件节点返回的文件大小不一致？
因为所有文件类型都默认缓存，CDN节点上可能存在不同的文件版本。
解决方法：
1)强制刷新文件，立即更新缓存；可以参考http://bbs.qcloud.com/forum.php?mod=viewthread&tid=5096&extra=page%3D1；
2)带上版本号，例如http://www.xxx.com/xxx.js?version=1;
3)更换其它文件名，不使用同名文件。
### 4.5用户感觉CDN访问慢？
大文件关注下载速度，小文件关注延时
a.首先得到用户访问慢的url，通过测速网站判断是否访问慢（推荐工具： 17ce http://www.17ce.com , 阿里测 http://alibench.com ）
b.如果测速确实慢，而且是FTP托管源或SVN源，反馈到二线进行处理
c.如果测速显示慢，源站属于自有源，协助用户排查源站机器负载和带宽是否受限
### 4.6如何判断用户访问是否命中CDN cache？
查看访问回包头部的X-Cache-Lookup信息
![](//mccdn.qcloud.com/static/img/b28aa4df70343f6bd74290a1f0b85ab7/image.png)
X-Cache-Lookup:Hit From MemCache 表示命中CDN节点的内存
X-Cache-Lookup:Hit From Disktank 表示命中CDN节点的磁盘
X-Cache-Lookup:Hit From Upstream 表示没有命中CDN