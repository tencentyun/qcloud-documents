## 现象描述

实时监控中流量命中率的数值偏低，不符合预期。

## 可能原因

- 进行了缓存刷新
  缓存刷新会清空节点上指定内容，短时间会出现命中率下降的情况。
- 源站含新资源
  源站新资源较多，会引起 CDN 节点回源，流量命中率出现下降趋势。
- 源站异常
  若源站出现故障，5XX或4XX较多时，也会影响流量命中率。
- 缓存策略配置不当
  请根据您的实际业务情况配置缓存规则。
- 关闭分片回源
  若关闭了分片回源，导致回源时拉取整个大文件，而不是按照请求时分片拉取，会拉高回源流量，从而影响流量命中率。
- 命中了域名配置的缓存键规则 - 忽略全部参数，但源站资源根据参数不同而不同
  源站资源根据参数不同而不同，而 CDN 是忽略全部参数进行缓存，当请求不同参数的资源时，无法匹配到对应的资源，从而影响流量命中率。

## 解决思路

1. 检查您的源站，确保源站无异常。
2. 若您进行了缓存刷新或源站新资源较多，此为正常现象。
3. 确保源站根据 URL 参数吐出不同的资源和 CDN 域名配置的缓存键规则 - 忽略全部参数不同时使用。
4. 根据实际业务情况配置缓存规则。

## 处理步骤
[](id:step1)
1. 检查您的源站是否异常或是否进行了缓存刷新。
   - 是，命中率下降为正常现象。
   - 否，请执行 [步骤2](#step2)。
[](id:step2)
2. 根据自身业务情况，判断源站是否根据 URL 参数吐出不同的资源。
   - 是，请执行 [步骤3](#step3)。
   - 否，请执行 [步骤5](#step5)。
[](id:step3)
3. 登录 [CDN 控制台](https://console.cloud.tencent.com/cdn)，选择【域名管理】找到对应的域名配置， 查看【缓存配置】>【缓存键规则配置】的“忽略参数”项：检查 CDN 配置域名是否开启忽略参数缓存功能。
![img](https://main.qcloudimg.com/raw/53ceba436ae110bd0dafef8bad72ceff.png)
   - 是，请执行 [步骤4](#step4)。
   - 否，请执行 [步骤5](#step5)。
[](id:step4)
4. 在缓存键规则配置中对应规则的操作栏，单击【修改】，在弹出的“修改规则”框关闭忽略参数功能，然后单击【保存】。
![img](https://main.qcloudimg.com/raw/f866bc80c384bc6daca649dbeb006fdb.png)
>? 如果用户不方便全部关闭，这里 CDN 也提供了保留指定参数的忽略功能， 用户也可以根据实际的业务需求进行选择使用。具体用法可参见 [缓存键规则配置](https://cloud.tencent.com/document/product/228/47671)。
>
[](id:step5)
5. 登录 [CDN 控制台](https://console.cloud.tencent.com/cdn)，选择【域名管理】找到对应的域名配置， 查看【缓存配置】>【节点缓存过期配置】，请您查看缓存规则是否符合自身业务和源站的实际情况。
   - 是，请执行 [步骤5](#step5)。
   - 否，请参考  [节点缓存过期配置](https://cloud.tencent.com/document/product/228/47672) 调整您的缓存规则。
