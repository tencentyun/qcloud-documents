## 运行系统要求

以下是存储网关运行的系统最低配置和推荐配置。

>!
>
>- 如果系统低于最低配置要求，存储网关可能无法正常启动或运行。
>- 由于当前版本暂不支持对包年包月的网关进行销毁退费，为了避免造成不必要的损失，请确保您的机器满足最低配置要求。
>- 2019年12月19日之后申请存储网关公测的用户、以及2020年06月08日存储网关正式商用以后的新用户，仅能使用 NFS 协议的文件网关，暂不支持其他类型的网关和协议。

| 网关类型 | 最低机器配置                                  | 推荐机器配置                                     | 磁盘配置            |
| -------- | --------------------------------------------- | ------------------------------------------------ | ------------------- |
| 文件网关 | <li>4核 CPU<br><li>8GB 内存<br><li>8Mbps 带宽 | <li>8核 CPU<br><li>16GB 内存<br><li>120Mbps 带宽 | 最少2块10G 以上磁盘 |

## 磁盘及带宽要求

### 文件网关


<table>
<thead>
<tr>
<th>类目</th>
<th>推荐配置</th>
</tr>
</thead>
<tbody><tr>
<td nowrap="nowrap">本地上传带宽</td>
<td>本地上传带宽需要满足上传带宽 x 每日上传时长大于每日新增数据量</td>
</tr>
<tr>
<td>本地下载带宽</td>
<td>下载带宽根据您对本地未缓存的数据访问性能需求来确定</td>
</tr>
<tr>
<td>缓存区磁盘</td>
<td>用于存储新写入数据及读取到本地的热数据，磁盘容量需要大于每天新写入数据量和需要频繁读取的数据预估量</td>
</tr>
<tr>
<td nowrap="nowrap">元数据存储磁盘</td>
<td>1GB容量可存储10万个文件的元数据信息，同时，每块元数据存储磁盘中有512MB空间作为系统预留。建议按照文件系统中预计文件数量的1.2倍配置元数据磁盘</td>
</tr>
</tbody></table>





例如，有十亿个文件存储在 COS 的 bucket 上，当用户配置该 bucket 到本地存储网关，因此推荐用户配置最小10TB元数据盘，但为了后续预留增长空间，建议元数据盘配置为12TB。

>!小于10GB 的磁盘不能用作“缓存区”或“元数据存储”磁盘。

## 网络及网关安全组

为了保障数据安全、防止来自公网的 NFS 连接，建议运行存储网关服务的主机配置如下安全组：

| 端口                                  | 协议 | 用途                                   | 开放建议                                             |
| ------------------------------------- | ---- | -------------------------------------- | ---------------------------------------------------- |
| 22 端口                               | TCP  | 使用该端口通过 SSH 访问并管理 CSG 主机 | 可以选择性对内部网络内的主机开放                     |
| 80 端口                               | TCP  | 使用该端口激活网关                     | 需要对登录腾讯云控制台执行激活存储网关操作的主机开放 |
| 111，662，892，2049，8082，32803 端口 | TCP  | 使用该端口连接文件系统                 | 对需要挂载文件系统的客户端开放                       |
| 111，662，892，2049，32769 端口       | UDP  | 使用该端口连接文件系统                 | 对需要挂载文件系统的客户端开放                       |

>?
>
>-  对于在腾讯云部署的网关，您需要将网关部署至和需要使用网关的云上应用同一私有网络下。
>-  文件网关由于使用 NFS 协议，客户端可以使用 NFS 协议通过公网挂载并访问。但是，由于 NFS 协议传输未加密，出于安全考虑，不建议您的客户端与文件网关通过公网互联。

## 注意事项

### 重启及关机注意事项

>!直接重启本地网关所在虚拟机或者虚拟机所在物理机掉电，都可能造成本地缓存数据和云上数据不一致，从而导致存储网关无法正常工作。

当存储网关在使用中时，请务必通过存储网关控制台来停止服务。操作完成后，当控制台上该网关处于停止状态后，再重启运行 CSG 的虚拟机。

如果一旦发生这种情况，导致网关无法正常工作，请及时 [提交工单](https://console.cloud.tencent.com/workorder/category) 联系我们。

### 存储网关主机密码

出于安全原因考虑，运行存储网关的虚拟机暂不提供 root 权限（即使此处配置了 root 也无效）。请使用下面用户名/密码进行登录到存储网关主机进行维护。

```
Username: csguser
Password: csg123
```

> !为了保障您的存储网关程序后续能够正常升级以及与云端通讯，请不要修改存储网关主机的密码。若修改密码，可能会导致网关无法正常服务。

### 文件系统注意事项

创建文件系统后，网关不会主动去感知从 COS 侧发起的数据增加或删改动作，为了避免由于网关数据和存储桶中数据不一致导致的故障，对于已创建文件系统的存储桶，请不要直接从 COS 侧发起操作。
