## 概述
JSON 格式的日志会自动提取首层的 key 作为对应字段名，首层的 value 作为对应的字段值，以该方式将整条日志进行结构化处理，每条完整的日志以换行符 `\n` 为结束标识符。例如：您的一条日志原始数据为：
```
{"action":"GET","time":"2017-12-10 08:00:00","status":"200","ip":"172.168.xxx.xxx"}
```

该条日志最终被日志服务结构化处理成：`action:GET`、`time:2017-12-10 08:00:00`、`status:200`、`ip:172.168.xxx.xxx`。

## 采集配置
### 1. 登录控制台
登录 [日志服务控制台](https://console.cloud.tencent.com/cls)，左侧导航栏选择 【日志集管理】。

### 2. 开启 LogListener 采集
单击需要开启 LogListener 采集的日志集，在日志主题里单击需要配置的日志主题，在采集配置界面中单击右上角【编辑】按钮，进入到编辑模式，然后开启 **采集状态** 和 **使用 LogListener**。

### 3. 填写采集路径
采集路径处需要填写需要采集的完整路径，而非目录格式（即需要以 / 开头，非 / 结尾，如`/data/log/cls.log`），文件名支持正则，目前暂不支持通配符。**特别提醒，采集路径中仅允许日志文件名称使用正则**。

### 4. 关联机器组
从机器组列表中选择目标机器组，将其与当前日志主题进行关联，值得注意的是，关联的机器组与日志主题所在的地域需保持一致。了解 [如何创建机器组>>](/document/product/614/17412)

### 5. JSON 模式选择
**键值提取模式** 下拉选择 **JSON**。

### 6. 采集时间配置
- 日志时间单位为：秒。
- 日志的时间属性有两种方式来定义：采集时间和原始时间戳。
- 采集时间：日志的时间属性由日志服务 CLS 采集该条日志的时间决定。
- 原始时间戳：日志的时间属性由原始日志中时间戳决定。

#### 6.1 采集时间作为日志的时间属性
保持采集时间状态为开启状态即可，如图：
![](https://main.qcloudimg.com/raw/d914adee3d01da92f0fa0aed6e6ca782.png)


#### 6.2 日志的原始时间戳作为日志时间属性
如关闭采集时间状态，需要填写原始时间戳的时间键以及对应的时间解析格式，转换格式支持 strftime 的所有函数。
![](https://main.qcloudimg.com/raw/9eaf345586b1970e919c846f5080705d.png)

这里举例说明 **时间格式解析** 填写规则：
例 1：日志样例原始时间戳：`10/Dec/2017:08:00:00`，解析格式为：`%d/%b/%Y:%H:%M:%S`

例 2：日志样例原始时间戳：`2017-12-10 08:00:00`，解析格式为：`%Y-%m-%d %H:%M:%S`

例 3：日志样例原始时间戳：`12/10/2017, 08:00:00`，解析格式为：`%m/%d/%Y, %H:%M:%S`

> **注：**
>
> 日志时间支持以秒为单位，若时间格式填写错误日志时间将以采集时间为准。

### 7. 使用过滤器
过滤器旨在您根据业务需要添加日志采集过滤规则，帮助您方便筛选出有价值的日志数据。对于 JSON 格式日志，可以根据解析得到的键值对配置过滤规则，过滤规则为正则表达式。所创建的过滤规则为命中规则，即匹配上正则表达式的日志才会被采集上报。

例如：假设您希望指定 status = 400 或 500 的日志数据被采集。key 处配置 status，过滤规则处配置(400|500) 即可。
![](https://main.qcloudimg.com/raw/eb6477dc340ab78986b74dfcdd7d9053.png)