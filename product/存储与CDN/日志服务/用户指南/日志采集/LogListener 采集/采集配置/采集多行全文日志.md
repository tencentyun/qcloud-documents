## 概述
多行全文日志是指一条完整的日志数据跨占多行（例如 Java 程序日志）。在这种情况下，以换行符 `\n` 为日志的结束标识符就显得有些不合理，为了能让日志系统明确区分开每条日志，采用首行正则的方式进行匹配，当某行日志匹配上预先设置的正则表达式，就认为是一条日志的开头，而下一个行首出现作为该条日志的结束标识符。  

多行全文也会设置一个默认的键值 `__CONTENT__`，但日志数据本身不再进行日志结构化处理，也不会提取日志字段，日志属性的时间项由日志采集的时间决定。

## 采集配置

### 1. 登录控制台
登录 [日志服务控制台](https://console.cloud.tencent.com/cls)，左侧导航栏选择【日志集管理】。

### 2. 开启 LogListener 采集
单击需要开启 LogListener 采集的日志集，在日志主题里单击需要配置的日志主题，在采集配置界面中单击右上角【编辑】按钮，进入到编辑模式，然后开启 **采集状态** 和 **使用 LogListener**。

> **注意：**
> 若使用 LogListener 采集日志，需要更新至 2.1.4 及以上版本。

### 3. 填写采集路径
采集路径处需要填写需要采集的完整路径，而非目录格式（即需要以 / 开头，非 / 结尾，如`/data/log/cls.log`），文件名支持正则，目前暂不支持通配符。**特别提醒，采集路径中仅允许日志文件名称使用正则**。

### 4. 关联机器组
从机器组列表中选择目标机器组，将其与当前日志主题进行关联，值得注意的是，关联的机器组与日志主题所在的区域需保持一致。了解 [如何创建机器组>>](/document/product/614/17412)。

### 5. 多行全文模式选择
**键值提取模式** 下拉选择 **多行全文**。

### 6. 行首正则表达式
根据多行全文日志的首行格式填写首行正则表达式。

### 7. 使用过滤器
过滤器旨在您根据业务需要添加日志采集过滤规则，帮助您方便筛选出有价值的日志数据。针对多行全文模式，会默认被解析成键值为 `__CONTENT__` 的一行完整字符串，因此，在使用过滤器时，只能对整条全文日志填写过滤规则，过滤规则为正则表达式。所创建的过滤规则为命中规则，即匹配上正则表达式的日志才会被采集上报。
