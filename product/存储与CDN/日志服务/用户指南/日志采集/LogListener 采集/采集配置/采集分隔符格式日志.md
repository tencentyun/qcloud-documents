## 概述
分隔符日志是指一条日志数据可以根据指定的分隔符将整条日志进行结构化处理，每条完整的日志以换行符 `\n` 为结束标识符。日志服务在进行分隔符格式日志处理时，您需要为每个分开的字段定义唯一的 key。
例如：您的一条日志原始数据为：
```
10002345987;write;error;topic does not exist
```

当日志解析的分隔符指定为分号时，该条日志会被分割成四个字段，并为这四个字段定义唯一的 key：eventid、action、status、msg。那么，该条日志最终被日志服务结构化为四个键值对：`eventid:10002345987`、`action:write`、`status:error`、`msg:topic does not exist`。


## 采集配置
### 1. 登录控制台
登录 [日志服务控制台](https://console.cloud.tencent.com/cls)，左侧导航栏选择【日志集管理】。

### 2. 开启 LogListener 采集
单击需要开启 LogListener 采集的日志集，在日志主题里单击需要配置的日志主题，在采集配置界面中单击右上角【编辑】按钮，进入编辑模式，然后开启 **采集状态** 和 **使用 LogListener**。

### 3. 填写采集路径
采集路径处需要填写需要采集的完整路径，而非目录格式（即需要以 / 开头，非 / 结尾，如`/data/log/cls.log`），文件名支持正则，目前暂不支持通配符。**特别提醒，采集路径中仅允许日志文件名称使用正则**。

### 4. 关联机器组
从机器组列表中选择目标机器组，将其与当前日志主题进行关联，值得注意的是，关联的机器组与日志主题所在的区域需保持一致。了解 [如何创建机器组>>](/document/product/614/17412)。

### 5. 分隔符模式选择
**键值提取模式** 下拉选择 **分隔符**。

### 6. 确定分隔符
首先需要您选择唯一的分隔符，系统根据确定的分隔符将日志样例进行切分，并展示在抽取结果栏中，您需要为每个字段定义唯一的 key。目前，日志采集支持多种分隔符，常见的分隔符有：空格、制表符、逗号、分号、竖线，若您的日志数据所采用的分隔符是其他符号，例如双竖线`||`，也可以通过自定义分词符进行解析。
![](https://main.qcloudimg.com/raw/ed19bf882878819d5dd59857a95e284e.png)

### 7. 采集时间配置
- 日志时间单位为：秒。
- 日志的时间属性有两种方式来定义：采集时间和原始时间戳。
- 采集时间：日志的时间属性由日志服务 CLS 采集该条日志的时间决定。
- 原始时间戳：日志的时间属性由原始日志中时间戳决定。


#### 7.1 采集时间作为日志的时间属性
保持采集时间状态为开启状态即可，如图：
![](https://main.qcloudimg.com/raw/d914adee3d01da92f0fa0aed6e6ca782.png)

#### 7.2 日志的原始时间戳作为日志时间属性
关闭采集时间状态，填写原始时间戳的时间键以及对应的时间解析格式，转换格式支持 strftime 的所有函数。
![](https://main.qcloudimg.com/raw/9eaf345586b1970e919c846f5080705d.png)

这里举例说明 **时间格式解析** 填写规则：
例 1：日志样例原始时间戳：`10/Dec/2017:08:00:00`，解析格式为：`%d/%b/%Y:%H:%M:%S`  

例 2：日志样例原始时间戳：`2017-12-10 08:00:00`，解析格式为：`%Y-%m-%d %H:%M:%S`  

例 3：日志样例原始时间戳：`12/10/2017, 08:00:00`，解析格式为：`%m/%d/%Y, %H:%M:%S`  

> **注：**
> 日志时间支持以秒为单位，若时间格式填写错误日志时间将以采集时间为准。


### 8. 使用过滤器
过滤器旨在您根据业务需要添加日志采集过滤规则，帮助您方便筛选出有价值的日志数据。对于分隔符格式日志，可以根据解析获得的键值对配置过滤规则，过滤规则为正则表达式。所创建的过滤规则为命中规则，即匹配上正则表达式的日志才会被采集上报。

例如：假设您希望指定 errorcode = 400 或 500 的日志数据被采集。key 处配置 errorcode，过滤规则处配置(400|500) 即可。
