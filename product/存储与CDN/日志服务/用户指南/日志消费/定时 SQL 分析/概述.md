
>! 本功能于2022年8月15日在北京、上海、广州地域公测。公测阶段免费。
>

## 简介

定时 SQL 分析，可以简单理解为 crontab sql，用户配置调度策略、系统按照既定调度策略，定时去源日志主题执行 SQL 查询，并将查询结果保存到用户指定的目标日志主题。 

![](https://qcloudimg.tencent-cloud.cn/raw/36a9fc18fe303535d62a7d5600735839.png)

## 使用前提

- 已开通日志服务，并开启键值索引。
- 确保当前操作账号拥有配置定时 SQL 分析的权限，详情请参见 [自定义权限策略示例](https://cloud.tencent.com/document/product/614/68374#.E5.AE.9A.E6.97.B6-sql-.E5.88.86.E6.9E.90.E7.9B.B8.E5.85.B3)。


## 使用场景

- 数据量较大的查询，可以使用定时 SQL 分析，将其拆解为多个小数据量的查询，避免查询失败、查询超时的情况。
例如，原始 SQL 查询的数据是一天，可以拆成24个 SQL 查询，每1小时执行 SQL 查询一次。
- 生成日报表、周报表。
- 对日志进行聚合，可以省去大量的索引存储和日志存储费。
例如，将1分钟的历史日志聚合成1小时的日志来保存，可以有效节约成本。
- 过滤数据，保存到新的日志主题。定时 SQL 分析可以通过 where，when 语句满足部分简单过滤场景，但由于 SQL 查询返回结果 limit 10000，导致数据完整性无法保证，且不是实时的流计算。因此，只能适用于数据量小且不是实时计算的客户。如您属于这种场景，推荐使用数据加工。

## 使用限制

- SQL 查询结果最多10000条，多出的会被截断。
- 不支持跨地域，源日志主题和目标日志主题必须在同一个地域。
