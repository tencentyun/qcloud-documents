## 概述
LogListener 是腾讯云日志服务提供的日志采集 Agent，您可以在您的服务器上安装 LogListener 实时采集指定路径上的日志，并对日志原始数据进行结构化。

## 配置步骤
通过 LogListener 采集日志分为以下三个步骤：

第一步：在机器上安装 Loglistener；

第二步：在腾讯云日志服务控制台上创建机器组；

第三步：在日志主题处关联机器组并完成相关配置。

具体步骤参考如下：

### 1. 安装 LogListener
在需要采集日志的服务器上安装并启动 LogListener，并配置对应的账号与地区信息。您的日志服务器可以是腾讯云 CVM，也可以是非腾讯云的外部服务器。

相关参考：[Loglistener 使用指南](https://cloud.tencent.com/document/product/614/11257)

### 2. 创建机器组
腾讯云日志服务通过机器组的方式管理您使用 LogListener 采集日志的服务器。您选择日志服务所在的区域，创建机器组，一个机器组可以通过配置多个 IP 以指定一组服务器。配置完成后，若您在机器组中查看该机器的状态为正常，则说明您的服务器可以与腾讯云日志服务正常通信。即可进入下一步；

> **注意：**
> 目前仅支持 Linux 服务器；填写内网 IP，暂不支持填写网段。

![](https://main.qcloudimg.com/raw/0bdaf92739e295459c991355ec199d26.png)

### 3. 关联和配置机器组
在日志主题下创建采集配置：在安装好 LogListener 并在机器组中配置完成后，需要您选择日志集日志主题中创建相关 LogListener 的采集配置。将该日志主题 **关联机器组、指定该机器上需要采集的路径、配置日志数据的结构化方式等**。完成配置后，日志服务即可以实时采集机器组中服务器上的日志。
![](https://main.qcloudimg.com/raw/f16ea0195fec04d1a543c62ec5398b9b.png)

#### 配置项说明
- 关联的机器组：关联的机器组与日志主题所在的区域需一致。
- **配置采集路径**：采集路径处填写需要采集的完整路径，非目录，即需要以 / 开头，非 / 结尾，如`/data/log/2017.log`，**文件名支持正则，不支持通配符**。采集路径中除文件名以外的其他部分不支持正则与通配符。

![](https://main.qcloudimg.com/raw/1cdabc8fefc893af3c39f92ac5c05965.png)
- **键值提取方式：**指定原始日志数据的日志结构化的方式，例如按 JSON 格式提取、按分隔符方式提取或者不对日志进行结构化提取。

- **配置采集时间（非必选）：**在指定日志结构化方式后，您可以指定某个 key 作为日志数据的时间，并配置时间的转换格式，**转换格式支持 strftime 的所有函数**，例如 `%Y-%m-%d %H-%M:%S`。日志数据时间 **以秒为单位**。若您不指定某个 key 作为日志数据，或者时间格式填写错误，默认我们将按照 **采集时间** 定义您的日志数据时间。

- **配置过滤器（非必选）：**若您需要对日志数据进行过滤后采集，您可以使用过滤器配置。过滤器允许您指定特定 key，并配置过滤规则，过滤规则为正则表达式，匹配上该正则表达式的日志将被采集。

## 网络支持
- 内网：如果您的服务器为腾讯云 CVM，且所在地域与日志服务中日志集的所在地域一致，则日志数据的采集将使用内网通信，即不会在 CVM 上产生流量费用。因此，建议您选择使用与业务同地域的日志服务。

- 外网：若您的服务为外部服务器，或您的 CVM 服务器与日志主题不处在同一地域，则会使用外网通信，将在您的服务器上产生外网流量。
