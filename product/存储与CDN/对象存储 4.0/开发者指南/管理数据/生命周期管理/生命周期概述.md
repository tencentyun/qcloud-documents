对象存储 COS 支持基于对象的生命周期配置，其通过对存储桶下发指定的描述语言，可以让符合规则的对象在指定的条件下自动执行一些操作。

>?生命周期的设置支持最长天数为3650天。

## 适用场景

### 日志记录

如果用户使用对象存储来存储日志数据，可以通过生命周期配置，使得日志数据在30天后自动归档，或者2年后自动删除。

### 冷热分层

热数据往往在上传后，短时间内被大量访问而热度升高，一段时间后热度逐渐降低或者不再需要被实时访问。您可以通过生命周期规则将30天前的数据转换为低频存储，进一步可以将60天前的数据转换为归档存储，这个过程称之为数据沉降。

### 存档管理

使用对象存储进行文件存档管理时，往往根据金融、医疗等合规性要求，需要长期保存文件的所有历史版本，此时可以使用生命周期功能，对历史版本的文件执行沉降至归档的操作。

## 支持说明

### 支持的操作

- 沉降数据：将创建的对象在指定时间后沉降为低频存储类型或者归档存储类型。
- 过期删除：设置对象的过期时间，使对象到期后被自动删除。

### 支持的资源

- 按前缀区分：匹配前缀规则的对象都会按照规则执行处理。
- 按版本管理：非当前版本的对象将会按照规则执行处理。
- 按删除标记：对象历史版本都清除时，可以指定移除删除标记。
- 按未完成分块上传：对未完成的分块上传任务执行处理。

### 支持的时间条件

- 按天计算：指明规则对应的动作，在对象最后被修改的日期过后多少天操作。
- 按日期计算：指明规则对应的动作在指定的日期执行操作。

## 注意事项

### 沉降数据

#### 支持地域

支持公有云地域，不支持在金融云地域将数据沉降至归档存储类型。

#### 单向原则

沉降数据是单向的，只允许从标准存储 → 低频存储 → 归档存储，也支持跳级沉降（例如标准存储 → 归档存储），不支持逆向。您只能通过调用 [PUT Object - Copy](https://cloud.tencent.com/document/product/436/10881)（针对非归档存储类型），或 [POST Object restore ](https://cloud.tencent.com/document/product/436/12633)（仅适用于归档存储类型）来将较冷存储类型的数据恢复至较热存储类型。

#### 最终一致性

如果对同一组的对象配置了多条规则，且存在冲突性情况（不含过期删除配置），对象存储会优先执行沉降至最冷存储类型的规则。例如对同一组对象配置了**沉降到低频存储**和**沉降到归档存储**的规则，则优先执行**沉降到归档存储**的规则。
>!腾讯云 COS 强烈提醒您不要针对同一组对象配置多个含冲突条件的生命周期规则，冲突执行可能导致不同的费用表现。

### 过期删除

#### 处理逻辑

当对象匹配了指定的生命周期过期删除的规则时，腾讯云会将对象加入异步的删除队列，实际发生的删除时间将会与创建时间有一定的延时。您将可以通过 GET 或 HEAD Object 操作来获取对象的当前状态。

#### 最终一致性
如果对同一组的对象配置了多条规则，且存在冲突性情况，对象存储会以最短过期时间为准执行，且**过期删除的执行效力大于转换存储类型**。

>!腾讯云 COS 强烈提醒您不要针对同一组对象配置多个含冲突条件的生命周期规则，冲突执行可能导致不同的费用表现。

### 成本注意

#### 执行说明

对于以任何时间下发的配置，腾讯云 COS 都将以北京时间 （GMT+8）次日的0时为准开始执行操作，由于是异步队列执行，因此对于设置后上传的对象匹配规则的，通常最晚于次日的24时前完成操作。

生命周期执行效力不包含意外情况或存储桶中包含大量存量对象的情况，若因为其他情况没有完成，您将可以通过 GET 或 HEAD Object 操作来获取对象的当前状态。

目前腾讯云对于生命周期的执行效力不提供账单承诺，即对象的计费将会在生命周期执行完成时发生改变。

#### 时间不敏感

请注意低频存储类型需存储至少30天、归档存储类型需存储至少90天，执行数据沉降或删除时不会产生额外的存储费用。 腾讯云 COS 不会检查少于30/90天的生命周期配置，因此对于正确的配置都将按照您的要求执行。

例如，一个低频存储的对象在未存满30天时被执行沉降，将导致对象在当天产生归档存储类型费用的同时，低频存储类型仍将计费至第30天止。

例如，一个归档存储对象在未存满90天时被执行过期删除，将导致对象持续以归档存储类型计费至第90天止。

#### 不受大小限制

在低频存储、归档存储类型分别制定了对象最小占用空间限制。例如，在低频存储中上传小于64KB的文件，将按照64KB计算。腾讯云 COS 不会检查文件的大小，将无条件按照指定的规则，执行对象的转换操作。 
