## 简介

启用存储桶复制功能后，您可以将源存储桶中的**增量对象**进行自动、异步地复制到另一地域的目标存储桶中。您对源存储桶中的对象进行管理操作时（例如新增对象、删除对象），对象存储（Cloud Object Storage，COS）将自动将这些操作复制到目标存储桶中。您可以根据实际需要，选择启用或关闭存储桶复制，更多信息请参见 [存储桶复制概述](https://cloud.tencent.com/document/product/436/19237)。

## 前提条件

开启存储桶复制功能前，请先确保源存储桶和目标存储桶均已 [开启版本控制](https://cloud.tencent.com/document/product/436/19881) 功能。

## 操作步骤

### 启用存储桶复制

1. 登录 [对象存储控制台](https://console.cloud.tencent.com/cos5)。
2. 在左侧导航栏，单击**存储桶列表**。
3. 单击需要配置存储桶复制的源存储桶，进入存储桶详情页面。
4. 单击左侧的**容错容灾管理 > 存储桶复制**。
5. 在**存储桶复制**配置项中，单击**新增规则**。
6. 在弹出的窗口中，配置存储桶复制规则，单击**确定**。
>? 如果源存储桶和目标存储桶均未开启版本控制功能，请先开启版本控制功能后，再配置存储桶复制规则。
>
![](https://qcloudimg.tencent-cloud.cn/raw/a72584fa58844d027edbd62dec63e639.png)
配置项说明如下：
<table>
	<tr><th style="width: 18%">配置项</th><th>配置说明</th></tr>
	<tr><td>源地域</td><td>您的源存储桶所属地域。</td></tr>
	<tr><td>应用范围</td><td>指需要复制的源存储桶中的对象范围，如不设置则默认复制存储桶中的所有对象，假如指定前缀则复制具有特定前缀的内容（例如复制具有`logs/`前缀的文件 ，则填`logs/`）。</td></tr>
	<tr><td>资源路径</td><td>您的源存储桶路径。</td></tr>
	<tr><td>目标存储桶</td><td>指对象被复制后所存放的存储桶，可选择与源存储桶同地域或不同地域的存储桶，同个目标地域不允许设置不同目标存储桶，不支持选择非当前账号的存储桶。</td></tr>
	<tr><td>目标存储类型</td><td>指对象被复制到目标存储桶后的存储类型，默认跟随源存储桶中的对象类型，您可选择其他存储类型以改变目标存储桶中被复制对象的类型。</td></tr>
	<tr><td>同步删除标记</td><td>开启版本控制的情况下，不指定版本 ID 删除文件会在源存储桶新增一项删除标记。如果选择同步删除标记， 则存储桶复制会将该标记复制到目标存储桶 ；选择不同步，则目标存储桶不会新增删除标记。两种情况下，目标存储桶均不会删除对应文件，用户可通过指定版本 ID 访问对象历史版本。关于版本控制和删除标记的详细信息可参见 <a href="https://cloud.tencent.com/document/product/436/19883">版本控制概述</a> 文档。</td></tr>
</table>
>!
> - 当您完成配置规则后，可对规则进行管理操作。您可单击按钮启用或禁用当前规则，单击编辑按钮可修改当前规则。
> - 如果您在首次设置存储桶复制规则中将应用范围设置为复制存储桶内的所有内容，那么您将无法新增任何规则。您可以通过编辑当前规则，或删除当前规则后重新添加的方式进行修改。
> - 如果您在首次设置存储桶复制规则中将应用范围设置为某项前缀的内容，那么您仍然可以通过编辑当前规则，将应用范围修改为存储桶内的全部内容。
> 

### 关闭存储桶复制

您可通过两种方式关闭存储桶复制功能：通过关闭状态按钮和删除规则。

- **通过关闭状态按钮**：通过关闭某个规则中的状态按钮暂时禁用当前规则，这一操作将暂停当前存储桶复制功能，已复制数据将被保留在目标存储桶中，源存储桶中的增量数据将不再复制到目标存储桶，如需再次使用，单击开启按钮即可。
- **删除规则**：在**存储桶复制**管理项里删除已添加的规则，删除规则后已配置的存储桶复制规则将失效，已复制数据将被保留在目标存储桶中，源存储桶中的增量数据将不再进行存储桶复制操作，如需再次使用，您需要重新添加规则。
![](https://qcloudimg.tencent-cloud.cn/raw/4792687ae4102e2d9d4e9bdb271ea79e.png)

>!
> - 尚未完成的存储桶复制操作，将在关闭存储桶复制时中止，并将无法继续执行。
> - 对存储桶再次启用存储桶复制时，仅对开启完成后新增的对象执行存储桶复制操作。
> 


### 创建存量迁移任务

您可以基于存储桶复制规则，创建存量迁移任务。该任务将通过批量处理功能来实现，单击**创建任务**会跳转到批量处理的创建任务页面。创建任务的前两步信息将被默认填写，您只需填写其他配置和确认任务即可。

1. 在**存储桶复制**的规则列表，选择您想要创建存量迁移任务的规则，单击存量迁移任务列的**创建任务**。
2. 在跳转页面中，按流程配置任务即可，更多配置项说明，请参见 [批量处理](https://cloud.tencent.com/document/product/436/38605)。
![](https://qcloudimg.tencent-cloud.cn/raw/4792687ae4102e2d9d4e9bdb271ea79e.png)

