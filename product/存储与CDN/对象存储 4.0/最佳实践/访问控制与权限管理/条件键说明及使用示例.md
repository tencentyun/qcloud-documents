<span id="tls-version"></span>
### 只允许使用指定版本的 TLS 协议（cos:tls-version）

#### 条件键 cos:tls-version

您可以通过条件键`cos:tls-version`限制 HTTPS 请求的 TLS 版本，该条件键为 Numric 类型，支持输入浮点数，例如 1.0、1.1、1.2 等。


#### 示例1：仅对 TLS 协议版本为1.2的 HTTPS 请求进行授权


|请求场景   |预期|
|---|---|
|HTTPS 请求，TLS 版本为1.0|403，失败|
|HTTPS 请求，TLS 版本为1.2|200，成功|

策略示例如下：

```
{
    "version":"2.0",
    "Statement":[
        {
            "Principal":{
                "qcs":[
                    "qcs::cam::uin/100000000001:uin/100000000002"
                ]
            },
            "Effect":"allow",
            "Action":[
                "*"
            ],
            "Resource":[
                "qcs::cos:ap-guangzhou:uid/1250000000:examplebucket-1250000000/*"
            ],
            "Condition":{
                "numeric_equal":{
                    "cos:tls-version":1.2
                }
            }
        }
    ]
}
```


#### 示例2：拒绝 TLS 协议版本小于1.2的 HTTPS 请求

|请求场景  |  预期   |
|---|---|
|HTTPS 请求，TLS 版本为1.0|    403，失败   |
|HTTPS 请求，TLS 版本为1.2|    200，成功   | 


策略示例如下：


```
{
    "version":"2.0",
    "Statement":[
        {
            "Principal":{
                "qcs":[
                    "qcs::cam::uin/100000000001:uin/100000000002"
                ]
            },
            "Effect":"allow",
            "Action":[
                "*"
            ],
            "Resource":[
                "qcs::cos:ap-guangzhou:uid/1250000000:examplebucket-1250000000/*"
            ],
            "Condition":{
                "numeric_greater_than_equal":{
                    "cos:tls-version":1.2
                }
            }
        },
        {
            "Principal":{
                "qcs":[
                    "qcs::cam::uin/100000000001:uin/100000000002"
                ]
            },
            "Effect":"deny",
            "Action":[
                "*"
            ],
            "Resource":[
                "qcs::cos:ap-guangzhou:uid/1250000000:examplebucket-1250000000/*"
            ],
            "Condition":{
                "numeric_less_than_if_exist":{
                    "cos:tls-version":1.2
                }
            }
        }
    ]
}
```


<span id="request_tag"></span>
### 创建存储桶时强制设置指定存储桶标签（qcs:request_tag）

#### 条件键 qcs:request_tag

您可以通过条件键`qcs:request_tag` 限制用户发起请求 PutBucket、PutBucketTagging 必须携带指定的存储桶标签。

#### 示例：限制用户创建存储桶时必须携带指定的存储桶标签

许多用户会通过存储桶标签管理存储桶，下面的策略示例为：限制用户只有在创建存储桶时，必须设置指定的存储桶标签`<a,b>`和`<c,d>`，才能获得授权。

存储桶标签可以设置多个，条件键中的存储桶标签数量和请求携带的存储桶标签数量都可能是一个集合。假设用户携带的多个参数值为集合 A，条件规定的多个参数值为集合 B。在使用该条件键，可以通过限定词 for_any_value、for_all_value 的不同组合表示不同的含义。
- `for_any_value:string_equal`表示 A 和 B 存在交集时生效。
- `for_all_value:string_equal`表示 A 是 B 的子集时生效。

当使用`for_any_value:string_equal`时，对应的策略和请求表现如下：

|请求场景     |预期|
|---|---|
|PutBucket，请求头部`x-cos-tagging: a=b&c=d`|200，成功|
|PutBucket，请求头部`x-cos-tagging: a=b`|200，成功|
|PutBucket，请求头部`x-cos-tagging: a=b&c=d&e=f`|200，成功|

策略示例如下：

```
{
    "version": "2.0",
    "Statement": [
        {
            "Principal": {
                "qcs": [
                    "qcs::cam::uin/100000000001:uin/100000000002"
                ]
            },
            "Effect": "allow",
            "Action": [
                "name/cos:PutBucket"
            ],
            "Resource": "*",
            "Condition": {
                "for_any_value:string_equal": {
                    "qcs:request_tag": [
                        "a&b",
                        "c&d"
                    ]
                }
            }
        }
    ]
}
```


当使用`for_all_value:string_equal`时，对应的策略和请求表现如下：



|请求场景   |预期|
|---|---|
|PutBucket，请求头部`x-cos-tagging: a=b&c=d`|200，成功|
|PutBucket，请求头部`x-cos-tagging: a=b`|200，成功|
|PutBucket，请求头部`x-cos-tagging: a=b&c=d&e=f`|403，失败|


策略示例如下：

```
{
    "version": "2.0",
    "Statement": [
        {
            "Principal": {
                "qcs": [
                    "qcs::cam::uin/100000000001:uin/100000000002"
                ]
            },
            "Effect": "allow",
            "Action": [
                "name/cos:PutBucket"
            ],
            "Resource": "*",
            "Condition": {
                "for_all_value:string_equal": {
                    "qcs:request_tag": [
                        "a&b",
                        "c&d"
                    ]
                }
            }
        }
    ]
}
```
