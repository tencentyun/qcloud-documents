小程序·云直播方案现已集成到腾讯云直播服务中，除了支持云直播控制台进行自助购买和添加小程序域名外，也可以使用录制、转码、回调模板等功能。同时，小程序·云直播方案也支持丰富的直播 API 接口，自助管理小程序域名。

新方案为用户提供了更加全面、便捷的功能和服务，内测期间提供的旧版方案将逐步下线，不再上线新功能。内测期间已购买小程序云直播服务的客户若想使用新功能，可通过以下步骤免费升级新方案，新方案的产品定价详见 [购买指南](https://cloud.tencent.com/document/product/1078/34643)。

## 新旧方案切换步骤
### 步骤1：添加小程序直播插件
 
1. 登录之前已购买服务的腾讯云账号。
2. 在 **云直播控制台** > **资源包/插件管理** > **[插件管理](https://console.cloud.tencent.com/live/resources/plugin?type=plugin)** 中，单击 **新增小程序直播插件**，填写需要绑定的微信小程序信息后提交。
![](https://main.qcloudimg.com/raw/51be22b3597f01e8c79a729a1f83ea88.png)
3. 联系您的商务经理，说明需要升级新方案，联系后台处理。
4. 后台审核通过后，插件状态将为 **可用**，有效期为购买日起到1年的剩余有效期，可通过控制台自助续费。
5. 若有新小程序需要接入，可参考 [小程序·云直播插件](https://cloud.tencent.com/document/product/1078/42916) 进行接入操作。

### 步骤2：添加小程序直播域名

1. 插件状态变为 **可用** 后，在 **云直播控制台** > **[域名管理](https://console.cloud.tencent.com/live/livestat)** 中，单击 **添加域名**，即可添加小程序直播域名。
![](https://main.qcloudimg.com/raw/df7c12b92dcdd6547fb5a54b4f9ac5bf.png)
2. 小程序直播域名根据类型和场景可分为推流域名和播放域名。添加完成后需将自有域名指向 CNAME 域名才能正常使用直播服务。具体操作参见 [CNAME 配置](https://cloud.tencent.com/document/product/267/19908)。
> ?
> - 小程序直播域名默认按照小程序直播流量价格计费，若 App、OBS 推流，或者 App、Web（H5）等平台播放，可直接使用标准直播域名。
> - 为满足测试和正式使用的需要，在添加域名时，支持添加多个域名。具体计费方式可参见 [购买指南](https://cloud.tencent.com/document/product/1078/34643)。

### 步骤3：修改插件代码

1. 在小程序的代码中，将旧方案小程序的域名需要全部换成步骤2中设置的新的小程序直播域名。
2. 在推流和播放组件中，分别增加了“version”参数值（必填），新方案设置值为“2”，设置完成后即完成新方案的切换，可以进行直播功能测试，重新发布小程序。version 参数详情可参见 [使用推流组件](https://cloud.tencent.com/document/product/1078/46456)、[使用播放组件](https://cloud.tencent.com/document/product/1078/34646)。
