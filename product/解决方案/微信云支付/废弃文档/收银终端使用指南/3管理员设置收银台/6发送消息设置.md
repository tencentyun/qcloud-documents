## 用途
发送消息，也就是向与插件配合的收银软件发送相关指令，使得收银软件根据该消息做出响应的响应和动作。向收银软件发送消息的目的是为了减少人工对收银软件的操作，进而提高收银效率。

## 消息类型
- 键盘消息：键盘消息模拟的是键盘按键，按键的组合可以形成响应的快捷键，一般收银软件为零操作方便，都配置了响应的快捷键，通过键盘消息，可以模拟收银软件相应的快捷键。当然，键盘消息也可以模拟键盘输入。
- 鼠标消息：模拟鼠标左键的点击，譬如收银软件的按钮，都可以通过鼠标点击完成。
- 金额回填：支付成功，可以将金额回填会收银软件。
- 订单号回填：支付成功，可以将订单号回填收银软件。

## 设置步骤
![](https://main.qcloudimg.com/raw/e9752611da78f13f9ba1915bc30da88a.jpg)
消息的设置是根据收银软件实际操作需求和步骤来指定的，发送消息存在许多选项，这些选项也是为了方便制定操作而设置的。
- 【扫码和快捷键使用相同的消息】：插件模式下拉起支付窗口存在通过快捷键和扫码两种方式，为了使这两种方式可以各自定义不同的快捷键，设置了扫码和快捷键是否相同选项。
- 【使用相同的快捷键消息】：支付平台包括微信支付、支付宝、现金、银行卡、会员卡，当选择不同时可以给每种支付类型设定不同的快捷键组合，如果这些支付方式支付完成之后收银软件操作没有什么区分，可以设置相同。
- 【发送键盘消息间屏蔽用户输入】：为了防止用户发送消息期间的误操作，设置了该选项，这样用户的输入再发送快捷键期间无效。

### 设置示例
下边以一个例子看下该如何具体设置，我们以一款收银软件为例
![](https://main.qcloudimg.com/raw/15bb3dd7fefbe782d913f08e8bceb83b.jpg)
1. 在【条码/拼音码/品名】输入商品，鼠标单击【收款】栏或按空格键进入结算页面，
2. 然后选择支付方式，然后录入金额，然后点击确定完成收款。![](https://main.qcloudimg.com/raw/dfd7a30267f5a3d7c5005a9fd38a2fda.jpg)
>?当存在支付插件，可能会在录入商品之后或者进入结算页面之后通过扫码或者快捷键方式切换到支付插件，获取金额然后支付成功，然后收银人员再完成收银软件以后的收银步骤。当使用了“发送消息”功能，便可以借助这些消息，帮助收银人员完成收银。

在使用云支付收银台发送消息模拟这些步骤的时候，我们通过图像获取金额 
然后设置空格键盘消息，金盘消息只需要在键盘消息框中按下相应的键盘按键“空格键”，如果收银软件的收银入账是组合快捷键，则需要在键盘上按下组合快捷键，如ctrl+c。当然这一步也可以设置鼠标点击消息，商户要根据实际情况选择。

进入收款界面，设置支付方式选择为鼠标消息，鼠标消息需要标定点击区域，一般标定在按钮中央，圈定合适大小的方形即可。

设置金额回填，金额回填也需要标定范围，标定回填位置是为了通过鼠标点击和清除操作让回填位置获取焦点和清除原先的金额，然后模拟键盘输入消息。这个位置的选取相当重要，选择不当影响的回填金额的正确性，金额输入框由于存在各种设置的规则，应该根据金额输入框的规则合适选取。
如下面的金额回填，默认进入收款会选中回填金额，金额可以删除，输入框范围比较大，这里就可以圈定黑色区域。

 

设定鼠标消息“确定”收银。

设置好之后的快捷键，如下

设置完成之后结合云支付收银台进行收银测试，如果那一步出现问题，根据实际情况修改。没有问题的话，就可以帮助收银人员完成自动化收银了
以上只是演示示例，具体根据实际收银软件操作步骤，完成收银操作。
## 常见问题
设置完之后一定要多测试，由于收银软件本身的特点，设置完之后一定要测试是否每个步骤都能成功。
由于电脑的差异性，每个操作步骤的反应时间不用，在设置的时候需要设置合适的消息时间间隔，如果不知道该如何设置就设置长一些

金额选取一定要根据金额框实际的规则结合发送金额回填的原理进行选择。
如上边的金额选取

在实际操作中可能无法删除原来的金额，造成回填金额不正确，可能入错帐或者不能完成以后的操作。
观察金额回填框的特点，可以同步“退格（BackSpace）”键删除里面的内容，估计最大收银金额，我们可以在金额回填之前，设定一个鼠标消息+多个“退格”退格消息，然后在金额回填，就可以保证回填的正确性。鼠标消息还是金额回填原来的位置，设定设定5~7个退格消息。设定后如下图：
