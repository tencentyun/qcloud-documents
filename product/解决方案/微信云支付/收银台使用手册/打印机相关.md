## 打印机设置
使用云支付收银台打印相关小票单据时，需要设置打印机。在【设置】>【打印机设置】中选择“启用小票打印”开启打印机。
![](https://main.qcloudimg.com/raw/f880e02f96e2d2d6efc1857fa6379057.png)
 
### 如何判断打印机类型
当前市面上小票机主要是串口、并口、usb 口和网口的打印机，打印机类型如下：
串口
![](https://main.qcloudimg.com/raw/f9338e0093c40de1179601078f1393c0.png)
并口
![](https://main.qcloudimg.com/raw/23ebb32a7bad0d8c3ca4bad4467fe3c7.jpg)
usb 口
![](https://main.qcloudimg.com/raw/aeecf171c2328f85eaab067cdf373f38.png)
网口
![](https://main.qcloudimg.com/raw/3dd13222aed0cf11df7a1f17fbce09d4.jpg)
1. usb 口一定为驱动打印机。串口、并口以及网口打印机可能为驱动打印机。判断是否为驱动打印机，可在控制面板打印机列表中根据自己的打印机型号找到相应打印机。如下 58MBIII 打印机和 GB-80160 打印机为小票打印机。用户可咨询打印机厂商确定是否为驱动打印机。
![](https://main.qcloudimg.com/raw/b128ff7966b1bcf7b793bce864e33488.png)
2. 由于云支付收银台是和其他收银软件配合使用的，可以通过收银软件的配置确定打印机类型，配置一般在收银软件中能够找到，具体收银软件具体查找配置，如某收银软件的打印机配置为 LPT1，说明打印机为并口打印机。
![](https://main.qcloudimg.com/raw/e82eef8f682d54acecc5c592631c38f5.png)

### 驱动打印机配置
只要确定了是驱动打印机，无论打印机的端口什么，都要选中 usb 打印机，让后在 usb 打印机中选择相应的输出小票机，这里选的是 58MBIII。
![](https://main.qcloudimg.com/raw/5420bd7ddca86e763ddc59453cb7d2e2.png)

### 非驱动打印机的配置
1. 并口打印机配置
当选择了并口打印机类型时，会看到“并口打印机设置”部分。请从下拉列表中选择要使用的并口打印机。
![](https://main.qcloudimg.com/raw/dffe8d84524768124a0a63395d1eacc9.png)
如不确定是哪个打印机，可以选中后，按1.6测试打印 部分的指示进行测试打印，确认是否设置正确。
2. 打印机参数的获取
对于串口和网口打印机一般配有默认参数，但是默认参数未必准确，在这种情况下，有两种方式可以获取。
 - 打印自检页，首选关闭打印机电源，按住进纸键不松，打开打印机电源，仍然长按进纸键不放，大约5 - 6秒松开，这时候就会打印出来自检也，网口打印机应该包括 IP 地址端口，串口打印机应该包括串口参数。
![](https://main.qcloudimg.com/raw/52efa857d44833adadb30c6cd532279a.png)![](https://main.qcloudimg.com/raw/6ea52a8e9f869012a08f0dcfb0015549.jpg)
如图所示，两张自检页网口打印机自检页 IP 地址为192.168.123.100，网口端口默认为9100，这个软件中不许要修改。第二长为串口打印机的自检页，波特率：19200，奇偶校验为“否”，数据位为8位，停止位为1。
 - 如果第一种方法不行，请登录打印机网站查询相关参数或者咨询打印机厂家。
 - 默认参数绝大多数可以使用，可以测试看下能不能打印。
3. 串口打印机配置
打印机类型选择“串口打印机”后，会看到此节的设置项目，如下图所示。
![](https://main.qcloudimg.com/raw/332d688886404713cdf01331f8adbeb4.png)
根据获取的打印机参数配置自己的串口打印机参数。
串口打印机部分
 - 输出串口， 请从下拉框中选择串口打印机与电脑相连的串口，如何确定串口，如果有收银软件页配置了小票打印，从收银软件中获取，如果没有，看串口有几个，一个一个尝试。
 - 串口波特率，串口的通信波特率。
 - 串口数据位，
![](https://main.qcloudimg.com/raw/3036d28077fd283b91a241a90dc697ae.png)
 - 串口停止位，根据串口的硬件参数，选择正确的停止位。
 - 串口奇偶校验，根据串口的硬件参数，选择是否有校验，或者何种校验。 
 - 串口流控制
 ![](https://main.qcloudimg.com/raw/95d5b1ff5f45e9371c7572b60470ee04.png)
4. 网口打印机配置
当打印机类型选择为“网口打印机”时，可以看到此节选项。网口打印机需要设置打印机的 IP 地址和打印机的端口号，IP 地址从自检页获取，或者咨询打印机厂家，端口默认为9100，您需要修改。
 ![](https://main.qcloudimg.com/raw/4f1fa0c03b12edebeff2db0a87285b50.png)
注意设置串口打印机需要计算机 IP 地址和网络打印机地址位于同一网络地址中，可以查看打印机文档进行设置。

### 代理打印
非驱动打印机，如果只有云支付收银台使用打印机一般是没有什么问题的，但是如果和收银软件共用，可能会存在问题，如串口和并口收银软件一致占用，造成收银台不能打印。这是争抢端口造成的偶尔打印不成功。对于上面的问题退款使用代理打印。如果不知道什么问题也需要尝试代理打印。
1. 首先通过代理软件设置两个虚拟串口，记录创建的串口对，如 com8 - com9。
![](https://main.qcloudimg.com/raw/612ea895c9998f93d5383ed240bf874d.png)
2. 打开收银软件的配置，将原先的收银软件这是端口（一般为 lpt1）改为虚拟串口（如 com8）。
![](https://main.qcloudimg.com/raw/a57730c0c0962f989fa8aa5ecdb9afc3.png)
3. 在云支付收银台上将代理端口设置为另一虚拟串口（例子中的 com9），云支付收银台另外需要选择真实打印机物理端口，这个端口为原先收银软件配置的端口（如 lpt1）。
![](https://main.qcloudimg.com/raw/cc258a4dc959e87ae08e2c4c88dc5b2d.png)
4. 配置完成之后测试，如果仍然不能打印，可尝试在“输出端口处于就绪”中选择“是”。

### 测试打印
为方便用户测试打印配置，云支付收银台提供了测试打印机功能，在打印机设置页面，滚动条拉到最下方，可以看到一个测试打印机按钮，用户选择了打印机后，“测试打印机”按钮会变为可用状态。
 ![](https://main.qcloudimg.com/raw/cd7f9aacabffd3f25c4a8ad22fa8e73d.png)

## 打印其他功能介绍
在软件主界面的【设置】>【打印机设置】选项下，是打印机相关的配置选项，具体如下：
 ![](https://main.qcloudimg.com/raw/93b6d558bc2b9b001d558a7300b0183e.png)
云支付收银台的小票打印功能主要包括以下设置：
- 打印基本设置
- 刷卡支付打印设置
- 一码支付打印设置
- 交接班打印设置

### 打印基本设置
打印基本设置，具体如下：
![](https://main.qcloudimg.com/raw/ebe7938af6e87af9faefc75b197ef316.png)
1. 启用小票打印
打印基本设置部分，是小票机较为通用的相关设置项。要使用小票机，必须在软件中设置启用打印功能。默认情况下，软件没有启用打印功能，“启用小票打印”对应选项默认选中的是“否”，如下图所示，当不使用小票功能时，各相关设置项都会变灰，不可配置。
![](https://main.qcloudimg.com/raw/4889199ae0c34f40980d6e5bb117eb00.png)
将“启用小票打印机”对应的选项选中“是”。各选项才会变为可设置状态。效果如下图所示。
![](https://main.qcloudimg.com/raw/8df3c2694baedb135dfabedf95ee329e.png)
2. 小票头部空白（行数）
打印小票纸张的头部留白，可以通过下拉框选择空白多少行，也可以在右边输入框自行定义行数。自定义行数输入必须是正整数。
![](https://main.qcloudimg.com/raw/1b7e3839f586378e69b43c4edca3726c.png)
3. 小票底部空白（行数）
打印小票纸张的底部留白，可以通过下拉框选择空白多少行，也可以在右边输入框自行定义行数。自定义行数输入必须是正整数。
![](https://main.qcloudimg.com/raw/4c3e827954925f2b112505ce81d8d6ff.png)
4. 小票出票间隔（秒）
控制两张小票出票时间间隔，对于同一支付单打印多张小票比较有用，这样在较大的间隔下有利于收银员撕票。
![](https://main.qcloudimg.com/raw/b657f93cad18acdebe81e1a47a1847df.png)
5. 小票首张延迟
控制首张小票延迟打印。
![](https://main.qcloudimg.com/raw/06762f32d2848aec835ca3c22d58f786.png)
6. 打印支付单份数
用来说明支付单支付成功后打印的小票分份数，默认打印一张。
 ![](https://main.qcloudimg.com/raw/4e7746a8fed8ff80c1a22c8056741089.png)
7. 打印行间距
默认是逐行，不空行打印。如需空行，请在下拉框中选择需要的空行数。
![](https://main.qcloudimg.com/raw/a3a384f193e048388b4010bfe2f73a3d.png)
默认打印效果如下：
![](https://main.qcloudimg.com/raw/7dcefe5d74d1f6cae11975b2b80e31db.jpg)
使用空1行打印的效果：
![](https://main.qcloudimg.com/raw/44d0ed84626a9a1758fa5517062e8efb.jpg)
8. 打印退款单份数
用于设置退款单退款后打印的小票分份数，默认打印一张。
![](https://main.qcloudimg.com/raw/0e4075f056f313debb2690e47d27380c.png)
9. 打印模式
选择发送给打印机的是文字指令还是图片指令。正常情况下用户无需设置此选项，默认使用文字模式即可。部分打印机出现兼容问题，打印的小票乱码，可将此选项勾选为“图片模式”，即可正常打印。
![](https://main.qcloudimg.com/raw/9ddc075722b7cd64d8b208790d19a41b.png)
10. 是否打印条码
该选项控制是否在小票上显示订单号的条形码。
 ![](https://main.qcloudimg.com/raw/ddf00c9d6b91de70b0b3ebd3a196a6f2.png)
11. 打印完成是否开启钱箱
打印小票完成后，是否发送指令打开钱箱，默认不会打开。
![](https://main.qcloudimg.com/raw/e3ec79c7ed60fd9fc58a48aaa4411776.png)
12. 小票金额字体放大倍数
默认情况下，小票的金额字体和其他信息字体是一样大的。如需突出显示小票中的金额字段，可以在此选项下拉框中选择不同的放大倍数。
![](https://main.qcloudimg.com/raw/3f9072ac6558484aa950ccb2b2f666f8.png)
选择2倍时效果如下图所示：
![](https://main.qcloudimg.com/raw/999aa69b9685a1e6552ce7513af6be31.jpg)
13. 打印完成是否切纸
默认是不会自动切纸，对于支持自动切纸的打印机，要使用其自动切纸功能，请在此项设置中勾选为“是”。
![](https://main.qcloudimg.com/raw/563628946f6051dc41d9a6e2d1fe822b.png)

### 刷卡支付打印设置
刷卡支付打印设置，具体如下：
 ![](https://main.qcloudimg.com/raw/285754e02d001c6148b484c2cdb7736b.png)
1. 自动打印订单小票，选择“是”后，支付成功时会自动打印订单小票。
2. 自动打印退款单小票，选择“是”后，退款后，会自动打印退款单小票。
3. 订单打印内容，点击后，下拉框中可以勾选订单小票中要打印哪些字段。
![](https://main.qcloudimg.com/raw/6fca59cb822e9ea705568df46b8ffd5c.png)
4. 退款单打印内容，类似订单打印内容选项，可以选中退款单小票中需要打印哪些字段。
5. 刷卡支付打印时限（秒），通过下拉框选择超过多少秒后，不再打印支付成功的刷卡支付小票。因为刷卡支付成功可能有若干时间的延迟，而打印小票需要服务器返回成功后才开始打印，但超过一定时限，顾客可能已经离开柜台，此时打印旧小票已无意义，故可以设置此项时限，一定时间之前的不再打印。
![](https://main.qcloudimg.com/raw/6d8b68e32c7229efb6146b0fa385a5cd.png)

### 一码支付打印设置
一码支付打印设置，具体如下：
![](https://main.qcloudimg.com/raw/bb979739e1ed80c857985c98dcf92646.png)
区分一码支付和刷卡支付的打印设置，方便用户根据需要针对两种设置打印不同的小票。一码支付打印设置部分功能与刷卡支付基本相同，重叠的功能不再复述。
![](https://main.qcloudimg.com/raw/479a4863837f789a2f74fd28d7f68390.png)
打印开始时间，可以选择从当前开始打印，或者从上一次一码付订单开始打印。
 
### 交接班打印设置
软件默认不打印交接班的统计小票。如需在交接班时打印统计小票，请在此选项中勾选“是”。
 ![](https://main.qcloudimg.com/raw/f34a793fea6eec860f9093b3090512b8.png)

## 常见问题
1. 打印机打印缓慢
A.	如果使用图片模式打印，请切换为文字模式。
B.	如果打印了条码，请将打印条码取消。
2. 打印乱码
A.	当前打印机在大多数情况下能够正常运行，出现乱码尝试切换图片模式或者文字模式。
B.	如果是串口或者并口打印机，请尝试使用代理打印。
C.	尝试重启打印机试下。
3. 串口和并口打印设置出现打印问题
尝试使用代理模式。

