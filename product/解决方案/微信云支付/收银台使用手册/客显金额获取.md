客显获取金额包括驱动获取金额和虚拟串口获取金额，两种方式各有优缺点。
- 驱动客显获取金额设置简单，只需要安装驱动和选择对应客显串口即可。
- 虚拟串口获取，对应没有物理客显的情况，创建一对虚拟串口，一个配置到收银软件一个配置到云支付收银台，即可使用。

>!
>1. 首先需要确认收银软件可以使用，并且可以发送数据，否则无法使用该功能。可使用物理客显进行测试，如果物理客显显示正常，即可使用客显获取，否则无法使用。
>2. 另外，收银软件防备插件越来越严格，可能向客显胡乱发送数据，支付的时候一定要确认支付金额，避免造成资金损失。如果由于操作失误造成的损失，云支付不承担责任。

## 客显驱动抓取金额配置
安装包含客显功能的云支付收银台后，使用管理员帐号登录。验证密钥完成后，切换到【收银设置】。在【使用设置】>【金额识别方式】中选择“客显”，并填写客显串口（即收银软件中，配置的客显串口），就可以看到屏幕左上角出现“客显金额”小窗口。单击【测试】，如果客显小窗口中能够正确获取金额，则表明收银台客显工作正常。此时，操作收银软件中的订单，总金额变化时，小窗口金额会跟着变化。拉起“支付小窗口”时，支付金额就是小窗口对应的金额。
- 客显配置
![](https://main.qcloudimg.com/raw/ce24a7b656791a92cbc480f03b4565a8.png)
- 客显窗口/触屏窗口
![](https://main.qcloudimg.com/raw/14777b0012b53b16bbe05632e92cfe44.png)
 
### 客显驱动获取金额常见问题
#### 客显功能无法使用
1. 首先如果测试客显按钮工作正常，说明收银台客显功能工作正常。
2. 然后确认收银台客显配置串口是否为收银软件配置的客显串口，如果不一致，则修改收银台客显串口为收银软件配置的客显串口，然后重试。
3. 如果客显串口和收银台一致，检查客显设备上是否能够正确显示总金额，如果可以，尝试将【忽略亮灯信号】设置为“是”。
4. 如果还不行，说明收银软件不支持客显功能，收银台客显功能也不能使用，请使用其他的金额识别方式。
![](https://main.qcloudimg.com/raw/22d06a4ba0792c4a0fd3f94c7aa7b417.png)

#### 打开过滤设备失败
 ![](https://main.qcloudimg.com/raw/a8f836fad7072f2e9aa051e951d4b4c4.png)
关闭收银软件，然后以管理员身份打开`C:\Windows\System32\cmd.exe`，按照下图提示进入到云支付安装目录，执行`install_dirver.bat`。
![](https://main.qcloudimg.com/raw/af63841e91d80bd1192c2f47d1e3fcec.png)
![](https://main.qcloudimg.com/raw/224e7bb252a5aa8f792143cd951a2076.png)
正常情况下，会执行成功。然后重启云支付收银台和收银软件，重新测试客显功能即可。

如果出现“拒绝访问”或者“没有权限”错误，请使用电脑管理员登录重试上述步骤即可。
![](https://main.qcloudimg.com/raw/7652fbab2bac025120508bcb5ef6d738.png)
 
#### <span id="jump">机器没有串口的解决方法</span>
安装虚拟串口工具，添加虚拟串口，然后**重启电脑**。先配置收银软件客显串口，再配置云支付收银台客显串口，重试客显功能（虚拟串口推荐：Virtual Serial Port Driver，[单击下载](https://virtual-serial-port-driver.en.softonic.com)）。

## 虚拟串口获取金额
在机器没有串口且按照 [机器没有串口的解决方法](#jump) 中所用的抓取方式操作后，仍然不能正常工作的情况下（如下图），才推荐使用这种方式获取客显金额。
![](https://main.qcloudimg.com/raw/8b19539c3d2b86c565fcfcce85486c2e.png) 
可尝试使用虚拟串口的方式，使用客显抓取金额。具体操作如下：
1. 安装虚拟串口工具（虚拟串口推荐：Virtual Serial Port Driver，[单击下载](https://virtual-serial-port-driver.en.softonic.com)）。
2. 打开虚拟串口工具，然后创建一对虚拟串口（串口名字可以自己选择），如下所示。
![](https://main.qcloudimg.com/raw/eae6b6158844efb7a47efde66b946cb2.png)
![](https://main.qcloudimg.com/raw/0ea41c2c9b8f6fb3a07b1dd709133586.png)
3. 将刚刚创建的虚拟串口，其中一个串口，如 COM7，设置为收银软件的客显串口。
![](https://main.qcloudimg.com/raw/5195b285ee574408ae3e42638a1389ba.png)
4. 然后配置收银台，选择收银配置页面，选择虚拟串口，将创建的一对虚拟串口的另一个串口 COM8，配置为收银软，客显串口配置为客显设备所接的物理串口，此处我的机器为 COM1。
>!客显串口不能填成和之前创建的一对串口一样，如果机器没有物理串口，可再创建一对虚拟串口，新创建串口可任选其一填写。
>
![](https://main.qcloudimg.com/raw/6bd5fc82f4ee77dbfb2e7cc6b0b573e3.png)
5. 此时，如果收银软件能够正确发送客显数据，收银台即可拿到正确客显金额。




