
物联网通信提供了设备在线、消息收发、设备影子、规则引擎和 OTA 的监控能力。您可以在物联网通信控制台 [状态监控](https://console.cloud.tencent.com/iothub/monitor) 页面，查看最多30天内的监控数据，这些数据能帮助您定位和解决业务问题。

## 状态监控类型
目前提供以下五类监控统计数据。

#### 设备在线统计
设备在线统计用于监控设备的在线情况。
![](https://main.qcloudimg.com/raw/30e002e9d58c687484e29d0f11f400f9.png)

#### 设备消息统计
设备消息统计包括消息上下行的消息数，以及分别的失败数和计费数。
![](https://main.qcloudimg.com/raw/267302cdb6955400b387d1591557651b.png)

- 消息上行计数：设备发布或者应用程序通过云 API 发布的消息次数。
- 消息下行计数：物联网通信平台往设备传输的消息（设备订阅的消息）次数。
- 消息上行失败数：设备发布或者应用程序使用云 API 发布的消息中，因格式非法（如超长）、限频、限流量、无权限而发布失败的消息量。
- 消息下行失败数：物联网通信平台往设备传输的消息（设备订阅的消息）中，因格式非法（如超长）、限频、限流量而不能接收到的消息量。
- 消息计费上行数：设备发布或应用程序使用云 API 发布的消息中，每条消息以计费标准折算（消息内容长度除以512字节向上取整）的消息数。
- 消息计费下行数：物联网通信平台往设备传输的消息（设备订阅的消息）中，每条消息以计费标准折算（消息内容长度除以512字节向上取整）的消息数。

#### 设备影子更新统计
设备影子更新统计包括设备主动更新影子的次数和更新失败的次数。
![](https://main.qcloudimg.com/raw/321b82e2feb85e6841a805cea6b82122.png)

#### 规则引擎统计
规则引擎统计包括消息命中规则引擎的次数以及转发到其他服务的次数。
![](https://main.qcloudimg.com/raw/62a28d7b7d90579a2b828e7326f03945.png)

#### 固件统计
固件统计包括设备的版本分布以及固件版本的容量统计。
![](https://main.qcloudimg.com/raw/1592e5d694e8f9725ff58fc15712e344.png)


## 产品级监控
状态监控不仅支持全局监控，也支持产品级监控，您可以搜索产品名找到您想要查看的产品数据。
![](https://main.qcloudimg.com/raw/585dbe33bbf9d2b08c2d3c31bff1ba73.png)
>!指定产品后才可查看固件统计信息。

## 按时间检索
状态监控支持选择时间范围，包括近1天，近7天，近15天，近30天及自定义时间。
![](https://main.qcloudimg.com/raw/3804a7e2d2373f7e2dbea04f8a88b6be.png)

## 按时间粒度统计数据点

状态监控中每个单点的显示按照所选时间粒度进行统计。其中，设备的在线数，单点显示值为所选择时间粒度的峰值。其它类型单点数据为所选择时间粒度统计求和的值。
![](https://main.qcloudimg.com/raw/737225807bc714eef478833d255acbda.png)

## 缩放与合计

监控时序图还支持缩放与合计功能。您可以在时序图上选择一个起始时间，按住并拖动鼠标至结束时间的位置，即可查看这一时间段内的监控数据。
![](https://main.qcloudimg.com/raw/590edc9f8660b19250ddb1a74bff5f89.png)
合计功能会默认合计所展示时间轴的数据类型总数，并展示在各个统计界面的右上方。
![](https://main.qcloudimg.com/raw/7bbef3afaea23f0e5949b7d172c6c648.png)
单击【重置】按钮即可将界面的缩放进行重置。

## 监控告警

状态监控支持云监控触发告警功能，可实现对设备在线数量、消息上下行数、消息上下行失败数等状态进行监控。并对触发告警条件的状态对象以短信、邮箱、微信的方式发送告警消息到目标用户。用户可根据告警消息对设备进行相应的处理。

### 创建告警策略
物联网通信支持对以下状态类型设置告警：
- 设备在线数量。
- 消息上行计数。
- 消息下行计数。
- 消息上行失败数。
- 消息下行失败数。
- 设备影子更新数。
- 设备影子失败数。
- 规则命中数。
- 规则转发数。

#### 操作步骤

1. 登录物联网通信控制台，进入 [状态监控](https://console.cloud.tencent.com/iothub/monitor) 页面，单击页面右上方【告警设置】，进入告警设置页面。
![](https://main.qcloudimg.com/raw/dfa92f9c06d217e84d265d4cf8c7aa9b.png)
2. 在告警策略页面单击【新建】，进入新建策略页面，设置告警策略参数。
![](https://main.qcloudimg.com/raw/e2d82eda21d3f704650469db2e51512a.png)
 - 策略名称：支持中英文字符或下划线。
 - 备注：描述告警策略的信息，支持中英文字符或下划线。
 - 策略类型：策略类型为产品所对应的告警策略类型，此处选择【物联网通信】>【状态监控】。 
 - 所属项目：告警策略的所属项目，此处为默认项。
 - 告警对象：分为全部对象、部分对象和实例组。
    - 全部对象为物联网通信中的所有产品对象，物联网通信中任何产品满足告警规则时，都会发送告警通知。
    - 部分对象为所选中的产品对象，只有被选择的产品对象满足告警规则时才会发送告警通知。
    - 实例组为实例组中所包含的产品对象，只有实例组中的对象满足告警条件时才可以触发告警。
 - 触发条件：可设置触发条件模板和配置触发条件两种方式，详情请参见 [创建告警策略](https://cloud.tencent.com/document/product/248/6215)。可设置的触发条件包括：
		- 可设置满足任意或所有条件时触发。
		- 可按照物联网通信平台支持的状态类型设置监控的类目。
		- 可设置策略的统计周期及持续周期个数。
		- 可设置告警策略的比较关系。
		- 可设置告警阈值。
		- 可设置通知策略。当告警产生时，可定义告警以特定的频率重复通知。可选：不重复、5分钟、10分钟、周期指数递增...等重复频率。周期指数递增的含义是当该告警第1次、第2次、第4次、第8次...第2的 N 次方次被触发时，向您发送告警信息。意义是告警信息发送时长间隔将越来越长，一定程度上避免重复告警对您的骚扰。
		
>?重复告警默认逻辑：
- 告警产生后的24小时内，将按您设定的重复通知频率重复给您发送告警信息。
- 告警产生满24小时，将默认切换为1天通知1次的策略进行重复通知。
- 告警产生满72小时，发送最后一次告警信息，过后不再重复发送此条告警的告警信息。

触发条件示例：设置满足所有条件时触发；监控类目为设备在线数；统计周期为1分钟，持续5个周期；比较关系为大于；告警阈值为100；通知策略为每一天警告一次。每一分钟统计一次设备在线数，当产品对象中的设备在线数连续6次大于100台时会触发报警。
 - 告警渠道：可进行接收对象，接受时段，接受渠道以及接受语言的设置。
 - 高级功能：开启后若达到告警条件可触发弹性伸缩策略
 - 接口回调：若达到告警条件可将告警消息推送至该地址。

3. 单击保存即可成功创建告警策略。




