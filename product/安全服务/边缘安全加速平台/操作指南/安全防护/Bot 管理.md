## 功能简介
基于请求和会话特征、客户端画像情报和智能行为分析，识别并管控机器人客户端（包括代理、爬虫、扫描器、搜索引擎机器人、API 客户端等非浏览器客户端）访问，识别处置恶意高危请求（如恶意扫描、僵尸网络设备、ATO 攻击源、高危代理、暴力破解客户端等），同时降低对低风险爬虫、合法 API 误报和误拦截的概率。


调优 Bot 管理规则，调试优化规则配置时，建议按如下步骤部署策略：
<dx-steps>
-将规则或规则分类的处置方式调整为观察，此时 Bot 管理功能对匹配规则的请求将放行，但是会记录规则匹配日志。
-发起已知为正常（或明确需要拦截）的请求。
-查看 Bot 管理匹配规则日志，对于明确为正常的请求匹配的规则，配置为观察或忽略。对于明确需要拦截的请求，配置人机挑战（JavaScript 挑战或托管挑战）或者拦截。
</dx-steps>


## Bot 基础防护设置
基于请求特征，如 UA、搜索引擎特征、IDC 等分类，对匹配具体特征规则或匹配特征分类的请求进行处置。
>?配置建议：该功能基于静态客户端请求特征识别 BOT 请求，建议根据业务场景配置规则。
>
> - UA 特征规则：覆盖场景较多，识别特定类型客户端，针对性强。建议业务按实际情况启用特定规则，并结合观察处置方式调试优化。
> - 搜索引擎规则：针对搜索引擎使用的 Bot 客户端识别。对于网站等搜索引擎可达的业务场景建议关闭，对于非页面类型站点（如 API 服务等）建议开启。
> - IDC 规则：针对数据中心或特定运营商客户端识别。建议结合业务需要配置指定运营商或 IDC 规则，并结合观察处置方式调试优化。


1. 登录 [边缘安全加速平台控制台](https://console.cloud.tencent.com/edgeone)，在左侧菜单栏中，单击**安全防护** > **Bot 管理**，并选择所需站点和子域名。
![](https://qcloudimg.tencent-cloud.cn/raw/8dbe8717d01d3744bf979840c7c802a9.png)
2. 在 Bot 基础防护设置卡片中，单击**设置**，调整规则配置。
3. 在 Bot 基础防护设置页面上，可以单个或批量设置规则分类。
   - 单个设置规则分类
      1. 所需要配置的规则分类上，单击**详细规则**，对该类别规则进行配置。
           ![](https://qcloudimg.tencent-cloud.cn/raw/d2228e42dea4e77b69fa5a4d4f5e88e6.png)
      2. 选择**规则 ID**，单击**处置方式**下拉框，选择需要配置的处置方式。
  ![](https://qcloudimg.tencent-cloud.cn/raw/55435adb0dbc05371ac0e3c6be8d0040.png)
      3. 单击**应用**，配置生效。
   - 批量设置规则分类
     1.  在 Bot 基础防护设置页面上，单击**批量设置**，选择一个或多个分类规则进行批量设置处置方式。
     2. 在批量设置模式下，逐个单击需要包含的分类卡片，直至所有需要配置的分类卡片都已勾选。
>?在批量设置模式下，可以单击**全选**快速选择全部分类卡片，或者单击**取消全选**快速取消选择全部分类卡片。
>
![](https://qcloudimg.tencent-cloud.cn/raw/a9b55cad3ad8a739d8ace6cbd52f4b36.png)
    3. 单击**处置方式**下拉框，选择需要配置的处置方式。
		 ![](https://qcloudimg.tencent-cloud.cn/raw/c659efc7629986f127c5d58cc8703aba.png)
    3. 单击**应用**，配置生效。
4. 完成全部配置调整后，单击页面底部**确定**，配置生效。



## 自定义规则
当业务与某些规则极度相似，或需要放行/阻止某些特定流量时，可使用本模块进行策略配置。

### 添加规则
1. 登录 [边缘安全加速平台控制台](https://console.cloud.tencent.com/edgeone)，在左侧菜单栏中，单击**安全防护** > **Bot 管理**，并选择所需站点和子域名。
![](https://qcloudimg.tencent-cloud.cn/raw/8dbe8717d01d3744bf979840c7c802a9.png)
2. 在自定义规则卡片中，单击**设置**。
3. 在自定义规则页面，单击**添加规则**，输入规则名称、匹配方式、执行动作和优先级。
![](https://qcloudimg.tencent-cloud.cn/raw/e5f6e6fd9b18597ad2b0d9b9170fd8a5.png)
**参数说明：**
 - 规则名称：由字母、数字和下划线组成，不填写则会自动生成一个规则名称，规则名应当唯一。
 - 匹配方式：包含若干 http/https 协议字段，可以通过包含、等于等方式进行匹配。一个防护规则的每一行匹配条件之间为“并且”关系（最多5条），相同的字段只能配置一次。
 - 执行动作：根据实际需求选择。
 - 优先级：表示该条目的执行顺序。**自定义规则将优先以配置的优先级由大到小顺序执行，当优先级相同时，以修改时间由近到远顺序执行**。
3. 单击**确定**，即可完成添加规则。

### 启用规则
在自定义规则页面，支持单个启用规则或批量启用规则。
  - 单个：选择所需规则 ID，单击策略开关![](https://qcloudimg.tencent-cloud.cn/raw/171fbbf6fe32c80aba5be84541814e23.png)，即可开启对应规则。
![](https://qcloudimg.tencent-cloud.cn/raw/af70c42f583ea452f553f4776b2f754f.png)
  - 批量：勾选所需规则，单击**启用**，即可开启所选规则。
![](https://qcloudimg.tencent-cloud.cn/raw/fd52fe79c71fc6159da9bab135daf0a9.png)

### 禁用规则
在自定义规则页面，支持单个禁用规则或批量禁用规则。
  - 单个：选择所需规则 ID，单击策略开关的![](https://qcloudimg.tencent-cloud.cn/raw/057134e300a8daaed49b0d60348921e3.png)，即可关闭对应规则。
  - 批量：勾选所需规则，单击**禁用**，即可关闭所选规则。
![](https://qcloudimg.tencent-cloud.cn/raw/0af1ee572c066b978de2acaf9e3fd6b0.png)

### 删除规则
1. 在自定义规则页面，选择所需规则，单击操作列的**删除**。
![](https://qcloudimg.tencent-cloud.cn/raw/74d5af835a7ab19c3f54f8219526b49c.png)
2 在删除规则对话框中，单击**删除**，即可删除对应规则。


## 客户端画像
基于近期采集的大量恶意访问数据和情报数据，对客户端 IP 信誉画像分析。可根据恶意客户端置信度配置相应处置方式。
>?客户端画像置信度：对于各个类别的客户端画像规则，每个置信度对应了一个客户端地址列表，置信度反应了该列表内的客户端地址近期进行该类别恶意行为的频率和一致性。
> - 较高置信度：该客户端地址近期稳定、高频率进行该类别的恶意行为。来自该类地址的请求几乎确定为恶意行为，建议拦截。
> - 中等置信度：该客户端地址近期有过显著频率进行该类别的恶意行为。来自该类地址的请求较大概率为恶意行为，偶尔会有误报，建议配置为 JavaScript 挑战 或 托管挑战。
> - 一般置信度：该客户端地址近期有过稳定进行该类别的恶意行为记录。来自该地址的客户端相比其他地址有更大可能性发起恶意行为，但有一定误报可能，建议配置为观察，并通过调优步骤，按需要调整为 JavaScript 挑战或托管挑战。

1. 登录 [边缘安全加速平台控制台](https://console.cloud.tencent.com/edgeone)，在左侧菜单栏中，单击**安全防护** > **Bot 管理**，并选择所需站点和子域名。
![](https://qcloudimg.tencent-cloud.cn/raw/8dbe8717d01d3744bf979840c7c802a9.png)
2. 在客户端画像分析卡片中，单击右侧“开关”，可以快速开启或关闭该功能。
> ?
> - 关闭客户端画像分析功能后，功能内规则不生效，将默认放行请求，也不会记录相关日志。
> - 首次开启客户端画像分析功能时，建议先配置详细规则，再开启规则。以避免未配置的规则影响正常业务访问。
> 
![](https://qcloudimg.tencent-cloud.cn/raw/308f7cd20f2c9fa2e40cef3871dc4e88.png)
2. 在客户端画像分析卡片中，单击**设置**，对模块内规则进行配置。
4. 在客户端画像分析配置页面，在需要调整配置的恶意行为分类框内，单击不同置信度对应的**处置方式**下拉框，选择需要配置的处置方式。
![](https://qcloudimg.tencent-cloud.cn/raw/7927a1f5894ae7580e928fae3b8493c9.png)
5. 完成全部配置后，单击页面底部**确定**，配置生效。
