## 操作场景
本功能适用于站点下函数触发规则的如下操作：  

* 支持站点下函数触发规则的增删改查。  

* 支持快速调整触发规则的优先级，适用于请求URL匹配到多个触发规则的情况下快速调整执行位置的顺序，位置在前的触发规则将会执行，位置在后的触发规则将不会执行。  

## 操作介绍 
登录 [边缘安全加速平台](https://console.cloud.tencent.com/edgeone) 控制台；在左侧导航栏中，单击 **边缘函数** > **触发配置**，  

![image](https://user-images.githubusercontent.com/114125357/198184434-732deb00-5a51-4a71-9391-2b3727755480.png)




### 新建触发规则
<img width="1583" alt="image" src="https://user-images.githubusercontent.com/114125357/198184602-95cccefa-c41e-4b63-855d-f885592c4458.png">


在规则列表页，点击![image](https://user-images.githubusercontent.com/114125357/197450590-fa017062-6502-4441-ad33-685e7cd83613.png)后如下图所示：  
<img width="928" alt="image" src="https://user-images.githubusercontent.com/114125357/198184992-4617ad2e-faaa-4944-9de5-8142d8926c95.png">

**参数说明**  

* 站点：默认显示当前站点名称。  

* 描述：非必填项，最多可支持60个字符。  

* 触发条件：按需选择匹配类型、运算符和值，更多参数使用介绍请参考 [规则引擎](https://cloud.tencent.com/document/product/1552/70901)    

* 执行函数：下拉选择已创建的函数。  

点击**确定**即可完成触发规则的新建。    



### 编辑触发规则
<img width="1585" alt="image" src="https://user-images.githubusercontent.com/114125357/198185123-bcc55f24-5c44-45f9-8076-039cce14f1b0.png">



点击上图中的**编辑**   

<img width="932" alt="image" src="https://user-images.githubusercontent.com/114125357/198185216-8ec3d821-60e3-454f-9bff-79163156e3d8.png">


按需修改内容后通过点击**确定**即可完成触发规则的编辑。  


### 查询触发规则
<img width="1578" alt="image" src="https://user-images.githubusercontent.com/114125357/198185336-0efc8ed3-d888-48d7-9f46-f437602d8aa9.png">


点击![image](https://user-images.githubusercontent.com/114125357/197451335-d6e04756-6a31-4ea9-914d-08ac164ae7a1.png)
后在搜索的输入框中填写规则ID的关键词即可完成查询。  


### 删除触发规则
<img width="1580" alt="image" src="https://user-images.githubusercontent.com/114125357/198185475-53a21cc9-4a0a-4cf4-a197-6ff9f27053e4.png">


点击上图中的![image](https://user-images.githubusercontent.com/114125357/197451443-146c5a68-de00-424a-8f50-9ce37718928c.png)
和<img width="291" alt="image" src="https://user-images.githubusercontent.com/114125357/198185604-95906861-b48f-4b43-8828-80ab032fc3ec.png">后出现如下弹窗  
<img width="473" alt="image" src="https://user-images.githubusercontent.com/114125357/198185745-6a2f0323-bb7a-4c50-9141-996f10f0373a.png">


点击**确认删除**即可完成触发规则的删除。

### 触发规则优先级调整
<img width="1580" alt="image" src="https://user-images.githubusercontent.com/114125357/198185475-53a21cc9-4a0a-4cf4-a197-6ff9f27053e4.png">  


点击上图中的![image](https://user-images.githubusercontent.com/114125357/197451708-936dced7-ec6a-4492-ae8b-7f6acb85eab3.png)
和<img width="1580" alt="image" src="https://user-images.githubusercontent.com/114125357/198186034-f9cdf4fa-a30e-4da0-a381-6e9c4ab2754e.png">


  
  

![image](https://user-images.githubusercontent.com/114125357/197451752-5b9c0e96-d78c-4b5b-8c3b-f32b8f0fad70.png)
点击后，位置将会上移动

![image](https://user-images.githubusercontent.com/114125357/197451761-b11fa6fc-8532-470f-918f-d48cd5aa0606.png)
点击后，位置将会下移动

若请求URL匹配到多个触发规则的情况下（如上图中序号为01和02的触发规则）位置在前的触发规则将会执行（如上图中的序号01规则），位置在后的触发规则将不会执行（如上图中的序号02规则）。

## 案例介绍
接下来的案例将为您介绍若请求URL匹配到多个触发规则的情况下，如何调整触发规则的执行顺序。

已新建相同的触发条件的两个不同函数，如下所示：     

![image](https://user-images.githubusercontent.com/114125357/197451846-532dd650-1d86-40f5-ad77-73facf427e99.png)  


![image](https://user-images.githubusercontent.com/114125357/197451876-f6aac4fc-182d-4ffa-b86f-dfb825e28d27.png)   
![image](https://user-images.githubusercontent.com/114125357/197451900-5b8ba1c5-332c-4f52-ac98-81619d398ebb.png)

函数test1的代码如下：
```
const testhtml = `<!DOCTYPE html>
<body>
  <h1>Hello World</h1>
  <p>This markup was generated by a TencentCloud  <br>EdgeOne Functions test 1.</br></p>
</body>`;

async function handleRequest(request) {
  return new Response(testhtml, {
    headers: {
      'content-type': 'text/html;charset=UTF-8',
       'test': 'Welcome to use Edge Functions.',
    },
  });
}

addEventListener('fetch', event => {
  return event.respondWith(handleRequest(event.request));
});  
```
函数test2的代码如下：
```
const testhtml = `<!DOCTYPE html>
<body>
  <h1>Hello World</h1>
  <p>This markup was generated by a TencentCloud  <br>EdgeOne Functions test 2.</br></p>
</body>`;

async function handleRequest(request) {
  return new Response(testhtml, {
    headers: {
      'content-type': 'text/html;charset=UTF-8',
       'test': 'Welcome to use Edge Functions.',
    },
  });
}

addEventListener('fetch', event => {
  return event.respondWith(handleRequest(event.request));
});   
```
函数test1的触发规则的顺序为01，函数test2的触发规则的顺序为02，如下图所示：  

<img width="1580" alt="image" src="https://user-images.githubusercontent.com/114125357/198186599-d4688d65-dba7-4ab2-ad07-5ca0d6fd0451.png">  






在浏览器中输入：http://edgefunctions.qcdntest.com.cn/  并回车，响应内容如下
![image](https://user-images.githubusercontent.com/114125357/197452642-47b4f926-bc4d-438c-8c22-74b5a47c8e83.png)   





函数test2点击后![image](https://user-images.githubusercontent.com/114125357/197452671-36600948-f280-4b61-b47b-f168570bfcf0.png)
，点击**保存**即可完成函数test2的触发规则的顺序为01，函数test1的触发规则的顺序为02的顺序调整。  

<img width="1583" alt="image" src="https://user-images.githubusercontent.com/114125357/198186984-842570f1-3c07-4dfc-8d80-1d08f3ecbe28.png">
 

<img width="1584" alt="image" src="https://user-images.githubusercontent.com/114125357/198187054-0d4013e6-8fa1-4a9e-ae0c-36c0ac36095b.png">


再次在浏览器中输入：http://edgefunctions.qcdntest.com.cn/  并回车，响应内容如下：
![image](https://user-images.githubusercontent.com/114125357/197452748-30776108-04cc-4d07-8689-77405cc7e9d8.png)    

以上为若请求URL匹配到多个触发规则的情况下，如何调整触发规则的执行顺序的操作过程。

