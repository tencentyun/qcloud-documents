
勒索病毒是黑客通过技术手段将受害者机器内的重要数据文件进行加密，迫使受害者向黑客缴纳赎金来解密文件，从而非法牟利勒索钱财的病毒。勒索病毒的攻击也是最近几年非常活跃的攻击类型。本系统（包括御点客户端和御点后台控制中心）支持对勒索病毒攻击的防御，同时被新型变种病毒攻击后，也能恢复经过系统设置关注的私有文件。

## 攻击防御
勒索病毒的入侵方式与普通病毒入侵方式类似，会通过各种场景并利用漏洞或系统机制实现入侵。通过 [主机安全场景防范](https://cloud.tencent.com/document/product/1009/40591) 可以极大程度的实现病毒阻击，根据对常规勒索病毒的行为分析，我们可以提取出一些通用的关联特征，并进行智能分析阻断。同时，部分勒索病毒利用网络协议漏洞进行入侵，也可以通过 [网络攻击防御](https://cloud.tencent.com/document/product/1009/40592)，有效阻断这类协议漏洞利用攻击。

<span id="zdbf"></span>
## 自动备份恢复
勒索病毒加密文档的最终路径通常为修改文档，本系统（包括御点客户端和御点后台控制中心）采用修改前自动备份的方式，对最终路径（修改文档）进行防御。自动备份恢复功能，对性能有一定影响，我们已经做了优化处理，只在文档被修改时进行备份，确保以最小的代价，实现文档的安全保护。备份文档会自动加入保护区，确保不被病毒二次修改。

  - **开启自动备份恢复功能**
在御点后台控制中心，选择【策略中心】>【安全分组策略】>【常规设置】，在“终端模块定制”功能中，勾选“文档守护者”，该功能最终会展示在御点客户端的工具箱当中。
![](https://main.qcloudimg.com/raw/027ed61c31b4e3d9f0aba672394a475a.png)
  - **自定义备份私有文档**
1. 设置待备份的文档类型。打开御点客户端，选择【工具箱】>【文档守护者】，在文档守护者中，单击【设置中心】
 ![](https://main.qcloudimg.com/raw/8c3d9447b5e6b01f948d92bc179272e6.png)
2. 在设置中心，单击【文档类型】 ，添加需要关注的文档类型列表。
>?该步骤需人工参与，因为本系统（包括御点客户端和御点后台控制中心）仅对关注的文档类型进行自动备份，为减少性能消耗，尽可能对重要文档进行处理。已默认添加了常用的24种文档格式，需要增减操作，请用户自行进行。
>
![](https://main.qcloudimg.com/raw/e203ea885fbea4d4f448b937085526c0.png)
3. 在设置中心，单击【备份目录】，进行备份目录设置。当前备份目录，默认全盘，会自动排除软件运行目录、系统目录和一些临时目录，确保需要备份的文件，均为用户私有文档。用户也可以自行定义需要关注的目录，减少关注目录，可以降低性能消耗。
![](https://main.qcloudimg.com/raw/708a07282b2acdb22c7ffd090240cffe.png)
4. 文件中毒后，可以从保护区备份空间中，恢复文档。在文档守护者中，选择【文档找回】>【勒索病毒急救】，选择“还原时间”（默认会备份近7天的文档，可以选择还原到任意版本。若时间选择今天，则可以还原最新修改版本），以及“还原路径”，单击【开始还原】，即可对备份文档进行恢复找回。
![](https://main.qcloudimg.com/raw/e9a9183abfcd8a712c33a591dc0fd915.png)

<span id="wdjm"></span>
## 文档解密
本系统（包括御点客户端和御点后台控制中心）支持对部分被病毒加密过的文档进行解密。在御点客户端中，选择【工具箱】>【文档守护者】>【文档解密】，可以实现解密。
>!只能针对经过分析后的部分类型的病毒进行解密。

绝大多数情况下，勒索病毒使用了高强度非对称加密算法对文件进行加密（例：RSA+AES），由于算法不可逆，被勒索病毒加密的文件通过常规技术手段也无法解密。少数可解密情况主要有：
- 勒索病毒自身设计缺陷导致的加密算法可逆，密钥泄漏场景下的文件可解密。
- 得益于警方与安全公司的合作，对勒索团伙进行打击后，拿到了病毒作者手中的密钥，进而使用该密钥开发出解密工具。
- 勒索病毒作者自己放出了手中的密钥，进而开发出了解密工具。

由于上述类型场景均为小概率事件，所以并不是所有类型勒索病毒均可以解密。文档守护者提供两种方式（本地解密和在线解密）进行解密，并且提供实时更新最新的解密能力。用户可以尝试先用本地解密，再用在线解密。
 - **本地解密**
在御点客户端中，选择【工具箱】>【文档守护者】>【文档解密】，单击【选择文档目录】，选择被加密文档所在的目录，单击【快速解密】即可。
>!解密后文件会保存在原始加密文档的所在路径，但也会同时保留原始文档。
>
![](https://main.qcloudimg.com/raw/a37e3f89366fbcabf68bedd15273c926.png)  
 - **在线解密**
1. 在御点客户端中，选择【工具箱】>【文档守护者】>【文档解密】，单击【了解更多】，可进入在线解密工具进行查询。
![](https://main.qcloudimg.com/raw/d084cece3f82af0de69c89be202890b7.png)
2. 可根据病毒名或被加密后的文件后缀进行搜索。例如，电脑桌面上，有一个被加密的文档为“我的文件.Z81928819”，则在搜索框中，输入后缀名“Z81928819”，单击【立即查询】即可。在解密工具中，单击【立即下载】，下载解密工具，按照使用说明，进行尝试解密。由于病毒变种较快，无法保证一定能可以解密成功。
>!输入后缀时，去掉后缀中的第一个点。
>
![](https://main.qcloudimg.com/raw/60ef5c6355495750b4fc0648e3b0e169.png)



## 勒索病毒应急处理步骤
如果因为异常操作或安全漏洞等导致勒索病毒入侵，请参考如下操作进行应急处理：
1. 断网，且断开移动存储、共享磁盘。
2. 确认中毒机器御点客户端已开启，且自保护已开启。在御点客户端中，选择【设置中心】>【常规设置】>【自保护】。如发现未开启（选项为“临时关闭自保护”），则开启自保护。
3. 使用御点客户端，进行全盘扫描。如发现风险病毒，则立刻清除，如未发现风险病毒，请直接进行 [第7步](#7) 。
4. 如果御点客户端并未被非法退出，文档守护者功能将进行重要文档备份（详情请参见 [自动备份恢复](#zdbf)），可尝试恢复所需文档。
5. 如存在未备份的文档且被加密，请参见 [文档解密](#wdjm)，尝试进行解密。如无法恢复，请直接进行 [第7步](#7)。
6. 请参见 [管理员日常维护建议](https://cloud.tencent.com/document/product/1009/40586)，进行一次完备的安全修复。
7. 如上述方式无法解决问题，请及时联系腾讯安全工程师进行维护（紧急电话：0755-86399799）。
