## 功能简介
自定义策略支持从 HTTP 报文的请求路径、GET 参数、 POST 参数、 Referer 和 User-Agent 等多个特征进行组合，通过特征匹配来对公网用户的访问进行管控。面对来自互联网上的各种攻击行为，腾讯云用户可以利用自定义策略灵活应对，组合出有针对性的规则来阻断各类攻击行为。
>!
- 每个自定义策略最多可以设置5个条件进行特征控制。
- 每个自定义策略中的多个条件之间是“与”的关系，即所有条件全部匹配，策略才可生效。
- 每个自定义策略匹配之后可以配置两种处理动作：阻断和放行。

## 配置案例
### 案例一：禁止特定 IP 地址访问指定站点
当网站管理员需要禁止特定 IP 地址访问指定站点时，可以通过以下方法进行配置：
1. 登录 [Web 应用防火墙控制台](https://console.cloud.tencent.com/guanjia)，在左侧导航栏中，单击 【Web 安全防护】 > 【防护设置】，在域名列表中，选择需要防护的站点域名，在右侧操作栏中，单击【防护配置】，进入防护设置页面，选择【自定义策略】>【添加规则】。
 ![](https://main.qcloudimg.com/raw/45057439116e288c677517dc52aab06c.png)
2. 在添加规则页面内，输入规则名称（如001），在匹配字段中选择一个字段（如来源 IP），逻辑符号选择匹配，匹配内容填入需要禁止访问的来源 IP（如`192.168.1.1`），选择执行动作（如阻断），填写完成后，单击 【添加】，保存规则。
![](https://main.qcloudimg.com/raw/7638168e6a9a0b6e7bed209b7a8062bd.png)
>?Web 应用防火墙的自定义策略支持使用掩码来控制某一网段的源 IP 的访问请求。我们可以在匹配内容中输入特定网段（如`10.10.10.10/24` ）。
3. 此时规则将会生效，来自特定源 IP 的 HTTP 访问请求将会全部阻断。
![](https://main.qcloudimg.com/raw/8df717318ed4dbb21d429e1efdefb079.png)

### 案例二：禁止公网用户访问特定的 Web 资源 
当网站管理员不希望公网用户访问某些特定的 Web 资源时（如管理后台`/admin.html`），可以进行以下配置：匹配字段选择“请求路径”，逻辑符号选择“等于”，匹配内容输入“`/admin.html`” ，执行动作选择“阻断”，配置完成后单击【添加】即可。
![](https://main.qcloudimg.com/raw/efce057b9a83f5fa4f8643cdc9568f81.png)
### 案例三：禁止某个外部站点盗链获取资源 
当网站管理员需要阻断外部站点（如`www.test.com`）的盗链行为时，可以利用自定义策略对盗链请求的 Referer 特征进行捕获和阻断，配置如下：匹配字段选择 “Referer” ，逻辑符号选择“包含”，匹配内容输入“`www.test.com`”，执行动作选择“阻断”，配置完成后单击【添加】即可。
![](https://main.qcloudimg.com/raw/531144708e4bcdb649c02a239ba2e7ba.png)
<a href="https://cloud.tencent.com/document/product/627/11710" target="_blank">上一步：网页防篡改</a>


### 案例四：将策略复制到目标域名
当配置好某个策略时，若希望将此策略同时应用到其他域名，则可以通过复制策略来实现。
1. 登录 [Web 应用防火墙控制台](https://console.cloud.tencent.com/guanjia)，在左侧导航栏中，单击 【Web 安全防护】 > 【防护设置】>【自定义策略】，进入自定义策略页面。
2. 在自定义策略页面，选中所需策略并单击【复制】，弹出复制自定义策略弹窗。
![](https://main.qcloudimg.com/raw/2e6c00b3a113f8001063bf64454b1eb7.png)
3. 在复制自定义策略弹窗，选择需要的域名，单击【复制】，即可将策略复制到目标域名。
![](https://main.qcloudimg.com/raw/621a4344f689ffa07f0690c56fe07e69.png)
