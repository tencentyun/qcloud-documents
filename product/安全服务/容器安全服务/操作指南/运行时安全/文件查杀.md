文件查杀提供实时检测和定期扫描容器内木马病毒文件功能。

## 查看风险趋势
1. 登录 [容器安全服务控制台](https://console.cloud.tencent.com/tcss/runtime/tojanDetection)，在左侧导航中，单击**运行时安全** > **文件查杀**。
2. 在文件查杀页面，可以查看待处理风险、影响容器的数量和趋势。
 - 待处理风险：展示近7天待处理风险趋势图和较昨日新增风险数据。将鼠标悬停在趋势图上，展示某一天的待处理风险数据。
 - 影响容器：展示近7天影响容器趋势图和较昨天新增影响容器数据。将鼠标悬停在趋势图上，展示某一天的影响容器数据。
![](https://qcloudimg.tencent-cloud.cn/raw/87079a9c65e581ba67c20de74db927c2.png)


## 设置风险检测
在 [文件查杀页面](https://console.cloud.tencent.com/tcss/runtime/tojanDetection) 的风险检测模块，支持对定时检测和实时监控功能进行设置。
>?
>- 实时监控是客户配置的路径的增量文件实时检测。
>- 定时检测是客户配置的路径全部文件检测。
>
![](https://qcloudimg.tencent-cloud.cn/raw/d3c5ab0019f009e90aaae6090a7a97e5.png)


### 设置定时检测
1. 在风险检测模块，单击定时检测右侧的![](https://qcloudimg.tencent-cloud.cn/raw/817a9f9a8a94c577ad4db00e778b609d.png)，进入定时检测设置页面。
2. 在定时检测设置页面，单击![](https://qcloudimg.tencent-cloud.cn/raw/e9dc8af888170e4d638b8d3df829e2a0.png)，开启定时检测，并依次设置检测时间、检测路径、检测范围。
![](https://qcloudimg.tencent-cloud.cn/raw/c4b662551f9cf3594c0afdf651654231.png)
**参数说明：**
 - 实时检测开关：支持通过单击“开关”，可开启或关闭实时检测功能。
 - 检测时间
    - 检测周期：包括每天、每隔三天、每隔七天。
    - 开始检测时间：配置定时任务何时开始扫描。
    - 超时时长：当检测时长达到超时设置时间时，检测任务将终止。默认时间为5小时。
 - 检测路径
    - 全部路径：检测容器内全部文件路径。
    - 自选路径：按自选的配置路径检测容器内文件。
  - 检测范围
    - 主机节点：选择主机节点时，可选择扫描全部节点或自选节点。自选节点时，支持按节点名称和 IP 筛选需定时扫描的节点。
    - 容器：选择容器时，可选择全部容器或自选容器。自选容器时，支持按容器名称和容器 ID 筛选需定时扫描的容器。
3. 单击**保存设置**，即可完成定时检测设置。

### 设置实时监控
1. 在风险检测模块，单击实时监控右侧的![](https://qcloudimg.tencent-cloud.cn/raw/817a9f9a8a94c577ad4db00e778b609d.png)，进入实时监控设置页面。
2. 在实时监控设置页面，单击![](https://qcloudimg.tencent-cloud.cn/raw/e9dc8af888170e4d638b8d3df829e2a0.png)，开启实时监控，配置相关参数，
![](https://qcloudimg.tencent-cloud.cn/raw/ce96e50314ca9e7592134ff67f4a2e5a.png)
**参数说明：**
 - 实时监控开关：支持通过单击![](https://qcloudimg.tencent-cloud.cn/raw/791358be9d7b92e48b4e12569ec94290.png)或![](https://qcloudimg.tencent-cloud.cn/raw/a2de0e7ebf784e5b864c4c7a3762d6ba.png)开启或关闭实时监控功能。
 - 检测路径
    - 全部路径：检测容器内全部文件路径。
    - 自选路径：按自选的配置路径检测容器内文件。
  - 选择路径：根据实际需求选择**检测以下文件路径**或**检测除以下文件路径外的其他路径**。单击![](https://qcloudimg.tencent-cloud.cn/raw/9cddee4bce0b128b81985de84155a405.png)可添加多个路径，最多为30个。
3. 单击**保存设置**，即可完成实时监控设置。

### 设置一键检测
1. 在风险检测模块，单击**一键检测**，进入一键检测页面。
2. 在一键检测页面，选择检测路径、检测范围，并设置超时时间。
![](https://qcloudimg.tencent-cloud.cn/raw/65662b1e232694e3df60e33eecb8eb74.png)
**参数说明：**
 - 检测路径：
    - 全部路径：检测容器内全部文件路径。
    - 自选路径：按自选的配置路径检测容器内文件。
  - 检测范围：
   - 主机节点：选择主机节点时，可选择扫描全部节点或自选节点。自选节点时，支持按节点名称和 IP 筛选需定时扫描的节点。
   - 容器：选择容器时，可选择全部容器或自选容器。自选容器时，支持按容器名称和容器 ID 筛选需定时扫描的容器。
 - 超时设置：当检测时长达到超时设置时间时，检测任务将终止。默认时间为5小时。
3. 单击**开始检测**，即按配置条件开始扫描容器内文件。

### 查看最近一次检测结果
在风险检测模块，单击**最近一次检测结果**，可查看近一次扫描任务详情。
![](https://qcloudimg.tencent-cloud.cn/raw/ff2e7e65054fdf89ccfe6c4a5e6561a3.png)
**检测详情展示内容：**
- **检测详情概览**
 - 近一次扫描任务是否发现风险文件，如有发现，将展示风险文件数量、风险容器数量和扫描容器数量。
 - 近一次扫描任务开始检测和结束检测时间。
- **检测详情列表**：展示近一次扫描任务扫描出的风险文件概况，按容器资产进行聚合。
 - 列表字段包括：容器名称/ID、镜像名称/ID、主机节点名称/IP、检测状态、检测用时、风险数和操作项。
 - 支持对扫描任务进行重新检测，或停止正在检测中的任务。
 - 支持按主机名称、主机 IP、容器名称、容器 ID、镜像名称、镜像 ID 进行检索。
 - 单击![](https://qcloudimg.tencent-cloud.cn/raw/07ede18bc7eebcd0721ef5189a3b0460.png)可查看风险文件的文件名称、文件路径、病毒名称和查看详情按钮；单击**查看详情**，可查看恶意文件详情。

## 查看事件列表
在 [文件查杀页面](https://console.cloud.tencent.com/tcss/runtime/tojanDetection) 的事件列表模块中，展示模块中提供容器木马病毒检测结果。

### 筛选事件
在事件列表模块中，支持通过如下两种方法对事件进行筛选。
- 单击搜索框通过“文件名称、文件路径、病毒名称、容器名称”等关键词查询木马病毒事件。
![](https://qcloudimg.tencent-cloud.cn/raw/d3d507150b9cd7e7e1b541205541dd9e.png)
- 单击容器状态或状态右侧的![](https://qcloudimg.tencent-cloud.cn/raw/1837d63ca61d7e3b533e3199089cb3cc.png)，可以通过容器状态和事件状态对木马病毒事件进行查询。
![](https://qcloudimg.tencent-cloud.cn/raw/cbceedc190d713a2fcc3292bd9478a20.png)

### 查看详情
在事件列表模块中，单击**查看详情**，右侧抽屉展示事件详情信息，包括病毒文件基本信息、事件详情、事件描述和进程信息。仅实时监控上报的事件详情中展示进程信息。
![](https://qcloudimg.tencent-cloud.cn/raw/f7600ed188f602fcd483d0c328118593.png)

### 处理事件
在事件列表模块中，单击**立即处理**，可以选择对事件进行添加白名单、隔离（推荐）、忽略、删除，单击**确定**，即可对事件进行上述处理。
![](https://qcloudimg.tencent-cloud.cn/raw/13345425a8c7d55cdf5ab98b2cb4a5e5.png)
**参数说明：**
- 添加白名单：若您确认该文件无恶意并添加白名单，**系统将不再对该文件进行检测，请谨慎操作**。
- 隔离（推荐）：隔离此病毒文件，让黑客无法再次启动它，便于您定位病毒文件位置，对其进行查杀。
- 忽略：仅将本次告警事件进行忽略，若再有相同事件发生依然会进行告警。
- 删除：删除该事件记录，控制台将不再显示，无法恢复记录，请慎重操作。

## 自动隔离文件
容器安全服务新增木马自动隔离功能，支持自动隔离检测出的系统黑名单文件，以及用户自定义的恶意文件。

### 系统自动隔离文件
容器安全将自动隔离检测出的系统黑名单文件，部分恶意文件仍需用户手动确认隔离，建议您检查文件查杀列表中所有安全事件，确保已全部处理。若出现误隔离，请在已隔离列表中对文件进行恢复。

1. 登录 [容器安全服务控制台](https://console.cloud.tencent.com/tcss/runtime/tojanDetection)，在左侧导航中，单击**运行时安全** > **文件查杀**。
2. 在文件查杀页面，单击右上角的**查杀设置**。
![](https://qcloudimg.tencent-cloud.cn/raw/213b48e3a39220a57986b211d2873ce1.png)
3. 在查杀设置窗口中，单击**自动隔离文件**。
4. 在系统自动隔离文件模块，可单击![](https://qcloudimg.tencent-cloud.cn/raw/d41405db851c32a2709793ee8806946c.png)开启或关闭自动隔离，同时，支持隔离并结束恶意文件相关进程。
>?
>- 系统黑名单文件：腾讯云容器安全运营专家与算法专家经过沉淀的文件名单，此名单中的文件可进行自动隔离。
>- 自动隔离开关默认关闭，客户可根据需求进行开启。启动自动隔离时，客户可自定义勾选是否隔离并结束恶意文件相关进程。
>   - 自动隔离开启时，系统黑名单和用户自定义黑名单均生效，支持对黑名单中的文件进行自动隔离。
>   - 自动隔离关闭时，系统黑名单和用户自定义黑名单均不对告警关联的恶意文件进行自动隔离。
>
![](https://qcloudimg.tencent-cloud.cn/raw/95106d6ef532f87069bd384f146efb1d.png)

### 用户自定义隔离文件
支持查看用户自定义隔离文件列表，自定义开启或关闭该文件的自动隔离开关。

1. 登录 [容器安全服务控制台](https://console.cloud.tencent.com/tcss/runtime/tojanDetection)，在左侧导航中，单击**运行时安全** > **文件查杀**。
2. 在文件查杀页面，单击右上角的**查杀设置**。
![](https://qcloudimg.tencent-cloud.cn/raw/213b48e3a39220a57986b211d2873ce1.png)
3. 在查杀设置窗口中，单击**自动隔离文件**。
4. 在用户自定义隔离文件模块，支持控制自动隔离开关、查看详情和下载文件。
![](https://qcloudimg.tencent-cloud.cn/raw/a1b06c60f789d2f1f20c65bd286bb0c9.png)
操作说明：
 - 单击**自动隔离开关**，可开启或关闭自动隔离。
 - 单击**详情**查看恶意文件的基本信息、危害描述和修复建议。
 - 单击**下载**，可下载该恶意文件。

### 隔离文件列表
- 在 [文档查杀页面](https://console.cloud.tencent.com/tcss/runtime/trojanDetection) 的事件列表中，手动隔离恶意文件时，如勾选“再次检测到该病毒文件时自动隔离”，该恶意文件的 MD5值将记录在用户自定义隔离文件列表，自动隔离开关状态为开启。系统将对后续检出的同样文件进行自动隔离。当事件列表中手动隔离的恶意文件取消隔离后，用户自定义隔离文件列表中将删除该条记录，自动隔离配置也不再生效。
![](https://qcloudimg.tencent-cloud.cn/raw/c342815c2348432ada9f0d36b4dd5d4d.png)
- [文档查杀页面](https://console.cloud.tencent.com/tcss/runtime/trojanDetection) 的事件列表中，手动隔离恶意文件时，不勾选“再次检测到该病毒文件时自动隔离”，该恶意文件的MD5值将记录在用户自定义隔离文件列表，自动隔离开关状态为关闭。
>?用户自定义隔离文件自动隔离生效，需开启系统自动隔离开关；否则，即使处理安全事件时勾选“再次检测到该病毒文件时自动隔离”，系统也不会对自定义黑名单进行隔离。
>
![](https://qcloudimg.tencent-cloud.cn/raw/d8a7556e1da668ae887adeca9d69eb10.png)


