## 概述
模板变量 [Variables](https://grafana.com/docs/reference/templating/) 是 Grafana 提供的一种 Dashboard 优化特性，用于创建高度可复用和交互式 Dashboard。模板变量的一般思想是允许 Grafana 从数据源获得不同的度量，并提供一种无需修改仪表板就可以动态更改它的方法。腾讯云监控应用目前提供了地域、云服务器实例、云数据库 MySQL 实例 等变量。

>!所有实例类 Query 支持自定义下拉框选项展示字段，通过 `display` 字段设置，如：`Namespace=QCE/REDIS&Action=DescribeInstances&Region=$region&display=${InstanceId}-${InstanceName}`。如果同时存在 `InstanceAlias` 和 `display` 字段，则仅会展示 `display` 的值。

已经提供的模板变量如下表所示：  

变量 | 描述 | 示例 |
---- | --- | --- |
地域                       | 参见 [地域接口文档](https://cloud.tencent.com/document/api/213/15708)。`Action` 固定为 `DescribeRegions`，`Namespace` 为云产品对应的命名空间，如 `QCE/CVM` `QCE/CDB`等。地区作为变量模板，只支持单选，如设置成多选或者选中 `All`, 默认选中第一个地区值。 |  Namespace=QCE/CVM&Action=DescribeRegions
云服务器实例                | 参见 [云服务器查询实例列表接口文档](https://cloud.tencent.com/document/api/213/15728)。`Namespace` 固定为`QCE/CVM`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`、`PrivateIpAddresses`、`PublicIpAddresses`。云服务器实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CVM&Region=ap-beijing&Action=DescribeInstances&InstanceAlias=PublicIpAddresses
云数据库 MySQL 实例         | 参见 [云数据库MySQL查询实例列表接口文档](https://cloud.tencent.com/document/api/236/15872)。`Namespace` 固定为`QCE/CDB`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`、`Vip`。云数据库实例作为模板变量，同时支持单选和多选。 |  Namespace=QCE/CDB&Region=ap-beijing&Action=DescribeInstances&InstanceAlias=InstanceId
 云数据库 PostgreSQL 实例   | 参见 [云数据库PostgreSQL查询实例列表接口文档](https://cloud.tencent.com/document/api/409/16773)。`Namespace` 固定为`QCE/CDB`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `DBInstanceId`，可选值为 `DBInstanceName`, `PrivateIpAddresses`, `PublicIpAddresses`。云数据库实例作为模板变量，同时支持单选和多选。 |  Namespace=QCE/POSTGRES&Region=ap-beijing&Action=DescribeInstances&InstanceAlias=DBInstanceId
私有网络 NateGateway 实例   | 参见 [私有网络Nat网关查询实例列表接口文档](https://cloud.tencent.com/document/api/215/36034)。`Namespace` 固定为`QCE/NAT_GATEWAY`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `NatGatewayId`，可选值为 `NatGatewayName`。NateGateway 网关实例作为模板变量，同时支持单选和多选。 |  Namespace=QCE/NAT_GATEWAY&Region=ap-beijing&Action=DescribeInstances&InstanceAlias=NatGatewayId
私有网络对等连接实例         | 参见 [私有网络对等连接查询实例列表接口文档](https://cloud.tencent.com/document/api/215/2101)。`Namespace` 固定为`QCE/PCX`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `peeringConnectionId`，可选值为 `peeringConnectionName`。对等连接实例作为模板变量，同时支持单选和多选（如果是负载均衡则不支持多选，可选多个监听器）。 |  Namespace=QCE/PCX&Region=ap-beijing&Action=DescribeInstances&InstanceAlias=peeringConnectionId
负载均衡实例                | 参见 [负载均衡实例列表接口文档](https://cloud.tencent.com/document/product/214/30685)。`Namespace` 可为`QCE/LB_PRIVATE`，`QCE/LB_PUBLIC`，`QCE/LOADBALANCE`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-guangzhou`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `LoadBalancerId`，可选值为 `LoadBalancerName`，`LoadBalancerVips`。同时支持单选和多选。 |  Namespace=QCE/LB_PRIVATE&Action=DescribeInstances&Region=$region&InstanceAlias=LoadBalancerId
负载均衡监听器              | 参见 [负载均衡监听器列表接口文档](https://cloud.tencent.com/document/product/214/30686)。`Namespace` 可为`QCE/LB_PRIVATE`，`QCE/LB_PUBLIC`，`QCE/LOADBALANCE`，`Action` 固定为`DescribeListeners`。`Region` 为地域参数，可以为特定的地域值，如 `ap-guangzhou`；也可以为变量值，如 `$region`。`Instance` 为实例id，可以为特定的实例，如 `lbl-rbw529fz`；也可以为变量值，如 `$instance`。`listenerAlias` 为监听器的展示字段，默认为 `ListenerId`，可选值为 `ListenerName`，`Port`。同时支持单选和多选。 |  Namespace=QCE/LB_PRIVATE&Action=DescribeListeners&Region=$region&Instance=$instance&listenerAlias=ListenerId
mongoDB数据库              | 参见 [CMONGO实例查询实例列表接口文档](https://cloud.tencent.com/document/api/240/38568)。`Namespace` 固定为`QCE/CMONGO`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`。CMONGO实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CMONGO&Region=$region&Action=DescribeInstances
redis数据库                | 参见 [REDIS实例查询实例列表接口文档](https://cloud.tencent.com/document/api/239/20018)。`Namespace` 固定为`QCE/REDIS`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`。REDIS实例作为模板变量，同时支持单选和多选。  |   Namespace=QCE/REDIS&Region=$region&Action=DescribeInstances
cdn内容分发网络             | 参见 [CDN实例查询实例列表接口文档](https://cloud.tencent.com/document/api/228/41118)。`Namespace` 固定为`QCE/CDN`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `Domain`，可选值为 `Domain`, `ProjectId`。CDN实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CDN&Region=$region&Action=DescribeInstances 
bwp带宽包                  | 参见 [BWP实例查询实例列表接口文档](https://cloud.tencent.com/document/api/215/19209)。`Namespace` 固定为`QCE/BWP`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `BandwidthPackageId`，可选值为 `BandwidthPackageId`, `BandwidthPackageName`。BWP实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/BWP&Region=$region&Action=DescribeInstances
ckafka消息队列             | 参见 [CKAFKA实例查询实例列表接口文档](https://cloud.tencent.com/document/api/597/40835)。`Namespace` 固定为`QCE/CKAFKA`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`。CKAFKA实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CKAFKA&Region=$region&Action=DescribeInstances
LB弹性公网IP               | 参见 [LB实例查询实例列表接口文档](https://cloud.tencent.com/document/api/215/16702)。`Namespace` 固定为`QCE/LB`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `AddressId`，可选值为 `AddressId`, `AddressName`, `AddressIp`。LB实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/LB&Region=$region&Action=DescribeInstances
CFS文件存储                | 参见 [CFS实例查询实例列表接口文档](https://cloud.tencent.com/document/api/582/38170)。`Namespace` 固定为`QCE/CFS`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `FileSystemId`，可选值为 `FileSystemId`, `FsName`。CFS实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CFS&Region=$region&Action=DescribeInstances
SCF云函数                  | 参见 [SCF实例查询实例列表接口文档](https://cloud.tencent.com/document/api/583/18582)。`Namespace` 固定为`QCE/SCF_V2`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `FunctionId`，可选值为 `FunctionId`, `FunctionName`。SCF实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/SCF_V2&Region=$region&Action=DescribeInstances
DCX专线接入-专用通道(DCX)                  | 参见 [DCX实例查询实例列表接口文档](https://cloud.tencent.com/document/api/216/19819)。`Namespace` 固定为`QCE/DCX`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `DirectConnectTunnelId`，可选值为 `DirectConnectTunnelName`。DCX实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/DCX&Region=$region&Action=DescribeInstances
DC专线接入-物理专线(DC)                  | 参见 [DC实例查询实例列表接口文档](https://cloud.tencent.com/document/api/216/34826)。`Namespace` 固定为`QCE/DC`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `DirectConnectId`，可选值为 `DirectConnectName`。DC实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/DC&Region=$region&Action=DescribeInstances
CYNOSDBMYSQL云数据库 CYNOSDB(CYNOSDB_MYSQL)                  | 参见 [CYNOSDBMYSQL实例查询实例列表接口文档](https://cloud.tencent.com/document/api/1003/48334)。`Namespace` 固定为`QCE/CYNOSDB_MYSQL`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`。CYNOSDBMYSQL实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CYNOSDB_MYSQL&Region=$region&Action=DescribeInstances
TCAPLUS云数据库 TcaplusDB(TCAPLUS)                  | 参见 [TCAPLUS集群列表接口文档](https://cloud.tencent.com/document/product/596/41489)。`Namespace` 固定为`QCE/TCAPLUS`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`。TCAPLUS实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/TCAPLUS&Region=$region&Action=DescribeInstances
SQLSERVER云数据库sqlserver(SQLSERVER)                  | 参见 [SQLSERVER实例查询实例列表接口文档](https://cloud.tencent.com/document/api/238/19969)。`Namespace` 固定为`QCE/SQLSERVER`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `Name`。SQLSERVER实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/SQLSERVER&Region=$region&Action=DescribeInstances
VPNGW私有网络-VPN 网关(VPNGW)                  | 参见 [VPNGW实例查询实例列表接口文档](https://cloud.tencent.com/document/api/215/17514)。`Namespace` 固定为`QCE/VPNGW`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `VpnGatewayId`，可选值为 `VpnGatewayName`。VPNGW实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/VPNGW&Region=$region&Action=DescribeInstances
DCG私有网络-专线网关(DCG)                  | 参见 [DCG实例查询实例列表接口文档](https://cloud.tencent.com/document/api/215/30644)。`Namespace` 固定为`QCE/DCG`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `DirectConnectGatewayId`，可选值为 `DirectConnectGatewayName`。DCG实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/DCG&Region=$region&Action=DescribeInstances
CDNPROVINCE省份域名(CDN_LOG_DATA)                  | 参见 [CDNPROVINCE实例查询实例列表接口文档](https://cloud.tencent.com/document/api/228/41118)。`Namespace` 固定为`QCE/CDN_LOG_DATA`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `Domain`，可选值为 `ProjectId`。 |   Namespace=QCE/CDN_LOG_DATA&Region=$region&Action=DescribeInstances
CDNPROVINCE省份运营商(CDN_LOG_DATA)                  | 参见 [CDNPROVINCE的map信息列表接口文档](https://cloud.tencent.com/document/api/228/31296)。`Namespace` 固定为`QCE/CDN_LOG_DATA`，`Action` 固定为`DescribeMapInfo`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`Instance` 为实例,可为变量值，如`$instance`。`Name`为接口必填参数，用于获取运营商或者省份列表，isp-运营商，district-省份。详见参见文档 |   Namespace=QCE/CDN_LOG_DATA&Region=$region&Action=DescribeInstances&Instance=$instance&Name=isp
APIGATEWAYAPI 网关(APIGATEWAY)                  | 参见 [APIGATEWAY实例查询实例列表接口文档](https://cloud.tencent.com/document/api/628/45194)。`Namespace` 固定为`QCE/APIGATEWAY`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `ServiceId`，可选值为 `ServiceName`。 |   Namespace=QCE/APIGATEWAY&Region=$region&Action=DescribeInstances
APIGATEWAYAPI 服务环境(APIGATEWAY)                  | 参见 [APIGATEWAY服务环境列表接口文档](https://cloud.tencent.com/document/api/628/45198)。`Namespace` 固定为`QCE/APIGATEWAY`，`Action` 固定为`DescribeServiceEnvironmentList`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`Instance` 为实例，可以为特定的地域值；也可以为变量值，如 `$instance`。 |   Namespace=QCE/APIGATEWAY&Region=$region&Action=DescribeInstances&Instance=$instance
CBS云硬盘(BLOCK_STORAGE)                  | 参见 [CBS实例查询实例列表接口文档](https://cloud.tencent.com/document/api/362/16315)。`Namespace` 固定为`QCE/BLOCK_STORAGE`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `DiskId`，可选值为 `DiskName`。CBS实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/BLOCK_STORAGE&Region=$region&Action=DescribeInstances
CESElasticsearch指标(CES)                  | 参见 [CES实例查询实例列表接口文档](https://cloud.tencent.com/document/api/845/30631)。`Namespace` 固定为`QCE/CES`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `InstanceId`，可选值为 `InstanceName`。CES实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CES&Region=$region&Action=DescribeInstances
CMQ消息队列CMQ(队列服务监控CMQ)                  | 参见 [CMQ实例查询实例列表接口文档](https://cloud.tencent.com/document/api/406/42624)。`Namespace` 固定为`QCE/CMQ`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `QueueName`，可选值为 `QueueId`。CMQ实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CMQ&Region=$region&Action=DescribeInstances
CMQTOPIC消息队列CMQTOPIC(主题订阅监控)                  | 参见 [CMQTOPIC实例查询实例列表接口文档](https://cloud.tencent.com/document/api/406/42637)。`Namespace` 固定为`QCE/CMQTOPIC`，`Action` 固定为`DescribeInstances`。`Region` 为地域参数，可以为特定的地域值，如 `ap-beijing`；也可以为变量值，如 `$region`。`InstanceAlias` 为实例的展示字段，默认为 `TopicName`，可选值为 `TopicId`。CMQTOPIC实例作为模板变量，同时支持单选和多选。 |   Namespace=QCE/CMQTOPIC&Region=$region&Action=DescribeInstances

## 创建变量

1. 进入某一 Dashboard 页面，单击右上角的 **齿轮** 图标，进入 Dashboard 设置页面；
2. 单击左侧 **Variables** 选项，进入变量设置页面，然后单击 `+ Add variable` 按钮，进入变量编辑页面；

## 编辑变量

- `Name` 变量名，一般为英文字符串，在 Dashboard 的编辑中使用该变量名替换原特定值。
- `Label` 变量的可见标签，用于更显式地描述变量名称。例如，`Name` 设置为 "region"，`Lable` 可设置为 "地区"。
- `Type` 变量查询方式，此处只能选择 `Query` 方式，即通过向数据源发送请求获取变量的列表。
- `Data source` 要获取变量列表的数据源，选择已配置的任意腾讯云监控数据源。
- `Refresh`  更新变量的方式，定义变量数据何时被更新。
- `Query` 变量查询语句，详情参见上述表格的变量示例和描述。

变量信息填写完毕，可在页面下方预览查询得到的变量值，如果与期望值相符，单击 `Add` 按钮添加变量。添加成功后，单击右侧菜单的 `Save` 保存至 Dashboard 配置。

以云服务器单机监控 Dashboard 为例，展示如何配置级联变量：地域变量、云服务器实例变量，如下图所示。

![](https://main.qcloudimg.com/raw/e6d84cf25f7972e5a253f354e75aaa6d.png)

![](https://main.qcloudimg.com/raw/b4d6fd28caf9e72672b4a541ecee214d.png)

>?如果想要监控多个实例，可勾选上图中的 `Mutli-value`。

## 应用变量
创建变量后，在 Dashboard 页面的左上角会展示变量选择框，可以切换变量值。变量有两种引用语法，`$varname` 和 `[[varname]]`。变量常用于 Panel 的查询语句中，以云服务器单机监控 Dashboard 为例，展示如何在查询中使用变量，如下图所示。此外，变量还可以应用在 Panel 标题、Text 文本面板等。

![](https://main.qcloudimg.com/raw/4f34b6e29cc4ad59c8168c51b1928044.png)

![](https://main.qcloudimg.com/raw/200266aa18796f3fdcc3d75793c2907c.png)
