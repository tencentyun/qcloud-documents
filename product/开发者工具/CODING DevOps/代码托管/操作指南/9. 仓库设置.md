本文为您详细介绍代码仓库的基础设置。

## 访问路径

进入任一【代码仓库】后，点击【设置】，即可看到当前仓库下的设置项。

![](https://help-assets.codehub.cn/enterprise/20210623162817.png)

## 基本设置

您可以在基本设置处修改您的仓库名称与图标。修改名称后会导致导致仓库的访问 URL 改变，在此之前的 URL 地址将失效。修改名称后需在您的本地仓库与新的地址相匹配。

```bash
git remote set-url origin https://e.coding.net/codingcorp/coding-help-generator/[new-repo-name].git
```

除此之外，您还可以在该页面添加仓库描述、查看代码仓库用量情况。如有必要，还可以进行归档、重置、删除代码仓库的操作。

![](https://help-assets.codehub.cn/enterprise/20210305161240.png)

**归档代码仓库**后，将无法继续访问和操作该仓库。若需解除归档，您可在 已归档 页进行操作。

**重置当前代码仓库**后，将重置仓库内的所有代码，包括代码分支、合并请求、代码版本。重置后数据无法恢复。代码仓库将会被重置为空仓库。

<font color=red><b>删除代码仓库</b></font>将会永久删除当前代码仓库内的所有代码，包括代码分支、合并请求、代码版本。删除后数据无法恢复。代码仓库将无法通过任何途径访问。

请谨慎实施上述操作。

---

## 部署公钥

部署公钥用以部署公钥，只针对本项目，可设置拥有只读或者读写权限（默认为只读）。

### 新建部署公钥

1.  点击【代码仓库】->【仓库设置】->【部署公钥】->【新建部署公钥】。

![](https://help-assets.codehub.cn/enterprise/20210623162937.png)

2.  填写公钥名称、公钥内容、公钥有效期、勾选是否授予推送权限，点击【新建】即可。

---

## 文件锁定

请点击阅读[详细说明](/docs//host/git/lock.html)。

---

## 分支设置

您可以在该设置页切换代码仓库的默认分支或设置[保护分支](/docs/repo/branch/protected.html)规则。将某一分支设置为保护分支后，当其他分支提出合并请求后，待项目内其他成员允许后方可自行合并分支。

编辑任一保护分支，进入规则设置界面进行更详细的设置。

![](https://help-assets.codehub.cn/enterprise/20210623164400.png)

-   **禁止强制推送：**默认打开。即使有 git push 的权限，也不允许通过 `git push -f` 的方式强制修改分支的提交历史。对于多人合作的分支，强烈建议打开此选项。它确保了只能通过增加新的提交来改变分支内容，而不是修改历史提交的方式来提交变更。

-   **开启状态检查：**开启之后，通过在 CI 中设置触发条件或设置代码扫描方案，待合并请求检查通过后才被允许合并，点击查看[《持续集成——触发规则》](/docs/ci/trigger.html)。

### 分支管理员

分支管理员为可选项。添加分支管理员后，所有合并请求需要分支管理员提前设置【允许合并】。分支管理员默认也受保护分支限制，需创建合并请求修改分支。若将其设置为【允许直接 Push】，分支管理员则可以直接修改分支。

进入分支管理中的保护分支设置，在弹窗中进行增减分支管理员，可以修改分支管理员的直接 Push 权限。

若成员没有权限（即保护分支的非分支管理员） push 至该分支，当其尝试 push 至该分支的时候，会得到如下错误提示：

![](https://help-assets.codehub.cn/enterprise/20210305135919.png)

所以，当你看到这个错误提示的时候，就知道是因为没有该保护分支权限而导致 push 失败了。

---

## 访问设置

您可以在此处勾选代码仓库的公开状态与是否允许 HTTPS 或 SSH 协议访问代码仓库。

![](https://help-assets.codehub.cn/enterprise/20210623161309.png)

---

## 合并请求

您可以在此处设置合并请求的基础设置、默认的合并方式与目标分支。

![](https://help-assets.codehub.cn/enterprise/20210623161455.png)

### 是否默认删除源分支

如果开启此项开关，那么当发起请求的源分支被并入至目标分之后，源分支会被自动删除。

### 合并请求时默认以 Fast-Forward 模式合并

如果是打开状态，那么当源分支是目标分支的直接上游时，合并会以 Fast-Forward 的模式进行，即源分支会直接指向目标分支，而不会产生一个合并提交。

### 合并方式选择

当源分支有多个提交的时候，我们会提供三种合并模式：

-   默认直接合并：会产生一个合并提交
-   默认 Squash 合并：会把源分支的多个提交合并成一个提交，用户可以取消这个行为
-   只能 Squash 合并：强制把源分支的多个提交合并成一个提交，用户不能取消

---

## 版本发布

您可以在此设置下切换新建版本发布时，目标分支会默认选择的分支。点击[此处](/docs/repo/release.html)查看版本发布的详细说明。

---

## 代码标签

此页面支持勾选是否允许删除或者强制推送 Git 标签。关闭此选项后，项目中的成员均不可删除或者通过强制推送修改 Git 标签，同时网页上的标签不提供删除功能。

### 保护标签

保护标签主要用于规范特定的成员进行创建，更新或删除标签等操作。开启保护标签后需设置标签管理员，仅管理员被允许在此标签下创建匹配标签规则的标签。

当设置了 `*-release` 为保护分支规则之后，非管理员用户通过 Git 推送标签 `xxx-release` 的时候有如下提示：

![](https://help-assets.codehub.cn/enterprise/20210305153450.png)

在 Web 端创建标签或新建版本时也同样会失败。

![](https://help-assets.codehub.cn/enterprise/20210305153646.png)

***使用场景举例：***

某团队使用标签作为触发 CI 构建的条件，即在生产分支中，通过推送 `v1.0-release` 字样的标签作为发布命令。

设置保护标签后，仅标签管理员能够创建此类型标签并完成发版动作，保持了代码仓库内各版本序列的整洁与规范。

---

