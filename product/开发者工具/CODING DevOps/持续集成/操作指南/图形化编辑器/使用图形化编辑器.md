本文为您详细介绍图形化编辑器和使用图形化编辑器。


## 理解图形化编辑器
图形化编辑器用来查看、编辑 Jenkinsfile （过程描述文件），而 Jenkinsfile 又是 Jenkins Pipeline （流水线）的代码文本载体，所以在理解图形化编辑器之前，您需要先理解流水线的几个重要概念。
>? 过程描述文件支持声明式（Declarative）和脚本式（Script）两种语法。因为声明式（Declarative）语法是 Jenkins 更新支持的特性，所以本篇主要聚焦于声明式文件的语法规则。


### 流水线概念

#### 流水线（Pipeline）
流水线是可自定义的工作模型，它定义了交付软件的完整流程，一般包含构建、测试和部署等阶段。

#### 执行环境（Agent）
执行环境描述了整个流水线执行过程或者某个阶段的执行环境，必须出现在描述文件的开头或者每一个阶段里。

| 是否必须   | 是                                         |
| ---------- | ------------------------------------------ |
| 参数列表   | 见下文                                     |
| 允许的位置 | 必须出现在描述文件的开头或者每一个阶段里 |

#### 阶段（Stage）
一个阶段定义了一系列紧密相关的步骤。每个阶段在整条流水线中各自承担了独立、明确的责任。例如“构建阶段”、“测试阶段”或“部署阶段”。通常来讲，所有的实际构建过程都放置在阶段里面。

| 是否必须   | 至少一个                                   |
| ---------- | ------------------------------------------ |
| 参数列表   | 一个强制的字符串类型参数，用以指明阶段名称 |
| 允许的位置 | 在阶段（stage）区块内部                  |

#### 阶段列表（Stages）
阶段列表包含了一系列的阶段，一个阶段列表最少包含一个阶段。流水线里必须要有且仅有一个阶段列表。

| 是否必须   | 是                                    |
| ---------- | ------------------------------------- |
| 参数列表   | 无                                    |
| 允许的位置 | 在 流水线（pipeline）内只能出现一次 |

#### 步骤列表（Steps）
步骤列表描述了一个阶段内具体要做什么事，具体要执行什么命令。例如有一个步骤（step）需要系统打印一条“构建中...”的消息，即执行命令echo '构建中...'。

| 是否必须   | 是                           |
| ---------- | ---------------------------- |
| 参数列表   | 无                           |
| 允许的位置 | 在每一个 阶段（stage）块内 |

#### 并行（Parallel）
并行用来声明一些并行执行的阶段，通常适用于阶段与阶段之间不存在依赖关系的情况下，用来加快执行速度。注意任何含并行区块下的阶段不能再设置执行环境。

#### 脚本（Script）
执行一段脚本作为一个步骤。平时一般不用，有时需要“应急出口”才派上用场。

### 举例
文本编辑器视图下的过程描述文件
```
pipeline {
  agent any
  stages {
    stage('检出') {
      steps {
        sh 'ci-init'
        checkout([$class: 'GitSCM', branches: [[name: env.GIT_BUILD_REF]],
                                    userRemoteConfigs: [[url: env.GIT_REPO_URL]]])
      }
    }
    stage('构建') {
      steps {
        echo '构建中...'
        sh 'make'
        echo '构建完成.'
      }
    }
    stage('测试') {
      steps {
        echo '单元测试中...'
        sh 'make check'
        junit 'reports/**/*.xml'
        echo '单元测试完成.'
      }
    }
    stage('部署') {
      steps {
        echo '部署中...'
        sh 'make publish'
        echo '部署完成'
      }
    }
  }
}
```

### 图形化编辑器视图对比文本编辑器视图
>?下列图片中，左侧为图形化编辑器视图，右侧为文本编辑器视图。

![](https://main.qcloudimg.com/raw/90a4166fb4f104b2680d95c99e2629c8.png)
![](https://main.qcloudimg.com/raw/d4dcfa29584ae4416082a0c8a876da8b.png)
![](https://main.qcloudimg.com/raw/efb7c0dfb833ff7ff0b4acf6824da4b4.png)
![](https://main.qcloudimg.com/raw/3cda2b465bbbaff9c5831cebef958dc0.png)
![](https://main.qcloudimg.com/raw/91de5abced12af374aa6033202c56fbc.png)


## 操作步骤
### 步骤1：进入图形化编辑器界面

1. 选择左侧菜单栏**持续集成** > **job 列表**，开始创建持续集成任务。
2. 开始配置持续集成过程即可进入图形化编辑器界面。详情请参见 [使用持续集成](https://cloud.tencent.com/document/product/1115/36883)。

### 步骤2：构建过程设置

单击**开始**，在编辑框右侧会弹出配置栏。在配置栏，可以选择“构建基础环境”，也可以增加“环境变量”。
![](https://main.qcloudimg.com/raw/b225f92b703801aae4ab392c04aac9da.png)
>? 此处设置的环境变量会储存在 Jenkinsfile 中。

### 步骤3：配置阶段

选中任一阶段，在编辑框右侧会弹出配置栏。在配置栏，可以对当前阶段进行命名、编排步骤以及删除操作。
![](https://main.qcloudimg.com/raw/9cdd52d1bac7985b6ee8059511a21445.png)
>?通常模板第一个阶段“检出”是必要的，这里无需改动。这一阶段负责将当前项目的代码仓库检出到当前持续集成的环境下，后面一系列的构建、测试等操作都是对这里检出的代码来进行的。

### 步骤4：编辑步骤
1. 单击右侧配置栏里任一步骤，即可进行步骤的具体编辑。
2. 例如在“构建”的配置栏中，单击**打印消息**，即可看到“打印消息”这一类别步骤下的具体编辑界面。
3. 输入想要打印的消息，例如用“构建中...”，提醒自己这是“构建”阶段的开始。
4. 单击**保存**即可，系统将返回配置阶段的界面。
5. 当然，也可以单击**删除此步骤**，来进行删除步骤的操作。
![](https://main.qcloudimg.com/raw/62c8a3c1cb8a25203bee447ec894b6c3.png)

### 步骤5：增加步骤
选中任一步骤，单击右侧配置栏里的**增加步骤**，即可看到“版本控制”、“构建过程”和“其他”三个分类，它们各自有若干个不同类型的具体步骤，这些步骤提供不同的能力，对其进行编辑的地方也截然不同，有的步骤还可以增加子步骤。详情请参见 [图形化编辑器可用步骤说明](https://cloud.tencent.com/document/product/1115/36885)。
![](https://main.qcloudimg.com/raw/21c7d96d08f6b943d058cf80cd330b69.png)


