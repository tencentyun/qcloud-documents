This document describes how to initialize the SDK and call the login API.
## Downloading Source Code
You can download the complete demo code used in this document. 
[Download Demo Code](http://dldir1.qq.com/hudongzhibo/ILiveSDK/Demo/iOS/demo_login.zip)

## Prerequisites
You must have activated the service and created an application at the [TRTC official website](https://cloud.tencent.com/product/trtc).

## Concepts
 - [TRTC application](https://cloud.tencent.com/document/product/647/16792#.E5.AE.9E.E6.97.B6.E9.9F.B3.E8.A7.86.E9.A2.91.E5.BA.94.E7.94.A8)
 - [Application ID( sdkAppId )](https://cloud.tencent.com/document/product/647/16792#.E5.BA.94.E7.94.A8.E6.A0.87.E8.AF.86.EF.BC.88-sdkappid-.EF.BC.89)
 - [Account type( accountType )](https://cloud.tencent.com/document/product/647/16792#.E5.B8.90.E5.8F.B7.E7.B1.BB.E5.9E.8B.EF.BC.88-accounttype-.EF.BC.89)
 - [User ID( userId )](https://cloud.tencent.com/document/product/647/16792#.E7.94.A8.E6.88.B7.E6.A0.87.E8.AF.86.EF.BC.88-userId-.EF.BC.89)
 - [User signature( userSig )](https://cloud.tencent.com/document/product/647/16792#.E7.94.A8.E6.88.B7.E7.AD.BE.E5.90.8D.EF.BC.88-usersig-.EF.BC.89)

## Obtaining userSig
Each user at Client is provided with a userSig. It is valid for three months upon generation. If the userSig expires, the user cannot log in to TRTC and will receive the error code 8051. At this time, the user should generate a new userSig to log in to TRTC.

```objc
ERR_EXPIRE              = 8051,    //Ticket expired (Need to update ticket userSig)
```

> Note: For more information on how to obtain a userSig, see [User Authentication](https://cloud.tencent.com/document/product/647/16792#.E7.94.A8.E6.88.B7.E7.AD.BE.E5.90.8D.EF.BC.88-usersig-.EF.BC.89). During debugging, you can directly use the development tools in the console to generate a userSig.


## Initializing iLiveSDK

It is recommended to initialize the SDK when you start the application. The SDKAppId and AccountType generated after creation of the application in the Tencent Cloud backend are required for initialization. The sample code is as follows:
```objc
> AppDelegate.m

//Import header files
#import <ILiveSDK/ILiveSDK.h>

//Define SDKAppId and AccountType
static  const int kSDKAppID = SDKAppId generated after creation of the application at backend;
static  const int kAccountType = AccountType generated after creation of the application at backend;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    
    // Initialize the SDK
    [[ILiveSDK getInstance] initSdk:kSDKAppID accountType:kAccountType];
    
    return YES;
}

```

## Calling the Login API

The login API is located in the ILiveLoginManager, you need to import it before calling. The calling method is as follows:
```
- (void)iLiveLogin:(NSString *)uid sig:(NSString *)sig succ:(TCIVoidBlock)succ failed:(TCIErrorBlock)failed;
```

Enter the userId and userSig generated by the development tools at backend:
```objc

> ViewController.m

//Import header files
#import <ILiveSDK/ILiveLoginManager.h>

- (void)viewDidLoad {
    [super viewDidLoad];

    // Set userId and userSig
    self.userIdTF.text = @"use's userId";
    self.userSigTF.text = @"usr-generated userSig";
}

//Click the login button
- (IBAction)onLogin:(id)sender {
    //Log in to the SDK
    [[ILiveLoginManager getInstance] iLiveLogin:self.userIdTF.text sig:self.userSigTF.text succ:^{
        NSLog(@"Login successful!") ;
    } failed:^(NSString *module, int errId, NSString *errMsg) {
        NSLog(@"errId:%d, errMsg:%@",errId, errMsg);
    }];
}
```
## Listening for User Status
Users may be forcibly logged out due to repeated login or expired userSig. To enable the application to listen for the status, do the following:

Set the calling method for the observer:
```objc
[[ILiveSDK getInstance] setUserStatusListener:self];
```
The observer complies with the TIMUserStatusListener protocol and implements the following methods:
```objc
/**
 * Notification of forced logout
 */
- (void)onForceOffline;

/**
 * The userSig expired (Obtain a new userSig to log in)
 */
- (void)onUserSigExpired;
```
>**Note:**
> In the sample application, the storyboard is used to build a simple interface. In practical applications, customers need to place the login code in the right place according to their own business logic.
> The above code is only for demonstration purposes. In practice, a customer has an independent account. So the login process is as follows:
>
> Enter your user name and password on the login page displayed on the client. After your account is verified, a userSig is generated and returned to the client via the TRTC SDK. The client uses the user name and userSig to call the login API of ILiveSDK.
	
Run the application. When a prompt saying "Login successful" appears, you have successfully logged in to ILiveSDK.


## Email
If you have any questions, send us an email to trtcfb@qq.com.

