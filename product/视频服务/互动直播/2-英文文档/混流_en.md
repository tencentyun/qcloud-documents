


# Stream Mixing

## What is Stream Mixing
Stream mixing means multiple video streams are mixed into a new video stream (with which the original video stream can be replaced).
![](https://mc.qcloudimg.com/static/img/20dcad307192885fca4fd604b1fafad0/t610.png)

## How to Mix Streams
Users who are using Tencent Video Cloud businesses (including LVB, ILVB) can mix the streams on the cloud through [API](https://cloud.tencent.com/document/product/267/8832).

## Stream ID
The basis of stream mixing is the video stream. For ILVB, LVB code is video stream ID.

When a non-interactive broadcasting is enabled automatically, all the videos in the room (VJs and viewers who join broadcasting) generate corresponding LVB video streams.
```
LVB Code=[BIZID]_MD5 (Room ID_User ID_Data Type)

Data type of camera is main
Data type of screen sharing is aux

Playback URL=Transmission protocol://BIZID.liveplay.myqcloud.com/live/LVB code[.format]
```
For more information, please see [Non-interactive Broadcasting under LVB Code Mode](https://cloud.tencent.com/document/product/268/8560).

## Stream Mixing API
The stream mixing API is actually a Post request based on the HTTP protocol.

### Request Address
```
Server Address: http://fcgi.video.qcloud.com/common_access
```

### URL Parameters

|Parameter | Description | Type | Note | Required|
|---------|---------|---------|---------|---------|
|appid | Customer ID | int | Enter LVB APPID (not sdkappid), used for differentiating the identities of different customers. | Y|
|interface | API name | string | Stream mixing API name is always entered with: Mix_Stream | Y|
|t | Validity period | int | UNIX timestamp, that is, the number of seconds that have elapsed since January 1, 1970 (Midnight in UTC/GMT). This field indicates the expiration time of request. You need to add 60 seconds of offset to the current time (in sec) | Y|
|sign | Security signature | string | sign=MD5 (key + t), that is to calculate the MD5 value by concatenating the strings of the encryption key and t. The encryption key here is the API authentication key you set in the Tencent Cloud LVB Console | Y|

### Post Content

Post is composed of stream mixing parameters in JSON format. For more information, please see [API](https://cloud.tencent.com/document/product/267/8832).

The important parameters are:

| Parameter | Description | Type | Note | Required|
|--:|:--:|:--:|:--:|:--:|
|output_stream_id | ID of output stream for stream mixing | string | Specified output stream ID | Y|
|output_stream_type | Type of output stream for stream mixing | int | Specified output stream type. Enter 0 if the output stream is a stream in the list of input streams. Enter 1 if the output stream is new and not included in the list of input streams. Default is 0 if this is left empty. | N|
|mix_stream_template_id | Stream mixing template | int | Enter template ID. Available values for two input sources are: 10, 20, 30, 40; three input sources: 310, 390, 391; four input sources: 410; five input sources: 510, 590; and six input sources: 610. Default is 0 if this is left empty. | N|

### Stream Mixing Configuration Example
#### Mixing Two Video Streams into A New Video Stream
The stream ID of a new video is the LVB code specified by users, which is a string of no more than 100 bytes and does not conflict with the LVB code already assigned.

In order to conform to standards and avoid conflicts with other users, the format is defined as follows:
```
[BIZID]_MIX_[Understream ID]_[Number of Mixed Streams]_[Timestamp]
```
>**Note:**
- BIZID: Business ID (you can view it in Tencent Cloud backend [LVB Management](https://console.cloud.tencent.com/live/livecodemanage)).
- MIX: Fixed prefix, indicating that the stream is generated through stream mixing.
- Understream ID: The stream ID of stream mixing understeram (background mainstream). If it exceeds 80 bytes, only the first 80 bytes are used.
- Number of mixed streams: If the video stream is generated by mixing two video streams, the number is 2, and so on.
- Timestamp: The number of seconds since January 1, 1970.
```
Mix A and B into a new stream C
output_stream_id  C
output_stream_type 1
```

#### Mixing Two Video Streams and Replacing the Original Video Stream
```
Mix A and B into a new stream and replace A with it
output_stream_id  A
output_stream_type 0
```



