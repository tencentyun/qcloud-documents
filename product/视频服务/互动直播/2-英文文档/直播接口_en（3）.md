## ILVB Flowchart with ILiveSDK

![](http://mc.qcloudimg.com/static/img/06d2fb5027be53492249d4b81bd2f5a5/image.png)

## Initialize ILiveSDK
Initialize ILiveSDK when the application starts.

| API | Description |
|---|---|
|initSdk: accountType: | Initialize ILiveSDK internal class (AppId is indicated). The initialization of IMSDK is included internally. |

| Parameter Type | Parameter Name | Description |
|---|---|---|
| int | appId | appid of business side |
| int | accountType | accountType of business side |

Example:
```
[[ILiveSDK getInstance] initSdk:SuixinboSdkAppId accountType:SuixinboAccountType];
```

## Account Login

### Hosted mode
Hosted mode: user account system is hosted to Tencent Cloud. [Click here for more information](https://cloud.tencent.com/doc/product/269/1509).

| API | Description |
|---|---|
|tlsLogin: pwd: succ: failed: | Log in to Tencent Cloud backend in hosted mode. |

| Parameter Type | Parameter Name | Description |
|---|---|---|
| NSString | uid | Account registered by user in hosted mode. |
| NSString | pwd | Password registered by user in hosted mode. |
| TCIVoidBlock | succ | "Logged in successfully" callback. |
| TCIErrorBlock | failed | "Login failed" callback. |

Example:
```
[[ILiveLoginManager getInstance] tlsLogin:@"Account ID id" pwd:@" Login password" succ:^{
    NSLog(@"Logged in successfully");
} failed:^(NSString *moudle, int errId, NSString *errMsg) {
    NSLog(@"Login failed");
}];
```

### Standalone mode
Standalone mode: The user account system is maintained by the user's own server. In standalone mode, the user must obtain the Signature generated by the business backend from the client before logging in to Tencent Cloud backend. [Click here for more information](https://cloud.tencent.com/doc/product/269/1508).

| API | Description |
|---|---|
| iLiveLogin: sig: succ: failed: | Log in to Tencent Cloud backend in standalone mode. |

| Parameter Type | Parameter Name | Description |
|---|---|---|
| NSString | uid | Account registered by user in standalone mode. |
| NSString | sig | The signature obtained by the user at the business backend. |
| TCIVoidBlock | succ | "Logged in successfully" callback. |
| TCIErrorBlock | failed | "Login failed" callback. |

Example:
```
[[ILiveLoginManager getInstance] iLiveLogin:@"Account ID id" sig:@" Signature string" succ:^{
    NSLog(@"Logged in successfully");
} failed:^(NSString *moudle, int errId, NSString *errMsg) {
    NSLog(@"Login failed");
}];
```

## Create a Room (Join a Room)

### VJ creates a room

| API | Description |
|---|---|
| createRoom: option: succ: failed: | VJ creates a live room, with local view being automatically rendered, and starts broadcasting. |

| Parameter Type | Parameter Name | Description |
|---|---|---|
| int | roomId | Room number. Generated by the business backend. Its uniqueness should be ensured. |
| ILiveRoomOption | option | Options configured when VJ creates a room. You can use API defaultHostLiveOption to obtain the default configurations of VJ. |
| TCIVoidBlock | succ | "Room created successfully" callback. |
| TCIErrorBlock | failed | "Failed to create room" callback. |

Example:
```
//If using the beauty filter sdk, you need to set the local view proxy. For more information on how to implement the feature, please see LiveWindowController+Beauty.m
//[[ILiveRoomManager getInstance] setLocalVideoDelegate:self];

//It is important for developers to understand the various parameter configurations of option in detail
ILiveRoomOption *option = [ILiveRoomOption defaultHostLiveOption];
option.controlRole = @"user";           //The role name under the developer's own account system is filled here
option.roomDisconnectListener = self;   //The callback notification that the room loses the connection
option.memberStatusListener = self;     //The event callback about the users of the room
__weak typeof(self) ws = self;
[[ILiveRoomManager getInstance] createRoom:(int)_item.info.roomnum option:option succ:^{
    NSLog(@"Room created successfully");
    //To set the microphone volume, you need to set the following two proxies. For more information on how to implement the feature, please see the file LiveWindowController+Audio.m of demo
    [[[ILiveSDK getInstance] getAVContext].audioCtrl registerAudioDataCallback:QAVAudioDataSource_VoiceDispose];
    [[[ILiveSDK getInstance] getAVContext].audioCtrl registerAudioDataCallback:QAVAudioDataSource_NetStream];
} failed:^(NSString *module, int errId, NSString *errMsg) {
    NSLog(@"Failed to create room, module=%@,code=%d,msg=%@",module,errId,errMsg);
}];
```

### Viewer joins the room

| API | Description |
|---|---|
| joinRoom: option: succ: failed: | Viewer joins the room, with remote view being pulled and rendered automatically, and starts watching the broadcasting. |

| Parameter Type | Parameter Name | Description |
|---|---|---|
| int | roomId | Room number. Generated by the business backend. Its uniqueness should be ensured. |
| ILiveRoomOption | option | Options configured when viewer joins a room. You can use API defaultGuestLiveOption to obtain the default configurations of viewer. |
| TCIVoidBlock | succ | "Joined the room successfully" callback. |
| TCIErrorBlock | failed | "Failed to join the room" callback. |

Example:
```
//For the meaning of the parameters, please see "Create a room"
//After users successfully join the room, if the the camera is enabled, the onEndpointsUpdateInfo callback will be received, and the users can add the rendered view in the onEndpointsUpdateInfo callback
ILiveRoomOption *option = [ILiveRoomOption defaultGuestLiveOption];
option.controlRole = _item.info.roleName;
option.memberStatusListener = self;
[[ILiveRoomManager getInstance] joinRoom:(int)_item.info.roomnum option:option succ:^{
    NSLog(@"Joined the room successfully");
} failed:^(NSString *module, int errId, NSString *errMsg) {
    NSLog(@"Failed to join the room. M=%@,errId=%d,errMsg=%@",module,errId,errMsg);
}];
```

If the above steps are correctly performed, the VJ starts broadcasting and viewers watches the broadcasting.
