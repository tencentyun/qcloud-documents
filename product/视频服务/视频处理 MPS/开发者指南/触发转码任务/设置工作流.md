工作流设置主要包含以下几部分：
- 触发与输出的 Bucket 及 Path 配置。
- 转码、截图（动图和雪碧图）、水印等任务配置。
- 事件通知 CMQ 地址设置。
 
在任务配置部分需要使用已创建的各类型模板，全部参数模板可在 [视频处理控制台 - 模板设置](https://console.cloud.tencent.com/mps/templates) 中查询，新建自定义参数模板请参见 [模板参数说明](https://cloud.tencent.com/document/product/862/37037)。

## 工作流配置说明

### <span id ="p1">触发与输出的 Bucket 及 Path 配置

- 触发 Bucket：源文件所在的 Bucket，您可自行选择对应区域的 Bucket。
- 触发 Bucket 目录：需要触发转码的 Bucket 目录名称。默认为根目录，即整个 Bucket 所有目录下的文件都会触发转码任务。**如果设置，则只会对该目录下的文件发起转码任务**。
- 输出 Bucket：用于存放转码后文件的 Bucket 名称，**目前仅支持同一个区域的 Bucket**。
- 输出 Bucket 目录：用于存放转码后文件的 Bucket 目录名称。缺省情况下，输出文件所在路径与输入文件保持一致。这时，需要确保输出文件名与源文件名不同，否则源文件会被覆盖。如果设置，则输出文档会被存放在该目录。
  >? 如果在各任务配置中也单独设置了输出路径，则以该设置为准。

### 事件通知配置
视频处理服务使用 CMQ 中的队列模型作为事件通知模型。队列模型是一种一端写入另一端读取的消息模型，其中写入者称为生产者，从队列读取者称为消费者。
在该模型中，同一个消息只能被消费一次。最简单的情况下，只有一个生产者和一个消费者。复杂情况下，可以同时有多个生产者和多个消费者，在多个消费者存在的情况下，每个消费者只能获取到全部消息中的部分消息，每个消费者获取的消息数量相对平均。
>! 区域当前只支持 cos v4 版本，即上海：'sh'、广州：'gz'、成都：'cd'、重庆：'cq'、北京：'bj'等。

CMQ 更多信息请参见 [消息队列概述](https://cloud.tencent.com/document/product/406/4541)。

### 转码任务配置
转码任务配置包括视频转码、音频转码及打水印等任务，选择相应的转码模板即可。

**输出路径设置说明**

| 路径类型 | 说明 | 配置示例 | 输出示例 |
| --- | --- | --- | ---- |
| 根目录 | 忽略 [触发与输出 Bucket & Path 配置](#p1) 中所设置的“输出目录” | 输出目录：<br>`/output/` <br> 输出路径：<br>`/transcode/{inputName}_{definition}.{format}`  |  文件输出：<br>`/transcode/testvideo_20.mp4` |
| 相对目录 | 使用 [触发与输出 Bucket & Path 配置](#p1) 中所设置的“输出目录”作为目录前缀 | 输出目录：<br>`/output/` <br> 输出路径：<br>`transcode/{inputName}_{definition}.{format}` | 文件输出：<br>`/output/transcode/testvideo_20.mp4` |

### 截图任务配置
截图任务配置包括采样截图、时间点截图和雪碧图等任务类型。
- 采样截图：按固定时间间隔截图，包括固定时间和固定时间百分比的类型，如间隔1s或1%截图一张。
- 时间点截图：在固定时间点进行截图，如在起始位置00:00:00、5分钟处00:05:00、15分30秒处00:15:30，截取三张图片。
- 雪碧图：将多张截图合并到一张大的图片，每一张小图片可进行宽高设置。

### 转动图任务配置
转动图是将视频文件进行截图，然后封装到动态图片，包括 GIF 和 WEBP 等格式，可以设置转动图的起始时间和截止时间。
