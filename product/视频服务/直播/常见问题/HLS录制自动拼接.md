
### 为什么需要视频拼接？
直播转点播是直播活动常见的应用场景，即将直播流录制下来，供点播回看。直播转点播依赖于直播录制功能，直播文件录制完成之后会生成文件 URL，发布文件 URL 即可供点播回看。当前录制机制：开始推流则录制开始，推流中断则录制结束，生成一个录制文件以及文件 URL。
目前，由于网络不稳定或主播端异常等因素导致录制中断，一场直播活动往往可能被录制成多个文件，如果一场直播活动录制成多个点播文件，意味着要发布多个点播 URL 终端用户才能看到完整的视频文件，这显然不合理，所以需要文件拼接将多个录制文件拼接成一个完整的文件再发布。

### 为什么需要自动拼接功能？
腾讯云直播服务目前已经有文件拼接功能，不过需要手动调用接口实现，过程冗长且接入成本高，为了使拼接更加便捷高效，直播提供 HLS 自动拼接功能。

### 自动拼接功能描述
当主播端异常推流中断时，只要在规定时间内继续推流，录制模块就会继续录制，而不是重新开始录制，推流结束后（在设定时间内没有推流）产生的录制文件是一个完整的录制文件，而非多个片段。

#### 功能说明
1. 文件可自动拼接要求
	- 录制文件类型必须是 HLS，即拼接源文件为 HLS，目前不支持 MP4 和 FLV 录制文件的拼接；
	- 拼接的目标文件仅支持 HLS 文件类型；
	- 前后两次推流音视频要求音频需要编码类型、采样率、声道数保持一致，视频需要编码类型一致，否则可能存在播放器兼容问题；
	- 前后两次推流视频码率和分辨率可以不同。
2. 录制中断次数无限制
如果推流中断，只要在规定时间内推流，则会继续录制，不管中断几次均是如此。 
3. 中断时间可配置
可配置自动拼接支持的推流中断时长。目前时间配置需限制在 5 分钟以内。   
4. 录制文件 URL
录制文件 URL 为 m3u8 文件的 URL，推流每中断一次产生一个 URL，m3u8 URL 内容为本次中断之前视频内容，最后推流结束产生的 m3u8 URL 即为全部视频内容。 
5. 推流中断不自动拼接情况
正常情况下开启自动拼接功能，在规定之间内推流中断后再次推流会自动拼接，但如果是调用了禁播接口导致推流中断则不会自动拼接，再次推流会重新开始录制。
6. 录制文件 URL 获取
录制文件的 URL 会通过回调的方式返回给您，目前推流每中断一次，您会收到一条录制 URL 的回调，此时请注意：为了保证您发布的点播文件为完整视频内容，建议在配置的中断时间内没有再次推流，再发布最后一条回调 URL。
7. 文件展示
同一般的录制文件自动拼接后的文件也会展示在点播控制台。
