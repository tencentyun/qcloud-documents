## Interfacing Process
- **Short video publishing**:
Upload an MP4 file to Tencent Video Cloud, and get the URL for online watching. Tencent Video Cloud supports the nearby scheduling, instant broadcasting, dynamic acceleration, overseas access and other requests of video watching, so as to ensure a high-quality watching experience.
![](//mc.qcloudimg.com/static/img/283c8d7fe0a5a316097ae687a2bf6c5a/image.png)

* Step 1: Use the API TXUGCRecord to record a short video. Once finished, a short video file (MP4) is returned to the user.

* Step 2: Your App applies for an upload signature from your business server, which is a license that allows the App to upload MP4 file to Tencent Cloud Video Distribution Platform. To ensure security, these upload signatures are issued by your business server and cannot be generated by the terminal App.

* Step 3: Use the API TXUGCPublish to publish video. Once successful, the SDK returns the playback URL to you.

## Note

- App must not include the SecretID and SecretKey used to calculate the upload signature in its client code. Exposing these critical information may cause potential security issues, such as allowing attackers to use your traffic and storage service for free once they have cracked your App and obtained the information.
- The proper practice is to use the SecretID and SecretKey on your server to generate an one-off upload signature, and then provide the signature to the App. Generally, servers are difficult to crack, so this can ensure security.
- Be sure to pass the correct Signature field when you publish short videos, or else the publish operation may fail. 

## Interfacing
![](https://main.qcloudimg.com/raw/b3023cee1814e777e8458aa9b1047cbb.png)

### 1. Select Video
You can record or edit videos described in the previous documents, and then upload the generated video. Also, you can upload a local video in your mobile phone.
### 2. Compress Video
Compress the selected video using the API TXVideoEditer.generateVideo (int videoCompressed, String videoOutputPath) which supports 4 resolutions. Compression with custom bitrate will be available soon.
### 3. Publish Video
App needs to get a valid upload signature for short-term use to publish the MP4 file generated in the previous step to Tencent Cloud. For more information on upload signature, please see [Signature Distribution](http://tapd.oa.com/Qcloud_MLVB/markdown_wikis/edit/Android%2525E7%2525AB%2525AF%2525E4%2525B8%25258A%2525E4%2525BC%2525A0/0).
TXUGCPublish (located in TXUGCPublish.h) is used to publish MP4 files onto the Tencent Cloud Video Distribution Platform in order to satisfy video playback demands such as closest location scheduling, instant video launching, dynamic acceleration and overseas access.

```ObjectiveC
TXPublishParam * param = [[TXPublishParam alloc] init];

param.signature = _signature;                                // You need to enter the upload signature calculated in step 4.

// You can obtain the path of the generated video file from the onRecordComplete callback of TXVideoRecordListener.
param.videoPath = _videoPath;  
// Path of the first-frame preview image of the generated video file. You can specify a path or call the cover path specified by startRecord, and save the UIImage obtained from the onRecordComplete callback of TXVideoRecordListener under the specified path. It can be configured as nil.
param.coverPath = _coverPath; 

TXUGCPublish *_ugcPublish = [[TXUGCPublish alloc] init];
// Breakpoint resume is used during file publishing by default.
_ugcPublish.delegate = self;                                 //SetTXVideoPublishListener  Callback
[_ugcPublish publishVideo:param];
``` 

The feedback of the publishing process and result is provided by the API TXVideoPublishListener (defined in the TXUGCPublishListener.h header file):

- onPublishProgress provides feedback of the file publishing progress. The parameter uploadBytes represents the bytes already uploaded, and the parameter totalBytes represents the total bytes to be uploaded.
```ObjectiveC 
@optional
-(void) onPublishProgress:(NSInteger)uploadBytes totalBytes: (NSInteger)totalBytes;
```
- onPublishComplete provides the feedback of publishing result. The fields errCode and descMsg of TXPublishResult indicate error code and error message. videoURL is the VOD address of the short video. coverURL is the cloud storage address of the video cover image. videoId is the cloud storage ID of the video file, which can be used to call VOD [Server APIs](https://cloud.tencent.com/document/product/266/1965).
``` C 
@optional
-(void) onPublishComplete:(TXPublishResult*)result;
```
- Publish Result
Confirm the publishing result of short videos via [Error Codes](https://cloud.tencent.com/document/product/584/10176).


### 4. Play Video

- After the video is uploaded successfully in step 3, the video's fileId, playback URL and cover URL are returned. Play the video by directly passing fileId or URL in [VOD Player](http://tapd.oa.com/Qcloud_MLVB/markdown_wikis/view/#1010146251006933701).

