## 概述
腾讯云视立方·音视频终端引擎提供了**终端极速高清插件**，该插件可在终端实现视频播放的超分后处理，实现降本增效。

* 成本优化：在云端将高分辨率视频转为低分辨率视频进行传输以降低成本，然后在终端进行超分处理以保证视频播放画质。
* 画质提升：将低分辨率的视频转化为高分辨率视频，提升视频播放清晰度，实现画质优化。

>!
>- 目前仅腾讯云视立方·播放器SDK（Player）移动端9.5.29009以上版本可使用该插件。
>- 使用终端极速高清插件需要申请 License，当前提供免费的测试版 License，获取方式请参见 [终端极速高清 License](https://cloud.tencent.com/document/product/1449/68750)。

## 效果和功耗

开启终端极速高清前后效果对比：
<img style="width:500px; max-width: inherit;" src="https://qcloudimg.tencent-cloud.cn/raw/65767a90a82683bf7c68716c5bd96e97.png" />

开启终端极速高清后，近景处路面碎石、远方树叶等清晰度均得到提升。

运行终端极速高清插件后，电流提升小于100mA，额外耗电几乎可以忽略。

## 集成步骤

### 步骤1：获取插件
1. 终端极速高清插件（下文简称“插件”）作为独立的 SDK 提供，您可以根据项目需求进行集成，[单击下载](https://mediacloud-76607.gzc.vod.tencent-cloud.com/TXCTbPlayer/TXCTbPlayerSDK/Release/Android/plugins/monet/plugin_monet_release_latest.zip) 最新版本的插件。
2. 将下载的插件 plugin_monet-release-v.x.x.x.aar 或 TXCMonetPlugin-release-v.x.x.x.framework（x.x.x. 为版本号）集成到工程，启动播放器实例后，宿主会自动加载插件。

### 步骤2：初始化 License
1. 使用终端极速高清插件需要申请 License，当前提供免费的测试版 License，获取方式请参见 [终端极速高清License](https://cloud.tencent.com/document/product/1449/68750)。
2. 获取到 License 后，通过下面的接口进行初始化 License：
**Android:**
```java
String licenceUrl = "填入您购买的license 的url";
String licenseKey = "填入您购买的license 的key"
TXLiveBase.getInstance().setLicence(context, licenceUrl, licenseKey);
```
**iOS:**
```iOS
NSString *licenceURL = "填入您购买的license 的url";
NSString *licenseKey = "填入您购买的license 的key"
[TXLiveBase setLicenceURL:licenceURL key:licenseKey];
```


### 步骤3：开启或关闭终端极速高清能力

启动播放后（建议在收到 TXLiveConstants.PLAY_EVT_VOD_PLAY_PREPARED 事件后调用），可以通过 TXVodPlayer 下面的接口，进行开启和关闭超分：
**Android:**
```java
@Override
public void onPlayEvent(TXVodPlayer player, int event, Bundle param) {
    if (event == TXLiveConstants.PLAY_EVT_VOD_PLAY_PREPARED) {
        //开启终端极速高清   
        mVodPlayer.setStringOption("PARAM_SUPER_RESOLUTION_TYPE", 1);
    }

}

//关闭终端极速高清
mVodPlayer.setStringOption("PARAM_SUPER_RESOLUTION_TYPE", 0);
```
**iOS:**
```iOS
-(void) onPlayEvent:(TXVodPlayer *)player event:(int)EvtID withParam:(NSDictionary*)param
{
		if (EvtID == PLAY_EVT_VOD_PLAY_PREPARED) {
			//开启超分
 			NSMutableDictionary *extInfoMap = [NSMutableDictionary dictionary];
 			[extInfoMap setObject:@(1) forKey:@"PARAM_SUPER_RESOLUTION_TYPE"];
 			[_txVodPlayer setExtentOptionInfo:extInfoMap];
		}
}

//关闭超分：
 [extInfoMap setObject:@(0) forKey:@"PARAM_SUPER_RESOLUTION_TYPE"];
```

### 插件加载配置

终端极速高清插件加入到工程后，默认会自动加载， 如果您不希望播放器加载该插件，可以通过下面的方式关闭：

**Android:**
```java
TXVodPlayConfig playConfig = new TXVodPlayConfig();
playConfig.mEnableRenderProcess = false;
mVodPlayer.setConfig(playConfig);
```
**iOS:**
```
TXVodPlayConfig *playConfig = [[TXVodPlayConfig alloc] init];
playConfig.enableRenderProcess = NO;
[_txVodPlayer setConfig:playConfig];
```

### 设置混淆规则

在 proguard-rules.pro 文件，将终端极速高清相关类加入不混淆名单（iOS 默认无）：
```xml
-keep class com.tencent.** { *; }
```

### 日志查看

**Android:**
1. 终端极速高清插件加载成功日志：
D/HostEngine-PluginManger: [loadPlugin], succeed loading pluginId=2 ,pluginClazzName=com.tencent.liteav.monet.MonetPlugin
2. 开启终端极速高清功能成功开启日志：
 D/MonetPlugin-Process: [updateModule], moduleType=1
3. 如果出现下面的日志，表示签发的 License 不合法：
E/MonetPlugin-Process: [updateModule], error, reason = license is invalid!!

**iOS：**

1. 终端极速高清插件加载成功日志：
[PluginsSDK] plugin config : pluginId = 2, pluginName = Monet
2. 开启终端极速高清功能成功开启日志：
 [MonetProcessor] PLUGIN: did update monet module, result = 1
3. 如果出现下面的日志，表示签发的 License 不合法：
[MonetProcessor] Monet License invalid, error, set module is null

