<!-- ## 简介

云点播针对不同的使用场景，提供了多种上传方式，协助APP厂商将本地视频资源上传到腾讯云。云点播的上传不仅高效稳定，对上传的视频保证了持久性，而且提供了丰富的上传能力，满足不同客户的业务需求。

## 存储

云点播将上传的视频存储在腾讯云提供的高稳定、强安全的云端分布式存储服务[COS](/product/cos)中，具有强大的安全能力和灵活的文件管理能力，为视频提供 99.999999999% 的耐久性。
参见：[视频存储综述](/document/product/266/11729)

## 上传方式

针对不同的业务场景，提供多种上传方式，用户可以根据各自的业务特点，选择合适的方式将本地视频上传到云点播系统中。

### 控制台上传

控制台上传是指 APP 管理员登录腾讯云点播控制台后，通过 Web 页面将本地视频上传到腾讯云点播系统的方式。控制台上传页面从[这里](https://console.cloud.tencent.com/video/webupload)进入。

#### 上传步骤

* 单击【添加上传】按钮，在对话框中选择本地要上传的文件。

![图片描述](//mc.qcloudimg.com/static/img/67f44639beef13229348205328df0c42/image.png)

* 选定后可以指定上传的视频是否使用水印，上传成功后是否自动开启转码。

![图片描述](//mc.qcloudimg.com/static/img/287a91c3df1453988c94c24b5d3401cc/image.png)

* 添加视频后，单击【开始上传】，即可将待上传视频列表中的视频上传到腾讯云点播系统。

![图片描述](//mc.qcloudimg.com/static/img/b70d01343223d4b2baeb1fa0865e6321/image.png)

#### 方式特点

此上传方式操作简单，只需 APP 管理员登录腾讯云点播控制台页面即可进行视频文件的上传。按照控制台页面的指引，管理员可以指定视频的分类信息、是否转码等，并可在视频上传后为视频设置和修改封面。

### 服务端上传

服务端上传是指通过点播提供的 API 或 SDK，将保存在 APP 后台中的视频资源上传到腾讯云点播系统的方式。

#### 上传步骤

服务端上传视频文件需要经过3个步骤，分别是向 VOD 发起上传、向 COS 上传文件和向 VOD 确认上传，具体各个步骤的含义和使用方法请参见[服务端上传综述](/document/product/266/11727)。

![图片描述](//mc.qcloudimg.com/static/img/d751bf5e65346dee3a698f097ac2bfdd/image.png)

#### 方式特点

服务端上传适合 APP 将收集在服务器中的视频快速可靠地上传到腾讯云点播系统。相比于控制台上传，使用服务端上传 SDK 可以解放 APP 管理员的人工操作，从而提高发布和管理效率。

### 客户端上传

客户端上传是指通过点播提供的移动端（iOS 和 Android）和 Web 端 SDK，将客户端上的视频上传到腾讯云点播系统的方式。

#### 上传步骤

客户端上传视频文件需要经过4个步骤，分别是从 APP 服务器获取上传签名、向 VOD 发起上传、向 COS 上传文件和向 VOD 确认上传。具体各个步骤的含义和使用方法请参见[客户端上传指引](/document/product/266/11728)。

![图片描述](//mc.qcloudimg.com/static/img/1cb47b70ba7ab12ddf161f9576ca6849/image.png)

#### 方式特点

客户端上传可以让用户直接将移动设备中拍摄、录制或下载的视频快速上传到腾讯云点播系统。通过这样的方式，用户无需先把视频上传到 APP 服务器，再由服务器上传到腾讯云点播，从而有效简化了上传链路，节约了上传耗时和服务器上传带宽。

### URL拉取上传

URL拉取上传是指通过用户提供的URL从指定资源库中拉取视频到腾讯云点播系统的方式。

#### 上传步骤

URL拉取上传视频文件只需要经过1个步骤，用户只需要提供视频源URL，发起上传后点播后台自动到指定URL进行视频拉取，拉取成功后会有事件通知拉取上传成功，详情见[URL拉取上传](/document/product/266/7817)

#### 方式特点

URL拉取上传大大简化了用户到源站下载再上传到云点播的过程，直接通过云点播后台从源站拉取视频上传，简化了上传的链路，提供了上传的效率。

## 上传附带操作

在进行上传视频的时候，还能通过附带的参数去指定额外的操作，如指定视频的封面、指定视频上传后续任务操作，大大丰富了上传的功能，满足不同用户的业务需求。

### 封面上传

在上传视频的同时，额外上传一张本地图片，作为该视频的封面。具体方法是：
1. 在申请上传时，填写封面(cover)相关参数，该接口会同时返回视频文件路径与封面图片路径；
1. 在上传视频文件时，不仅要上传视频文件，而且要上传封面图片。

详情请参见具体上传SDK：
[服务端上传](/document/product/266/11727#.E7.94.B3.E8.AF.B7.E4.B8.8A.E4.BC.A0)
[客户端上传](/document/product/266/11728#.E4.BD.BF.E7.94.A8sdk.E4.B8.8A.E4.BC.A0.E8.A7.86.E9.A2.91)

### 指定后续任务操作

在上传视频的同时，可以指定后续的任务操作，如转码、添加水印等操作。具体方式是：
1. 在申请上传时，附带任务操作(procedure)的相关参数，具体支持的任务操作参见[任务流综述](/document/product/266/10263)
1. 在确认上传后，云点播后台产生异步任务流操作，对上传的视频进行指定的任务处理

详情请参见具体上传SDK：
[服务端上传](/document/product/266/11727#.E7.94.B3.E8.AF.B7.E4.B8.8A.E4.BC.A0)
[客户端上传](/document/product/266/11728#.E4.BD.BF.E7.94.A8sdk.E4.B8.8A.E4.BC.A0.E8.A7.86.E9.A2.91)

##  支持上传类型

### 断点续传

当上传意外终止时，用户再次上传该文件，可以从中断处继续上传。减少重复上传时间。点播实现的断点续传过程大致分为下述几个步骤：
1. 在申请上传的时候，点播后台会根据上传上下文生成一个VodSessionKey，客户端只需在第一次上传发起申请上传请求后将返回的VodSessionKey存起来，之后断点续传时在申请上传请求中携带VodSessionKey，点播后台就能得到相关上下文，并返回与之前上传一样的COS路径。
1. 在向COS上传的时候，会记录一个文件当前已经上传了多少分片，以及每个分片的 SHA-1 值。当用户下次往相同路径上传文件的时候，COS SDK会发起初始化请求，在请求中将所有分片的 SHA-1 值都发送给COS服务器。COS服务器就可以判断出处理哪些分片上传过，需要从哪个分片继续上传。

### 秒传

秒传主要是根据文件的MD5值进行，在上传过程中如果后台检测到服务器端有跟当前正在上传的文件MD5值一样的文件，则会直接从服务器拷贝一份，而不是真的上传，这样就会加快上传的速度。

## 上传园区

园区即是存储视频的地域，使用云点播上传的视频都会存储在特定的园区当中，用户可以根据费用、请求来源等综合选择数据存储的园区。在申请上传成功的时候，就会返回对应上传的园区，在向腾讯云存储服务COS发起上传的时候需要指定对应的园区，这个时候就需要上一步返回的园区，从而把视频文件上传到对应的园区中。

### 就近园区上传

在申请上传的时候，通过解析客户端的IP，从IP库中获取到客户端的大致位置，匹配出云点播已有的最近园区，返回给客户端，客户端向腾讯云存储服务COS发起上传的时候指定该最近园区，实现就近上传，提高上传的效率。目前只有客户端上传实现了就近园区上传，服务端上传可以根据自己的地域和[已有园区](/document/product/436/6224)自行选择就近园区实现就近园区上传。

### 指定园区上传

在申请上传的时候，可以通过storageRegion参数指定上传园区，在返回的结果就会包括指定园区的相关信息，通过这些园区带到COS上传中，就可以将视频文件上传到指定园区中。可指定园区可参见[已有园区](/document/product/436/6224)。

详情请参见具体上传SDK：
[服务端上传](/document/product/266/11727#.E7.94.B3.E8.AF.B7.E4.B8.8A.E4.BC.A0)
[客户端上传](/document/product/266/11728#.E4.BD.BF.E7.94.A8sdk.E4.B8.8A.E4.BC.A0.E8.A7.86.E9.A2.91)

## 视频上传事件通知

当视频上传成功了，点播服务端可以将此事件通知到用户的服务端，点播提供了基于HTTP回调和消息队列两种方式方式来获取事件通知，前者配置简单，后者安全性高、可靠性强，用户可以根据各自的业务需求选择合理的通知方式，详情参见[服务端事件通知综述](/document/product/266/7829)。

视频上传事件通知目前有下列两种：
[视频上传完成](/document/product/266/7830)
[URL 拉取视频上传完成](/document/product/266/7831) -->




<!-- ——————————————————————分割线———————————————————————— -->
<!-- ——————————————————————分割线———————————————————————— -->
<!-- ——————————————————————分割线———————————————————————— -->
<!-- ——————————————————————分割线———————————————————————— -->
<!-- ——————————————————————分割线———————————————————————— -->
<!-- ——————————————————————分割线———————————————————————— -->
<!-- ——————————————————————分割线———————————————————————— -->


## 视频上传方式综述
所谓视频上传，是指开发者或其用户将视频文件上传到点播的视频存储中，以便进行视频处理、分发等。腾讯云点播支持如下几种视频上传方式：

- 控制台上传：在点播控制台上进行操作，将本地视频上传到云点播，适用于直接管理少量视频的场景，具有方便快捷、无技术门槛的优点。
- 服务端上传：开发者将存储在其后台服务器中的视频上传到云点播，适用于自动化、系统化的运营场景。
- 客户端上传：终端用户将客户端本地视频上传到云点播，适用于 UGC、PGC 等场景，支持如下三端。
    - [Android 端上传 SDK](/document/product/266/9539)。
    - [iOS 端上传 SDK](/document/product/266/13793)。
    - [Web 端上传 SDK](/document/product/266/9239)。
- 离线拉取上传：将其他站点的视频拉取到云点播中，适用于小批量视频迁移场景。
- 源站同步：将保存在其他存储系统的视频迁移到点播系统中，适用于大规模视频迁移场景。

## 视频上传能力综述

### 文件类型

* 视频：mp4，ts，flv，wmv，asf，rm，rmvb，mpg，mpeg，3gp，mov，webm，mkv，avi。
* 音频：mp3，m4a，flac，ogg，wav。

### 封面类型
jpg，jpeg，png，gif，bmp，tiff，ai，cdr，eps。

### 上传时附带封面
在发起视频上传时，可以额外指定一张本地图片，来作为视频的封面。在进行视频播放时，该图片可以作为视频的内容预览图片。参见：

- [客户端上传指引](/document/product/266/9219)。
- [服务端上传指引](/document/product/266/9759)。


### 上传时指定指定视频处理方式
部分场景下，开发者需要在视频上传完成之后自动进行转码等视频处理操作；App 可以在上传视频的同时，指定视频处理方式；当视频上传完成之后，点播后台将依照 App 指定的方式来处理视频。参见：

- [客户端上传指引](/document/product/266/9219)。
- [服务端上传指引](/document/product/266/9759)。


### 客户端断点续传
客户端视频上传的过程中，如果出现异常（例如程序崩溃），则在尝试重新上传视频的过程中，已经完成上传的部分不需要再次上传。参见：

- [Android 端上传 SDK](/document/product/266/9539)。
- [iOS 端上传 SDK](/document/product/266/13793)。
- [Web 端上传 SDK](/document/product/266/9239)。

### 暂停/恢复上传

客户端在视频上传的过程中，可以暂停上传和恢复上传。参见：

- [Android 端上传 SDK](/document/product/266/9539)。
- [iOS 端上传 SDK](/document/product/266/13793)。
- [Web 端上传 SDK](/document/product/266/9239)。

### 取消上传

客户端在视频上传的过程中，可以取消上传。参见：

- [Android 端上传 SDK](/document/product/266/9539)。
- [iOS 端上传 SDK](/document/product/266/13793)。
- [Web 端上传 SDK](/document/product/266/9239)。


### 视频上传事件通知

在视频上传过程中，可以经过配置，将视频上传这一事件通知 App 服务器。参见：
[事件通知 - 视频上传完成](/document/product/266/7830)。
