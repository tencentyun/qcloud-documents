## 简介

欢迎使用腾讯云游戏多媒体引擎 SDK 。为方便开发者调试和接入腾讯云游戏多媒体引擎产品，这里向您介绍适用于所有平台的鉴权密钥相关技术文档。

## 实时语音密钥
腾讯云游戏多媒体引擎提供鉴权密钥，用于相关功能的加密和鉴权。鉴权所用到的签名产生过程涉及到明文、密钥和算法。

明文为以下字段的网络序拼接：

|字段描述    		| 类型/长度			| 值定义/备注|
| ---------------- |-------------------|--------------|
| cVer				|unsigned char/1	|版本号，填写数值：0|
| wAccountLen		|unsigned short/2	|第三方自己的帐号长度	|
| buffAccount		|wAccountLen		|第三方自己的帐号字符	|
| dwSdkAppid		|unsigned short/4	|第三方自己的 appid		|
| dwAuthid			|unsigned int/4		|群组号码				|
| dwExpTime		|unsigned int/4		|过期时间（当前时间+有效期[单位：秒，建议 300 秒]）|
| dwPriviegeMap	|unsigned int/4		|ITMG_AUTH_BITS_DEFAULT 代表全部权限|
| dwReserved		|unsigned int/4		|填写数值：0		|

### 1.密钥
腾讯云 GME 控制台获取相关权限密钥。

![](https://main.qcloudimg.com/raw/9afa07c629e37b66cd223bf39fe17abf.png)

### 2.算法
TEA 对称加密算法。
总体建议，建议接入初期使用客户端部署方案，后面可优化为部署在游戏 App 后台。

|方案       		| 优点        		| 缺点																																|
| ------------- |-------------|-------------| 
| 后台部署    		|安全性高	|需要后台开发联调|
| 客户端部署      	|接入快速	|安全性低|

#### 后台部署使用方法
后台生成加密串后，下发给客户端，客户端可以用于如下场景：调用 API enterRoom 进行进房操作时，将加密串传给进房参数的 authBuffer 字段。




### 3.算法加密详情
- 密钥：APPID 对应鉴权密钥的 md5 值，长度 16 字节
- 加密算法：TEA 加密
- 加密库及例子：附件 [authbuffer.zip](https://main.qcloudimg.com/raw/eac8e36ca4a24edf9414dfe7f58a764a.zip)

>**注意：**
> 控制台修改密钥后，15 分钟 ~ 1 小时内生效，不建议频繁更换。


#### 加密方法	
- 密文中的数字转换成网络字节序（大端字节序）；
- 把密文拼接成一段字符串；
- 用 tea 加密对字符串加密，symmetry_encrypt 函数输出的字符串即为权限加密串

>**注意:**
>不用要把二进制串转成 16 进制。



## 离线语音密钥
概述：离线语音的上传下载依赖腾讯云的 COS 平台，需要单独的鉴权。鉴权所用到的签名产生过程涉及到明文、密钥和算法。
### 1.明文
明文为 appid 和 openid。

### 2.密钥的获取
请在应用设置界面的鉴权信息模块，单击【下载公私钥】可以下载此应用相应的公私钥。
![](https://main.qcloudimg.com/raw/9afa07c629e37b66cd223bf39fe17abf.png)

解压下载的 zip 文件后可以看到两个文件，如下：

|文件名       |作用    |
| :-----------: | ------------- |
|public_key |公钥|
|private_key |私钥|

根据需要用记事本打开相应的文件，复制里面的密钥，作为参数填入相应函数中。

>**注意：**
>每次下载获取的公私钥对，必须等待 1 个小时才能正常使用。

### 3.算法的部署
总体建议，建议接入初期使用客户端部署方案，后面可优化为部署在 App 后台。

|方案       | 坏处        | 详情 |
| ------------- |:-------------:| ------------- 
| 后台部署   		|工作量大				|[TLS 后台 API 使用手册](https://cloud.tencent.com/document/product/269/1510#1-.E6.A6.82.E8.BF.B0)					|
| 客户端部署      	| 安装包体积，安全性 		|工程中额外引入 libqav_tlssig.so（Android） 和 QAVSDKTlsSig.framework（iOS）两个库文件，并额外引入 QAVSig.cs。 	|  

使用详情见各平台文档。
