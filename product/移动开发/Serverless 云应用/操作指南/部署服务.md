# 部署服务

### Step1：创建版本

首次部署服务，需要创建服务的第一个版本。按页面提示配置好版本信息，点击“开始部署”。

版本是一次部署所需信息的集合，包括镜像地址、服务端口、环境变量、自动扩缩容设置等；也是访问流量真正承载的实体，对应着一组配置信息相同的容器集合。

每一次升级服务，都需要创建一个新的版本。回滚时只需要将流量再次转移回旧版本即可。



#### 版本管理

目前一个服务可同时存在最多10个版本。版本名由 Serverless 云应用自动生成，格式为“服务名”+“序号”，序号按照创建顺序依次递增，不支持修改（如：testservice-001, testservice-002等）。

不再使用的版本可以手动删除，已删除的版本不计入版本总数，但不会影响新建版本的序号。

> 例如：删除掉版本"testservice-002"，再次新建的版本仍然会是“testservice-003”。



### Step2：配置版本

#### **基础配置** 

上传方式：支持本地代码/代码库拉取/镜像拉取三种方式。

> 本地代码方式，提供  [Java](https://clooudbaserun-1258016615.cos.ap-shanghai.myqcloud.com/java_helloworld.zip)     [PHP](https://clooudbaserun-1258016615.cos.ap-shanghai.myqcloud.com/php_helloworld.zip)     [Node.js](https://clooudbaserun-1258016615.cos.ap-shanghai.myqcloud.com/nodejs_helloworld.zip)     [Golang](https://clooudbaserun-1258016615.cos.ap-shanghai.myqcloud.com/go_helloworld.zip)     [Python](https://clooudbaserun-1258016615.cos.ap-shanghai.myqcloud.com/python_helloworld.zip) 语言的“Hello World” 代码包下载用于Demo。除此之外的任意开发语言也都可支持。如需更多语言的Demo代码包资源，请联系我们。
>
> 代码库拉取方式，支持对接 GitHub / GitLab 。
>
> 镜像拉取方式，提供“Hello World”镜像用于Demo。

![](https://main.qcloudimg.com/raw/77c0b8e0b3f717c5de6e78555fcc7195.png)

服务端口：可自行设置，默认为80。注意此处配置的端口需与代码中监听的端口一致。

流量策略：可选择部署完成后立刻开启100%流量，或保持流量为0稍后再手动调整流量。

备注信息：选填，会展示在版本列表页面中，帮助您更好区分各版本。



#### **高级配置**

高级配置可不做任何修改直接使用默认值。

Dockerfile 地址：当用户选择本地代码/代码库拉取方式构建服务时，需要用户提供 Dockerfile 文件。默认 Dockerfile 地址为根目录（请注意，当选择代码包 zip 上传时，Dockerfile 的路径需与 zip 包内的路径一致，而非一定与当前文件夹内的路径一致。路径错误可能导致构建失败）。

构建目录： 当 Serverless 云应用将用户代码构建为镜像时，构建目录默认为根目录。用户可根据自身项目进行修改。

内网IP/port：调用当前版本所需要的地址及服务端口

规格：规格指集群中每个容器实例的配置

副本个数：指当前服务版本在自动扩缩容时可达到的最大实例数及最小实例数。最小实例数最低可到0（连续一个小时无流量才将实际缩容到0。再次冷启动时，可能有30秒服务延迟。请谨慎选择）；自动扩容到最大实例数后若仍不足以承载业务流量，您的服务可能会受影响，请您评估好业务指标后合理设定最大实例数。

扩缩容条件：指当达到某个条件时，Serverless 云应用会自动会创建/删除一个实例，直至实例数量达到副本个数的最小值或者最大值，停止自动扩缩容。

环境变量：用户所需的环境变量，以 key value 的形式可配置多个。



## Step 3 ：访问服务

版本状态变为“正常”即说明部署成功。点击“访问服务”按钮，可以通过系统默认的域名查看您的服务。

若您需要绑定了自定义域名，请到“服务配置”选项卡中配置，然后通过您所绑定的域名访问服务。

![](https://main.qcloudimg.com/raw/86b64612481c9afaa6614360251b3373.png)

