> !本篇文档仅适用于云托管新版控制台。

## 服务名称
环境下服务的唯一标识。创建成功后**不支持修改服务名称**。如果您有多个环境，不同环境之间服务可以重名。（例如：开发环境和测试环境可以同时存在服务"testservice"）。服务名只能包含数字、小写字母和“-”，且必须以小写字母开头。

## 部署方式
支持上传代码包和拉取镜像两种方式。

### 方式 1：上传代码包
上传代码工程文件夹或 zip、jar、war 压缩包，系统解析成功后先将代码构建为镜像、将镜像推送到镜像仓库储存，然后基于该镜像进行部署。
- 此方式需要您自行编写 Dockerfile 并包含在代码文件夹或 zip 压缩包中，放置在目标目录的根目录下。
- 压缩包请注意不要直接压缩顶层文件夹，而是压缩文件夹内所有文件。否则会导致路径多一层而报错找不到 Dockerfile。

### 方式 2：拉取镜像
无需系统提供从代码构建镜像的服务，由您自行采用任意方式构建好镜像后，手动将镜像上传至 [容器镜像服务（企业版）](https://cloud.tencent.com/document/product/1141/39287) 中，然后系统基于您选定的镜像进行部署。
- 使用**拉取镜像**方式部署前，请先到**环境设置**中授权需要使用的容器镜像服务实例，云托管才可获得访问凭证，从而拉取镜像。
- 容器镜像服务实例请尽量开放内网访问。如果走公网访问，拉取镜像将产生公网流量费用且速度较慢；公网/内网均不开启，则无法拉取镜像会导致部署失败。配置参见 [容器镜像服务-访问管理](https://cloud.tencent.com/document/product/1141/41838)。

## 端口
服务的监听端口，不支持多个。服务的调用方无需感知和使用此端口。监听端口必须为1~61000之间的整数且不能为9100。

## 环境变量
用户所需的环境变量，直接传入容器中。以 key value 的形式可配置多个。适合用来管理一些可变的配置，使得可以在不重新部署服务的情况下改变某些参数，例如数据库地址等。

## 目标目录
当代码包中包含不需要构建的文件时（例如同一个代码包中包含多个服务的代码，当前服务只用到其中一个子目录；或者需要排除 README 等文件时），可以将对应需要构建的子目录指定为目标目录，则不在目标目录中的文件会被忽略。
>!**Dockerfile 需要位于目标目录的根目录下，否则会报错。**

## Dockerfile 名称
默认为 **Dockerfile**。当同一份代码在不同场景时需要配套使用不同的 Dockerfile，就需要用不同名称区分 Dockerfile。

## 公网访问
关闭后，默认域名或自定义域名均不可访问。

## 默认域名
服务创建后即分配的系统默认域名，仅能支持测试使用，不承诺 SLA 及相关补偿，请勿用于线上生产。线上业务请绑定并使用自定义域名。

## 自定义域名
绑定您自行购买和已备案好的域名（不一定要在腾讯云购买及备案），一个服务可以绑定多个，但多个服务不能绑定同一个自定义域名。域名一定需要完成域名备案，否则无法访问。
访问方式目前支持 HTTP、HTTPS 2种方式，默认使用 HTTPS；HTTPS 访问需要上传证书，可前往购买证书的平台下载证书签名及私钥，证书文件分证书和私钥，一般建议传 nginx 等类型的文本证书，不支持二进制可执行证书。
>?证书过期更新，直接**编辑**重新上传证书，不需要删除重新配置。

- 证书通常是以 `.crt` 或 `.pem` 为扩展名的文件，使用文本编辑器打开证书文件可以看到内容 `BEGIN CERTIFICATE` 开头，`END CERTIFICATE` 结尾。
- 私钥通常以 `.key` 或 `.pem` 等为扩展名的文件，使用文本编辑器打开证书文件可以看到内容 `BEGIN PRIVATE KEY` 开头，`END PRIVATE KEY` 结尾。

## 容器规格
每个容器实例的配置。自动扩容时，新创建的实例也将使用这个规格。同一个服务下所有运行中的容器实例规格都会保持一致。可选的容器规格范围由当前环境所选套餐决定。**容器规格不会随着扩缩容而改变**。

## 日志采集类型
选择**无**，则不采集日志（可以通过 webshell 登录容器实例查看日志文件，但因无法持久化存储，所以日志文件会在重启或扩缩容后消失）；选择**自定义**，则将日志采集到 [腾讯云日志服务 CLS](https://console.cloud.tencent.com/cls) 中。

## 日志采集路径
因为容器无法持久化存储文件，且实例因为弹性伸缩处在不断变化之中，登录具体容器实例去查看日志极为繁琐不变。云托管采取的是将日志通过 Loglistener 组件采集出来，投递到腾讯云日志服务 CLS 中持久保存并查看。
可设置采集目录或文件，支持设置多个路径，支持标准输出（stdout）以及 `*` 通配路径（例：/logs/\*），使用 `,`（半角逗号）分割，留空将采集标准输出。
> !采集路径必须是最底层目录，其下不可以再包含文件夹，否则会采集失败。例如：日志如果存储在 `/logs/today` 中，日志采集路径配必须配置 `/logs/today/*`，而不能只配置到 `/logs`。

## 实例副本数
指当前服务在自动扩缩容时可达到的最大实例数及最小实例数。最小值下限为 0，最大值上限由当前环境所选套餐决定。
- 副本个数最小值为 0，当连续半小时**没有通过域名调用服务时**，版本将缩容到 0，不保留任何实例，不产生资源消耗。再次冷启动时，可能有一定的服务延迟。
- 虽然没有业务流量，部署过程中仍然会先产生一个实例，部署完成后再缩容到 0，因此**部署过程本身会产生一定的资源消耗。**
- 副本个数最小值不为 0，即便服务没有任何访问，仍会保持最小个数的实例数，也会**持续产生资源消耗**。

## 扩缩容条件
当达到某个条件时，云托管会自动会创建/删除实例，然后检测是否再次达到条件，如果满足条件则继续扩缩容，如此反复直至实例数量达到副本个数的最小值或最大值，或不再满足扩缩容条件时停止自动扩缩容。
目前支持 CPU 使用率或内存使用率作为扩缩容条件。
>?自动扩容到副本个数最大值后若仍不足以承载业务流量，即便再次达到扩缩容条件，也不会继续创建新的实例，可能导致您的业务受影响，请您评估好业务指标后合理设定副本个数最大值。
