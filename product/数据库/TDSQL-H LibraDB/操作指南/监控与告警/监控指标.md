TDSQL-H LibraDB 支持对分析引擎指标监控，包括 ZooKeeper 和 LibraSQL 节点（如果实例规格为1分片1副本，仅涉及 LibraSQL 节点），便于用户诊断集群健康情况。同时，TDSQL-H LibraDB 已接入云监控平台，可通过云监控平台设置告警策略和配置 Dashboard，实时了解性能指标变化，当指标异常时能及时发现并采取措施。

## LibraSQL&LibraSQL ZooKeeper 监控指标

| 监控项             | 单位     | 说明                                                   |
| :----------------- | -------- | :----------------------------------------------------- |
| 活跃分区目录数     | Count    | 采集自 system.parts，当前所有的 active 的 parts 数量。 |
| 每秒写入大小       | Bytes/s  | 平均每秒写入数据量的大小。                             |
| 每秒合并数         | Count/s  | 平均每秒完成 merge 的数目。                            |
| 每秒写入行数       | Count/s  | 平均每秒写入的行数。                                   |
| 访问 ZooKeeper 延迟 | ms       | 平均每秒 ZooKeeper 访问延时增加。                      |
| 请求 ZooKeeper 次数 | Count    | 当前的 ZooKeeper 请求数目。                            |
| 网络入流量         | MBytes/s | 每秒网络下载的流量。                                   |
| 当前连接数         | Count    | 当前连接数目（TCP/MySQL/HTTP）。                       |
| 每秒写入次数       | Count/s  | 平均每秒 insert 写入次数。                             |
| 每秒延迟写入次数   | Count/s  | 由于写入压力过大，平均每秒被延时写入的 insert 数目。   |
| 当前合并数         | Count    | 当前正在进行 merge 的数目。                            |
| 每秒查询次数       | Count/s  | 平均每秒的查询数目。                                   |
| 磁盘使用率         | %        | 磁盘处理 I/O 的时间百分比。                            |
| 内存使用量         | MiBytes  | 当前已使用内存。                                       |
| 内存使用率         | %        | 当前已使用内存与全部内存的百分比。                     |
| 网络出流量         | MBytes/s | 每秒网络上传的流量。                                   |
| 磁盘IOPS使用率     | %        | 当前副本 IOPS 占用上限的比例。                          |
| CPU使用率          | %        | 当前已使用 CPU 与全部 CPU 的百分比。                       |
| 磁盘使用量         | GiBytes  | 当前已使用磁盘量。                                     |
| 磁盘IOPS大小       | Count    | 当前副本的 IOPS 数值。                                 |
| 每秒查询失败次数   | Count/s  | 平均每秒查询失败的数目。                               |
| 每秒写入失败次数   | Count/s  | 平均每秒写入失败的数目。                               |

>?TDSQL-H LibraDB 分析引擎的引擎监控中仅展示关键指标，云监控平台中可对全量指标进行配置。

## CDC 监控指标

| 指标            | 单位    | 说明                                                         |
| --------------- | ------- | ------------------------------------------------------------ |
| 源数据导出 RPS   | Count/s | CDC 每秒读取的源实例的数据行数。                              |
| 目标数据导入 RPS | Count/s | CDC 每秒迁移到目标实例的数据行数。                            |
| 同步延迟时间    | s       | 目标实例和源实例的时间延迟。<br/>计算方法：源实例当前时间减去目标实例当前正在执行的最新一条源实例 Binlog Event 中记录的时间。 <br/>“数据同步延迟时间”的计算依赖于源库的增量 Binlog，所以当源库长时间没有 DDL 或者 DML 操作时，该指标会逐步增大，无法反应真实的同步延迟时间（如出现值为“-1”，表示存量数据迁移完成，一直没有增量数据的刷新）。如遇到这种情况，用户可以通过在源端执行 SQL 语句来让该指标刷新，进而得到真实的指标数据。 |
| 同步延迟数据量  | MBytes  | 目标实例和源实例的数据差距。<br/>计算方法：源实例最新的 Binlog Event 文件位点减去目标实例当前正在执行的最新一条源实例 Binlog Event 的文件位点。 当这两个位点跨越 Binlog 文件时，该值有估算成分。<br/>当源库长时间没有 DDL 或者 DML 操作时，该指标会逐步增大，无法反应真实的同步延迟时间（如出现值为“-1”，表示存量数据同步完成，一直没有增量数据的刷新）。 |

