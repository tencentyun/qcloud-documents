## 操作场景
数据迁移、数据同步、数据订阅任务中，需要将 DTS 的服务 IP 地址添加到源数据库和目标数据库的白名单中，以便 DTS 可以与需要访问的数据库连通。

如果未将 DTS IP 地址添加到数据库的白名单中，可能会出现连通性测试失败。用户也可以在连通性测试失败后，根据界面提醒添加 DTS 的 IP 地址到数据库的白名单中。

![](https://qcloudimg.tencent-cloud.cn/raw/f681a96a6f315922e26263d96c11b7fe.png)

## 添加原则

请参考 [DTS 服务的 IP 地址](#1) 中的每个地域对应的 IP 地址信息，将 IP 地址添加到源数据库或者目标数据库的白名单中。

> ?当源数据库或者目标数据库为腾讯云数据库实例，且为云数据库 MySQL/PostgreSQL/TDSQL-C PostgreSQL/TDSQL TDStore、TDSQL PostgreSQL/TDSQL-A PostgreSQL 时，DTS 会自动地将 DTS 服务器的 IP 地址添加到源数据库或目标数据库的安全组规则中，无需手动添加。除此之外的其他场景都需要手动添加。

示例一：源数据库为北京-自建 MySQL，目标数据库为广州-腾讯云 MySQL，则在 [DTS 服务的 IP 地址](#1) 中找到北京地域对应的 IP 信息，将其添加到源数据库的白名单中，目标数据库因为是腾讯云的云数据库 MySQL，DTS 已经自动添加了白名单，所以不需要再重复添加。

示例二：源数据库为北京-自建 MongoDB，目标数据库为广州-腾讯云 MongoDB，则在 [DTS 服务的 IP 地址](#1) 中找到北京地域对应的 IP 信息，将其添加到源数据库的白名单中，同时找到广州地域对应的 IP 信息，将其添加到目标数据库的白名单中。

## 操作步骤

根据数据库所在地域，获取对应地域 [DTS 服务的 IP 地址](#1)，将其加入到源数据库或者目标数据库的白名单中。

- 自建数据库，请在防火墙设置中允许 DTS IP 地址访问。
  - Windows 系统：打开控制面板找到 Windows 防火墙，查看防火墙策略。
  - Linux 系统：请执行 `iptables -L` 命令，查看服务器防火墙策略。

- 腾讯云数据库或者 CVM 上的自建数据库，请参考如下指导将 DTS 服务的 IP 地址添加到安全组中。
  1. 登录源数据库，在实例列表，单击实例 ID，进入实例管理页面。
  2. 在实例管理页面，选择**安全组**页或者**数据安全**页， 添加 DTS 服务的 IP 地址到安全组中。
     ![](https://main.qcloudimg.com/raw/07bb026fca51a1356df8138349e3c7c9.png)
  
- 第三方云厂商数据库，请添加 DTS 服务的 IP 地址到相关的安全组配置中。

## [DTS 服务的 IP 地址](id:1)

#### 公网接入

| 地域     | DTS 服务的 IP 地址                                           |
| -------- | ------------------------------------------------------------ |
| 广州     | 111.230.198.143,118.89.34.161,123.207.84.254,139.199.74.159  |
| 上海     | 111.231.139.59,111.231.142.94,115.159.71.186,182.254.153.245 |
| 北京     | 123.207.145.84,211.159.157.165,211.159.160.104,58.87.92.66   |
| 成都     | 111.231.225.99,118.24.42.158                                 |
| 重庆     | 139.186.122.1/24,129.28.12.1/24,129.28.14.1/24,139.186.77.242,139.186.109.1/24,<br>139.186.131.1/23,94.191.102.144,94.191.98.210 |
| 杭州ec   | 111.231.139.59,111.231.142.94,115.159.71.186,182.254.153.245 |
| 南京     | 129.211.166.117,129.211.167.130                              |
| 天津     | 154.8.246.150,154.8.246.48                                   |
| 深圳     | 118.126.124.6,118.126.124.83                                 |
| 香港     | 119.29.180.130,119.29.208.220,124.156.168.151,150.109.72.54  |
| 北京金融 | 62.234.240.36,62.234.241.241                                 |
| 深圳金融 | 118.89.251.206,139.199.90.75                                 |
| 上海金融 | 115.159.237.246,211.159.242.74                               |
| 新加坡   | 119.28.103.40,119.28.104.184,119.28.116.123,150.109.11.113   |
| 雅加达   | 43.129.33.41,43.129.35.144                                   |
| 曼谷     | 150.109.164.203,150.109.164.82                               |
| 孟买     | 119.28.246.130,119.28.246.18                                 |
| 首尔     | 119.28.150.71,119.28.157.173                                 |
| 东京     | 150.109.195.201,150.109.196.137                              |
| 硅谷     | 49.51.38.216,49.51.39.189                                    |
| 弗吉尼亚 | 170.106.2.63,49.51.85.120                                    |
| 多伦多   | 45.113.70.156,45.113.70.6,49.51.10.104,49.51.9.221           |
| 法兰克福 | 49.51.132.38,49.51.133.85                                    |
| 莫斯科   | 162.62.16.46,162.62.21.243                                   |

#### VPN 接入/专线接入/云联网/云主机自建/VPC 接入/云数据库

当源数据库或者目标数据库为腾讯云数据库实例，且云数据库类型为 MySQL/PostgreSQL/TDSQL-C PostgreSQL/TDSQL TDStore、TDSQL PostgreSQL/TDSQL-A PostgreSQL 时，无需添加 DTS 服务器的 IP 地址添加到白名单规则中，其他场景都需要添加。

| 地域   | DTS 服务的 IP 地址                                           |
| ------ | ------------------------------------------------------------ |
| 全地域 | 10.0.1.1/16,10.1.1.1/16,172.19.1.1/16,169.254.1.1/16,10.200.1.1/16,172.20.1.1/16,<br>10.159.1.1/16,10.45.1.1/16,192.168.1.1/16,172.16.1.1/16,172.30.1.1/16,172.31.1.1/16,<br/>10.26.1.1/16,10.162.1.1/16,10.203.1.1/16,10.206.1.1/16,9.145.1.1/16,9.146.1.1/16,<br/>10.209.1.1/16,10.6.1.1/16 |

