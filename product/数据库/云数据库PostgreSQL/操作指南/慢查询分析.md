## 功能说明
默认数据库对超过1s的 SQL 语句查询判断为“慢查询”，对应语句称为“慢查询语句（俗称慢 SQL）”，而数据库管理员（DBA）对慢查询语句进行分析并找到慢查询出现原因的过程叫做慢查询分析。

[云数据库 PostgreSQL 控制台](https://console.cloud.tencent.com/pgsql) 在实例管理页的**性能优化**模块下，提供慢查询分析能力。如下图：
![](https://main.qcloudimg.com/raw/d710694a213a1778a8a72987a53c64e8.png)

## 监控视图
控制台中的两个图表为监控视图，可以直观方便地查看数据库慢 SQL 的相关信息。
**慢查询与其他监控组合视图：**支持通过图表化形式查看慢查询指标以及与其他指标联合对比查看的能力。可以支持的其他指标有：CPU 利用率，QPS，请求数，读请求数，写请求数，其他请求数，缓冲区缓存命中率，平均执行时延。
**慢 SQL 耗时分布：** 可以通过不同时间段的慢 SQL 进行查看慢查询主要分布在什么时段区间内。

## 慢 SQL 列表
慢 SQL 列表可以实时查看数据库中所产生的慢 SQL 语句，列表根据时间降序排列，最新产生的慢 SQL 会自动生成显示在第一行。
支持查看的慢 SQL 字段：执行时间，慢 SQL 语句，总耗时，客户端 IP 地址，数据库名，执行用户。

>! 慢 SQL 列表默认保存最近7天的慢 SQL 数据与最大50GiB的日志总量，当哪一个条件率先满足，则会自动删除超出要求的日志。

## 慢 SQL 统计分析
慢 SQL 统计分析可以根据指定时间范围内的所有慢 SQL 经过系统的参数抽象后，对同类 SQL 进行聚合分析得到的慢 SQL 分析信息。其中包含多种字段信息。
- **最后执行时间**：在统计范围内，该抽象语句最后一次出现的时间，由于某些预计执行较长，我们统一按语句执行的 begin_time 记录。
- **抽象后的 SQL 语句**：去掉慢 SQL 中常数后的语句，抽象后的语句可以将同类同性质的语句进行汇总统计，以方便您更好的分析。
- **数据库**：该语句调用了哪个数据库。
- **帐号**：该语句是使用哪个帐号来运行的。
- **客户端 IP 地址**：语句在哪些客户端上执行过。
- **首次执行时间**：在统计范围内，该慢 SQL 第一次出现的时间（抽象后汇总后，可能有很多条记录）。
- **执行总时间**：在统计范围内，慢查询语句查询总耗时。
- **平均执行时间**：慢查询语句总时间除以总次数的平均时间。
- **最小执行时间**：所有该条抽象语句中，慢查询语句出现的最小时间；用于帮助判断该语句是否偶发性事件。
- **最大执行时间**：所有该条抽象语句中，慢查询语句出现的最大时间；用于帮助判断该语句是否偶发性事件。
- **总时间占比**：在统计范围内，慢查询语句占所有慢查询语句时间的占比。

