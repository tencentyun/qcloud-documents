### PostgreSQL 怎样迁移数据？
如果你的数据已经在PostgreSQL上，你可以psql命令将数据轻松的迁移到CDB for PostgreSQL中。
迁移数据的工作主要分为两大部分：
 1. 使用pg_dump命令进行逻辑备份，创建转储数据；
 2. 将上一步的备份数据恢复到CDB for PostgreSQL上。
准备操作：你应该已经完成PostgreSQL实例的准备，如未完成，请参见申请实例和连接实例的操作指引。

 __第一步__ 
使用PostgreSQL客户端连接本地数据库，执行如下命令，备份数据。
pg_dump -U username -h hostname -p port -d databasename -f filename
参数说明请参考网址： [https://cloud.tencent.com/document/product/409/4997](https://cloud.tencent.com/document/product/409/4997) 

 __第二步__ 
准备操作：请先将备份好的数据上传到同一内网的云服务器主机上，然后通过内网进行数据恢复，以保证网络的稳定和数据的安全。
在您登录云服务器后，在PostgreSQL客户端中，执行如下命令，恢复数据。
psql -U username -h hostname -d desintationdb -p port -f dumpfilename
参数说明请参考网址： [https://cloud.tencent.com/document/product/409/4997](https://cloud.tencent.com/document/product/409/4997)


### PostgreSQL 重启注意事项有哪些？
1.由于数据库本身对于业务的重要性，我们建议您谨慎重启，重启前尽量提前断开服务器与数据库连接，并停写数据。
2.一般说运行重启操作后需要十几秒~几分钟时间，重启期间实例将无法正常提供服务。
3.重启数据库有几率失败，这是正常现象，如果失败可再次（手工）单击重启功能继续重启。
4.重启实例不会改变实例的物理特性，因此实例的公网 IP、内网 IP、存储的任何数据都不会改变。
5.重启后，业务需要重连数据库，请确保您的业务有重连机制。

### PostgreSQL 错误日志：实例管理—性能优化，如何产生？
__1.功能说明__ 
数据库运行过程中，因操作、SQL、系统运行错误等原因产生的日志叫做错误日志，错误日志常用于开发者找出业务系统或数据库出现问题的原因。
腾讯云云数据库（CDB for PostgreSQL）在【实例管理】-【性能优化】模块下，提供错误日志查看能力。如下图：
![图片描述](//bot1024-1253841380.file.myqcloud.com/b4174092ad8e11e79f84525400a3183e.png)
 __2.错误日志默认设置__ 
错误日志功能：默认开启
错误日志记录级别：log_min_error_statement=ERROR。
分析数据输出延迟：1~5分钟。
日志记录时长：7天（最大最近10000条）。

### PostgreSQL 如何慢查询分析：实例管理—性能优化？
__1.功能说明__ 
将超过指定时间的SQL语句查询称为“慢查询”，对应语句称为“慢查询语句（简称慢SQL）”，而数据库管理员（DBA）对慢查询语句进行分析并找到慢查询出现原因的过程叫做慢查询分析。
腾讯云云数据库（CDB for PostgreSQL）在【实例管理】-【性能优化】模块下，提供慢查询分析能力。如下图：
![图片描述](//bot1024-1253841380.file.myqcloud.com/e766a028ad8e11e780ee525400a3183e.png)

 __2.主要参数说明__ 
 __2.1. 慢查询分析默认设置__ 
慢查询功能：默认开启
慢SQL记录时间（log_min_duration_statement）：默认配置为1s，即慢查询语句查询时间超过1s的才被记录。如有需要调整，请提交工单，说明实例ID和需要配置该参数的时间可修改。
分析数据输出延迟：1~5分钟。
日志记录时长：7天（最大最近10000条）。

  __2.2.分析列表字段说明__ 
目前慢查询分析功能对慢SQL有如下分析：

 __基本信息__ 
- 最后执行时间 ：在统计范围内，该抽象语句最后一次出现的时间，由于某些预计执行较长，我们统一按语句执行的begin_time记录。
- 抽象后的SQL语句 ：去掉慢SQL中常数后的语句，抽象后的语句可以将同类同性质的语句进行汇总统计，以方便您更好的分析。
- 数据库：该语句调用了哪个数据库
- 账号：该语句是使用哪个帐号来运行的。
- 首次执行时间：在统计范围内，该慢SQL第一次出现的时间（抽象后汇总后，可能有很多条记录）。
- 总次数：在统计范围内，该慢SQL总共出现的次数。
- 总次数占比：在统计范围内，该慢SQL总共出现的次数，占所有慢SQL出现的次数的- 比值。
- 发送行数：在统计范围内，数据库服务器发送（返回）给客户端多少行结果。

__查询信息统计__ 
- 总时间 ：在统计范围内，慢查询语句查询总耗时。
- 总时间占比 ：在统计范围内，慢查询语句占所有慢查询语句时间的占比。
- 平均时间 ：慢查询语句总时间除以总次数的平均时间；
- 最小时间 ：所有该条抽象语句中，慢查询语句出现的最小时间；用于帮助判断该语句是否偶发性事件。
- ** 最大时间：所有该条抽象语句中，慢查询语句出现的最大时间；用于帮助判断该语句是否偶发性事件。

__读写数据统计__ 
- 读共享内存块数：在统计范围内，该慢SQL总共从共享内存中读取多数据。
- 写共享内存块数：在统计范围内，该慢SQL总共写入共享内存中多数据。

__读写IO耗时统计__ 
- 读IO总耗时：在统计范围内，该慢SQL总共消耗多少读IO时间；用于帮助判断该语句是否在做全盘扫描等耗时操作数据。
- 写IO总耗时：在统计范围内，该慢SQL总共消耗多少写IO时间；用于帮助判断该语句是否一次性写入大量（临时）数据。

### PostgreSQL 是什么？
__PostgreSQL简介__ 
PostgreSQL 是全球最强大的开源数据库，支持主流开发语言，包括C，C++，Perl，Python，Java，Tcl以及PHP等，能够对 SQL 规范的完整实现，以及丰富多样的数据类型支持，包括JSON 数据、IP 数据和几何数据等，而这些能力大部分商业数据库都无法全面支持。
在过去的若干年间，PostgreSQL正在以飞快的速度发展，目前已经广泛用在包括地球空间、移动应用、数据分析等各个行业，已成为众多企业开发人员和创新公司的首选。

 __腾讯云云数据库PostgreSQL简介__ 
云数据库PostgreSQL能够让您在云端轻松设置、操作和扩展目前功能最强大的开源数据库PostgreSQL，腾讯云将负责绝大部分处理复杂而耗时的管理工作，如PostgreSQL软件安装、存储管理、高可用复制、以及为灾难恢复而进行的数据备份，让您更专注于业务程序开发。
目前，腾讯云已经提供PostgreSQL 9.3.5，9.5.4（内核优化）版本。

### 腾讯云云数据库 PostgreSQL 简介？
云数据库PostgreSQL能够让您在云端轻松设置、操作和扩展目前功能最强大的开源数据库PostgreSQL，腾讯云将负责绝大部分处理复杂而耗时的管理工作，如PostgreSQL软件安装、存储管理、高可用复制、以及为灾难恢复而进行的数据备份，让您更专注于业务程序开发。
目前，腾讯云已经提供PostgreSQL 9.3.5，9.5.4（内核优化）版本。

### PostgreSQL 有到期该如何操作？
1. 云服务资源到期前七天，系统会开始给用户发送续费提醒通知。 [提醒规则](https://cloud.tencent.com/document/product/285/4108) 
2. 到期后，七天内，云服务还可以继续使用，需要尽快续费，系统将发送云服务到期提醒。
3. 到期超过七天的云服务资源将被系统回收，数据将会被清除，不可恢复。

### PostgreSQL 如何注册腾讯云：官网—注册—输入QQ帐号—填写帐号提交—进入邮箱确认链接？
1.新用户请单击腾讯云官网顶部的【注册】按钮，进入注册页面：
![图片描述](//bot1024-1253841380.file.myqcloud.com/2e7c4a98adae11e780ee525400a3183e.png)
2.输入QQ帐号，并登录验证。验证后转到填写资料页面，填写资料并单击【提交】按钮：
![图片描述](//bot1024-1253841380.file.myqcloud.com/40084e2eadae11e79f84525400a3183e.png)
3.进入邮箱并单击【确认链接】即成功注册腾讯云帐号。
![图片描述](//bot1024-1253841380.file.myqcloud.com/547d7faaadae11e78791525400a3183e.png)

### PostgreSQL 支持哪些告警：控制台—云监控—告警策略？
云数据库已支持关键性能指标的短信、邮件、站内信等告警。
欢迎登陆腾讯云管理中心> [云监控](https://console.cloud.tencent.com/monitor/overview) > [告警策略](https://console.cloud.tencent.com/monitor/policylist/add) 。
进行设置。

### PostgreSQL 监控功能是怎样的：控制台—实例管理—系统监控?
__性能监控__ 
为方便用户查看和掌握实例的运行信息，PostgreSQL提供了丰富的性能监控项，用户可进入PostgreSQL管理控制台对应【实例管理】-【系统监控】查看。
您还可以通过pg_stat_statements视图查询pg详细性能指标。

 __已提供监控指标__ 
 
| 指标中文名 | 指标英文名 | 指标含义 | 指标单位 |
|:--:|:--:|:--:|:--:|
| CPU利用率 | cpu | 实例CPU使用率，由于在闲时采用灵活的CPU限制策略，CPU利用率可能大于100% | % |
| 已用存储空间 | storage | 实例占用磁盘的可用空间 | GB |
| 磁盘IOPS | iops | 实例的IOPS（每秒的请求次数) | 次/秒 |
| 输入流量 | in_flow | 实例读写输入的流量 | KB/秒 |
| 输出流量 | out_flow | 实例读写输出的流量 | KB/秒 |
| 连接数 | connections | 实例的活跃连接历史变化趋势 | 个 |
| 请求数 | read_write_calls | 读写（增删改查）请求每分钟总数 | 次/分钟 |
| 读请求数 | read_calls | 读请求每分钟总数 | 次/分钟 |
| 写请求数 | write_calls | 写请求每分钟总数 | 次/分钟 |
| 其他请求数 | other_calls | 除了读和写以外的请求总数（如Drop），按分钟累加 | 次/分钟 |
| 缓冲区缓存命中率 | hit_percent | 数据缓存命中率 | % |
| 平均执行时延 | sql_runtime_avg | 所有SQL请求的平均执行时间，不包含事务里面的SQL。 | ms |
| 最长TOP10执行时延 | sql_runtime_avg | 执行时间最长的top10的SQL的平均值 | ms |
| 最短TOP10执行时延 | sql_runtime_min | 执行时间最短的top10的SQL的平均值 | ms |
| 剩余XID数量 | remain_xid | 剩余的Transaction Id数量，Transaction Id最大有2^32个，小于1000000建议手工执行vacuum full。 | 个 |
| 主备XLOG同步差异 | xlog_diff | 每分钟采样，主备XLOG的同步的大小差异，代表着同步的延迟，越小越好。 | byte |

### PostgreSQL 不提供超级管理员帐号吗?
1.PostgreSQL已提供账号已经包括创建、修改数据库、创建、修改账号等权限，但不提供超级管理员帐号。
2.外网地址建议仅用于日常维护，不宜用于对接业务服务器。
3.创建实例后，所属网络即不可修改。
4.为什么磁盘占用空间大于实际数据量？
更新导致xlog日志剧增，系统来不及归档和删除，占用了磁盘空间。
或者查询操作含有大数据量的排序、连接等操作，处理过程中产生临时表并溢出到磁盘，短时间内造成大量空间占用。
5.如何开启或使用插件
腾讯云postgresql已支持大部分常用插件，可直接使用。
而部分插件开启需要超级管理员权限，可到腾讯云控制台开启。或联系腾讯工作人员说明实例ID和插件名称即可开启。









