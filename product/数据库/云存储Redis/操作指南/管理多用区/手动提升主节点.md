云数据库 Redis 为多可用区部署的实例提供手动提主功能，标准架构与集群架构的实例均支持，您可以根据业务的部署要求将主节点部署到指定的可用区或者指定的副本（组）。

## 标准架构提主
多可用区部署的标准架构实例，您可以通过提主功能将指定的节点提升为主节点，一个实例只能有一个主节点。

提升为主节点或主可用区工作流程：
1. 提升副本节点为主节点，如果节点是主节点，忽略该步骤。
2. 将该可用区标记为主可用区。

### 操作步骤
1. 登录 [Redis 控制台](https://console.cloud.tencent.com/redis)，在实例列表，单击实例 ID，进入实例管理页面。
2. 在实例管理页面，选择【节点管理】页，在节点列表单击【提升为主节点或主可用区】。
![](https://main.qcloudimg.com/raw/aea261c9cd9e06d61540207c77461fd1.png)
3. 在弹出的对话框，确认无误后，单击【确定】。
![](https://main.qcloudimg.com/raw/b3df61d4c567a5e7f0b20a8d86cdcfd4.png)

## 集群架构提主
对于单个分片有多个副本的集群架构实例，我们将主节点和多个副本划分到不同节点组，以便于对节点进行管理，每个节点组都有一个节点组名称。

多可用区部署的集群架构实例，您可以将指定节点组内的所有节点提升为主节点组，当节点组内某些分片的主节点切换到其他节点组后，您可以通过提主功能，将所有的主节点回切到指定的节点组。

提升为主节点组工作流程：
1. 提升节点组中所有节点为主节点，如果节点组内的节点为主节点，忽略该步骤。
2. 将该节点组标记为主节点组，故障恢复后系统将自动提升组内的副本为主节点。
3. 将该可用区标记为主可用区。

### 原理说明
- 提升为主节点（组）的原理是在集群中执行 cluster failover 命令，标准架构也支持 cluster failover 命令。
- 提主过程中服务会有短暂访问抖动，抖动的时间在几秒到3分钟以内，切换过程中 BLPOP、BRPOP、BRPOPLPUSH、SUBSCRIBE 等阻塞命令会有一次或者多次失败。
- 提主过程可能会失败，通常重试即可执行成功。
- 切换主节点后，您的访问可能会跨可用区，导致访问延迟增加，[QPS](https://cloud.tencent.com/document/product/1121/36888#Q) 降低。

### 操作步骤
1. 登录 [Redis 控制台](https://console.cloud.tencent.com/redis)，在实例列表，单击实例 ID，进入实例管理页面。
2. 在实例管理页面，选择【节点管理】页，在节点列表右侧单击【提升为主节点组】。
![](https://main.qcloudimg.com/raw/34452c289c33e917539090fb4f2e94ca.png)
3. 在弹出的对话框，确认无误后，单击【确定】。
![](https://main.qcloudimg.com/raw/55eb8da2ced4ab108599a178d46387c6.png)
