
## 规格系列
### 内存版
<table>
<thead><tr>
<th>功能</th><th colspan="2" >标准架构</th><th>集群架构</th></tr></thead>
<tbody><tr>
<td>兼容 Redis 版本</td><td>2.8</td><td>4.0、5.0</td><td>4.0、5.0</td></tr>
<tr>
<td>内存规格</td><td>256MB - 64GB</td><td>1GB - 64GB</td><td>2GB - 8TB</td></tr>
<tr>
<td>分片数</td><td>不支持</td><td>不支持</td><td>1 - 128</td></tr>
<tr>
<td>QPS</td><td>8万 - 10万</td><td>8万 - 10万</td><td>(8万 - 10万)/分片</td></tr>
<tr>
<td>最大连接数</td><td>40000</td><td>40000</td><td>40000/分片</td></tr>
<tr>
<td>流量限制</td><td>10MB/S - 64MB/S</td><td>10MB/S - 64MB/S</td><td>144MB/s - 6GB/s</td></tr>
<tr>
<td>多 DB</td><td>支持</td><td>支持</td><td>支持</td></tr>
<tr>
<td>Mget、Mset</td><td>支持</td><td>支持</td><td>支持</td></tr>
<tr>
<td>lua</td><td>支持</td><td>支持</td><td>支持（不支持跨 Slot 访问）</td></tr>
<tr>
<td>水平扩容</td><td>不支持</td><td>不支持</td><td>支持</td></tr>
<tr>
<td>副本扩展</td><td>不支持</td><td>支持 </td><td>支持</td></tr>
<tr>
<td>读写分离</td><td>不支持</td><td>支持</td><td>支持</td></tr>
<tr>
<td>支持 GEO</td><td>不支持</td><td>支持</td><td>支持</td></tr>
<tr>
<td>副本数</td><td>0 - 1</td><td>1 - 5</td><td>1 - 5</td></tr>
</tbody></table>

>?256MB规格为入门尝鲜版本，仅适用于测试环境验证使用，不建议在生产环境中使用，因此暂不支持其他规格缩容至256MB规格。

### CKV 版
<table>
<thead>
<tr><th width=20%>功能</th><th width=30%>标准架构</th><th width=50%>集群架构</th></tr></thead>
<tbody><tr>
<td>兼容 Redis 版本</td><td>3.2</td><td>3.2</td></tr>
<tr>
<td>内存规格</td><td>4GB - 384GB</td><td>12GB - 48TB</td></tr>
<tr>
<td>分片数</td><td>-</td><td>3 - 128</td></tr>
<tr>
<td>QPS</td><td>8万 - 12万</td><td>千万级</td></tr>
<tr>
<td>最大连接数</td><td>12000 - 24000</td><td>12000/分片 - 24000/分片</td></tr>
<tr>
<td>流量限制</td><td>16MB/S - 256MB/S</td><td>72MB/S - 32GB/S</td></tr>
<tr>
<td>多 DB</td><td>支持</td><td>支持</td></tr>
<tr>
<td>Mget、Mset</td><td>支持</td><td>支持</td></tr>
<tr>
<td>lua</td>
<td>支持</td><td>有限支持（集群版中使用 lua，需要业务确定 lua 脚本中访问的 Key 都在相同的 Slot 中，并且要在命令参数中带上 Key 字段）</td></tr>
<tr>
<td>水平扩容</td><td>不支持</td><td>支持</td></tr>
<tr>
<td>副本扩展</td><td>不支持</td><td>不支持</td></tr>
<tr>
<td>读写分离</td><td>不支持</td><td>不支持</td></tr>
<tr>
<td>支持 GEO</td><td>支持</td><td>支持</td></tr>
</tbody></table>

### 实例规格对应连接数和流量
#### 内存版
| 规格（GB） | 最大连接数 | 最大吞吐量（MB/s） |
|  :----------: |  :----------: |  :-------------------: |
| 0.25          | 3000       | 10                  |
| 1          | 40000       | 16                  |
| 2          | 40000       | 24                  | 
| 4          | 40000       | 24                  |
| 8          | 40000       | 24                  |
| 12         | 40000       | 32                  | 
| 16         | 40000       | 32                  | 
| 20         | 40000       | 48                  |
| 24         | 40000       | 48                  | 
| 32         | 40000       | 48                  | 
| 40         | 40000       | 64                  | 
| 48         | 40000       | 64                  | 
| 60         | 40000       | 64                  | 

#### CKV 版
| 规格（GB） | 最大连接数 | 最大吞吐量（MB/s） | 
|  :----------: |  :----------: |  :-------------------: |
| 4          | 10000       | 24                  |
| 8          | 10000       | 24                  |
| 16         | 10000       | 32                  | 
| 24         | 10000       | 32                  | 
| 32         | 10000       | 32                  | 
| 48         | 18000      | 64                  | 
| 64         | 18000      | 64                  | 
| 80         | 18000      | 64                  |
| 96         | 18000      | 64                  | 
| 128        | 24000      | 128                 | 
| 160        | 24000      | 128                 | 
| 192        | 24000      | 128                 | 
| 256        | 24000      | 256                 | 
| 320        | 24000      | 256                 | 
| 384        | 24000      | 256                 | 

集群版连接数 = 分片连接数 * 分片数
集群版吞吐量 = 分片吞吐量 * 分片数
>!9000连接数的老实例，经过扩容或降配后连接数会自动变成10000。

## 性能数据
### 性能参考值
因 Redis 命令的执行耗时各不相同，在生产环境中，不同业务对数据库操作命令不同，所以对应性能也会有差别，本文给出的测试数据是在指定参数下的一个参考值，仅作为一个参考依据，实际情况需要业务真实的测试。

#### 单节点测试性能
|  Redis 实例规格 | 连接数 | QPS 值 |
|:---------:|:---------:|:--------:|
| 内存版（标准架构）8GB | 10000 | 8万 - 10万 |
| 内存版（集群架构）8GB（单分片） | 10000 | 8万 - 10万 |
| CKV 版（标准架构）8GB|  12000    |   8万 - 12万  |

#### 集群架构测试性能
内存版（集群架构）性能 = 内存版（标准架构）性能 * 分片数
CKV 版（集群架构）性能 = CKV 版（标准架构）性能 * 分片数

### 测试方法
#### 测试环境
| 压测客户端 CVM 数量 | CVM 核数 | CVM 内存 | 区域 | Redis 实例大小 |
|:---------:|:---------:|:---------:|:---------:|:---------:|
| 3 | 2核 |8GB | 广州二区 |内存版（标准架构）8GB | 
| 3 | 2核 |8GB | 广州二区 |CKV 版（标准架构）8GB|

#### 测试参数
 ```
redis-benchmark -h 10.66.187.x -p 6379 -a crs-1znib6aw:chen2016 -t set -c 3500 -d 128 -n 25000000 -r 5000000
redis-benchmark -h 10.66.187.x -p 6379 -a crs-1z5536aw:chen2016 -t set -c 3500 -d 128 -n 25000000 -r 5000000
redis-benchmark -h 10.66.187.x -p 6379 -a crs-090rjlih:1234567 -t set -c 3500 -d 128 -n 25000000 -r 5000000
```

#### QPS 计算
汇总3台压测客户端 redis-benchmark 的 QPS 之和。

