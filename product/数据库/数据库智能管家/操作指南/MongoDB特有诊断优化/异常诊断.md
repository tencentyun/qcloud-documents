## 操作场景
异常诊断功能为用户的数据库实例提供实时的性能监控、健康巡检、故障诊断和优化，让用户既可以直观地感知数据库实例实时的运行状况，也可以定位实时出现的性能异常，并根据优化建议进行系统优化。异常诊断提供实时和历史两种查看方式。
本文将介绍如何使用该功能诊断和优化 MongoDB 数据库实时/历史异常。

## 操作步骤
1. 登录 [DBbrain 控制台](https://console.cloud.tencent.com/dbbrain/analysis)，在左侧导航选择**诊断优化**，在上方选择对应数据库，然后选择**异常诊断**页。
全局显示信息如下：
![](https://qcloudimg.tencent-cloud.cn/raw/cc7ae4423c6bf8c80e91a8a5c0200279.png)
2. 查看概览模块。
 1. 在**异常诊断**页中的**概览**模块，单击**实时**或者**历史**，可以选择查看数据范围，同时将鼠标悬浮在数据打点处，上下滚动鼠标滑轮，也可以放大或者缩小显示时间范围。
DBbrain 会对用户的数据库情况进行 AI 健康评估，得出**健康得分**结合。
![](https://qcloudimg.tencent-cloud.cn/raw/f4da43344d1af663248631f9231f41cf.png) 
 2. 单击对应的数据点，可以查看单个数据点的事件详情。 
![](https://qcloudimg.tencent-cloud.cn/raw/4c8399d91e75f70fc071eafb12bdc0e7.png)
3. 查看实时/历史 SQL。
 1. 在**异常诊断**页中的**实时/历史 SQL** 模块，查看 SQL 的实时数据，包括 aggregate 请求个数、command 请求个数、count 请求数、delete 请求个数、getmore 请求数、insert 请求数、read 请求个数、update 请求个数。
 2. 在**异常诊断**页中的**实时/历史慢 SQL** 模块，查看慢 SQL 请求数和集群最大 CPU 请求率。
![](https://qcloudimg.tencent-cloud.cn/raw/821a663ab8cef4a0e118d8e4150fec93.png)
4. 查看诊断提示。
在**异常诊断**页中的**诊断提示**模块，查看诊断建议。
 - DBbrain 会定期（每10分钟）的对实例进行健康巡检，并将巡检结果分不同级别提醒到用户，风险级别分为致命、严重、告警和提示。用户可以在下方的**诊断详情**中，查看提示的事件详情，包括开始时间，诊断项和持续时间。
 - 对于不需要处理的告警，用户可以进行忽略，将鼠标悬浮在对应事件，单击**忽略**。忽略后，该实例由相同原因产生的诊断项告警也将被忽略。忽略后告警项不再显示。
>?忽略功能仅针对诊断项为非“健康巡检”的异常告警。
 - 对于需要处理的事件，可以将鼠标悬浮在对应事件上，单击**查看**，跳转到事件详情页。
<img src="https://qcloudimg.tencent-cloud.cn/raw/45927180998a6e03ef535211dc6fcffa.png" style="zoom:80%;" />
