本文为您介绍如何通过 TDSQL-C MySQL 版控制台开启数据库代理。

数据库代理是位于云数据库服务和应用服务之间的网络代理服务，用于代理应用服务访问数据库时的所有请求。数据库代理提供自动读写分离、连接池、连接保持、一致性级别设置等高级功能，具有高可用、高性能、可运维、简单易用等特点。

## 注意事项
- 数据库代理目前支持的地域：
  - 北京（除一、二、四区）、上海（除一区）、广州（除一、二区）、成都、重庆、南京、香港（除一区）。
  - 东京（除一区）、弗吉利亚（除一区）、硅谷（除一区）、首尔（除一区）、新加坡（除一、二区）。
- 数据库代理目前支持的版本：MySQL 5.7（内核小版本须2.0.19及以上），MySQL 8.0（内核小版本须3.1.5及以上），升级集群内核小版本会同时升级所关联的读写实例、只读实例，请参见 [升级内核小版本](https://cloud.tencent.com/document/product/1003/61541)。
- 若集群设置为多可用区部署，则暂不支持开启数据库代理功能。

## 操作步骤
1. 登录 [TDSQL-C MySQL 版控制台](https://console.cloud.tencent.com/cynosdb/mysql)，在集群列表，选择需要开启代理的集群，单击集群 ID 或**操作**列的**管理**，进入集群管理页面。
2. 在集群管理页面，选择**数据库代理**页，单击**立即开启**。
![](https://qcloudimg.tencent-cloud.cn/raw/7c9d7fa45963aaf3b28b942d6d785514.png)
3. 在弹出的对话框，选择规格节点，单击**确定**。
    - 网络类型：仅支持私有网络 VPC，默认与主实例保持一致。
    - 代理规格：2核4000MB内存、4核8000MB内存、8核16000MB内存。
    - 节点个数：代理节点个数，推荐代理个数为：主实例和只读实例 CPU 核数之和的 1/8（向上取整），例如主实例为4核 CPU，只读实例为8核 CPU，则推荐代理数量 = (4 + 8 ) / 8 ≈ 2。
    - 连接池状态：连接池详细介绍请参见 [连接池概述](https://cloud.tencent.com/document/product/1003/76788)。
    - 安全组：是重要的网络安全隔离手段，可根据需要选择已有安全组或新建安全组。
<img src="https://qcloudimg.tencent-cloud.cn/raw/8e90db5e299b37f838467ee0e7aa5e64.png"  style="zoom:90%;"> 
4. 开通成功后，可在数据库代理页查看基本信息，管理代理节点，也可在连接地址项对数据库代理地址、网络类型修改和添加备注。
>?
>- 您可通过查看代理节点列表的**连接数**或查看各代理节点的性能监控，来判断各节点是否出现访问不均衡现象。若出现各代理节点连接数不均衡的现象，可单击**重新负载均衡**打散连接。
>- 重新负载均衡会触发代理节点重启，重启过程中会有短暂服务不可用现象，建议在低峰期重启服务，请确保业务具备重连机制。
>
![](https://qcloudimg.tencent-cloud.cn/raw/51781787755fcf5d8087c67eaf88ceff.png)
