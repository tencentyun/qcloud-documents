
## 操作场景
本文档指导您在需要升级云数据库 MySQL 引擎版本时，通过操作控制台进行版本升级。
云数据库 MySQL 支持以下版本的数据库引擎升级：
- MySQL 5.5 到 MySQL 5.6
- MySQL 5.6 到 MySQL 5.7

>?
>- 不支持降级数据库引擎版本。
>- 不支持跨主要版本升级，例如将 MySQL 5.5 实例升级到 MySQL 5.7 或更高版本，您必须先将实例升级到 MySQL 5.6。
>- 暂不支持 MySQL 5.7 升级到 MySQL 8.0。 

## [版本升级规则](id:shengjiguize)
- 不支持`create table …  as select …`语法。
- 云数据库 MySQL 5.6、5.7 主从同步基于 GTID 实现，默认仅支持 InnoDB 引擎。
- 从 MySQL 5.5 版本升级到 MySQL 5.6，若最近一次全量备份为逻辑冷备，升级过程中会将 MyISAM 引擎的表转换为 InnoDB，**建议您升级前先完成 MyISAM 到 InnoDB 的转换**。
- 升级期间，云数据库 MySQL 会清空 slow\_log  表。如果要保留日志信息，请在升级主要版本之前保存日志内容。
- **若待版本升级的实例有关联其他实例（主实例、只读实例等），为保证数据复制一致性，会连同一起进行版本升级**。
- 云数据库 MySQL 版本升级会涉及到数据搬迁，通常需要较长时间，请您耐心等待，期间您的业务不受影响，可以访问。
- 版本升级完毕时会涉及实例切换（即秒级 MySQL 数据库连接断开），建议程序有自动重连功能，并且建议选择实例可维护时间内做切换。有关维护时间请参考 [设置实例维护时间](https://cloud.tencent.com/document/product/236/10929)。
- 单个实例的表数量超过100万后，可能会造成升级失败，同时也会影响数据库监控，请合理规范表的数量，控制单个实例表数量不超过100万。

## 操作步骤
1. 登录 [MySQL 控制台](https://console.cloud.tencent.com/cdb/)，在实例列表，选择需要升级的实例，在**操作**列选择**更多** > **升级版本**。
>?MySQL 8.0 无法升级到更高版本。
>
2. 在弹出的对话框，选择需要的数据库版本，单击**升级**。
数据库版本升级涉及到数据搬迁，所以在升级完成时会发生秒级的 MySQL 数据库连接闪断。可在发起升级时选择切换时间为**维护时间内**，会在实例升级完成后的下一个**维护时间**内发起切换。
>!选择切换时间为**维护时间内**时，数据库规格升级完成时不会立即切换，会保持同步直到实例的**维护时间**内发起切换，因此可能会延长整个实例升级所需时间。
>
![](https://main.qcloudimg.com/raw/2070a05eb6c50420b9e99056d69a0dfb.png)

## 热点问题
#### 升级前，云数据库 MySQL 是否会自动进行数据备份？
云数据库每天实时双机热备，基于数据备份 + 日志备份（binlog）可支持7日内 - 732日内无损恢复。

#### 云数据库可以从 MySQL 5.7 降级到 MySQL 5.6 吗？
不支持降级。如您需要 MySQL 5.6 版本，可以先销毁/退货 MySQL 5.7 实例，再重新购买 MySQL 5.6 实例，给您造成的不便，敬请谅解。

#### 升级期间，是否会出现主备延迟问题？
主实例升级会有数据对比，有可能产生主备延迟。

#### 版本升级完毕时会涉及实例切换，会影响云数据库 MySQL 实例的正常使用吗？
实例的正常升级流程不会影响您的使用，但实例连接会有秒级闪断，建议程序有自动重连功能，并选择实例可维护时间内做切换。

#### 云数据库 MySQL 版本升级需要多长时间？在哪里可以查看升级进度？
数据库的升级时间和您当前数据库中的数据量的大小以及数据复制等有关，因此无法给出具体时间。
云数据库 MySQL 版本升级会涉及到数据搬迁，通常需要较长时间，请您耐心等待，期间您的业务不受影响，可以访问。

#### 为什么实例一直是“升级待切换”的状态？
有可能是您切换时间选择的是**维护时间内切换**，实例在升级完成后，将在维护时间内进行切换操作。
如您需立即切换，可在实例列表的**操作**列单击**立即切换**，切换会有秒级别闪断，请确保业务具备重连机制。
