## 操作场景
针对业务连续服务和数据可靠性有强需求或是监管需要的场景，云数据库 MySQL 提供跨地域灾备实例，帮助用户以较低的成本提升业务连续服务的能力，同时提升数据的可靠性。
>?灾备实例费用与主实例相同，请参见 [产品定价](https://buy.cloud.tencent.com/price/cdb)。

#### 功能特点
- 提供独立的数据库连接地址，灾备实例可提供读访问能力，用于就近接入、数据分析等场景，设备冗余成本低。
- 使用主备高可用架构，避免了数据库的单点风险。
- 灾备实例通过内网专线同步，具有较低的同步时延和更高的稳定性，同步链路质量远优于公网网络。
- 目前推广期专线流量费用免费，商业化收费时间将另行通知。

#### 工作原理
- 腾讯云数据库用做灾备数据库的场景下，灾备实例是主实例数据库的复制备份。
- 当主实例发生变化，记录修改的 Log 日志信息会被复制到灾备实例，然后利用日志重放实现数据同步。
- 如果主实例发生故障，可在数秒内激活灾备实例，恢复完整读写功能。

## 功能限制
- 单节点云盘版实例不支持创建灾备实例。
- 仅支持1GB内存、50GB硬盘及以上规格，且 MySQL 5.6 及以上版本、InnoDB 引擎的高可用版主实例购买灾备实例，若主实例低于此规格，请先升级主实例规格。且主实例须已开启 GTID 功能。
>?若未开启 GTID，可通过 [控制台](https://console.cloud.tencent.com/cdb/) 实例详情页开启 GTID。开启 GTID 过程耗时较长，且实例将会有几秒钟的闪断，建议在业务低谷期操作，并在访问数据库的程序中添加重连机制。
- 灾备实例最低规格要求为1GB内存、50GB硬盘，且必须大于或等于主实例已使用存储规格的1.1倍。
- 一个主实例最多可以创建1个灾备实例。灾备实例在隔离状态期间，亦不可再创建灾备实例。
- 灾备实例暂不支持：转移项目、回档、SQL 操作、更改字符集、帐号管理、更改端口、数据导入、回档日志、只读实例功能。

## 创建灾备实例
1. 登录 [MySQL 控制台](https://console.cloud.tencent.com/cdb/)，在实例列表，单击实例 ID 或**操作**列的**管理**，进入详情页。
2. 在实例详情页的基本信息中确认 GTID 功能开启，在实例架构图中单击**添加灾备实例**，进入灾备实例购买页。
![](https://qcloudimg.tencent-cloud.cn/raw/8fcf10f10f83d0dc301a9fdd166df965.png)
3. 在购买页中，设置灾备实例的**计费模式**、**地域**等基本信息。
 >?
>- 创建时长受数据量的影响，期间主实例的控制台操作会被锁定，请妥善安排。
>- 同步策略为立即同步，即创建完灾备实例后会立即同步数据。
>- 暂只支持整个实例的数据同步，请确保磁盘空间充足。
>- 请确保主实例状态为运行中并且没有任何运行相关变更任务执行，如升降配、重启等，否则同步任务有可能失败。 
>
4. 确认无误后，单击**立即购买**，待灾备实例发货。
5. 返回实例列表，待实例状态变为**运行中**，即可进行后续操作。

## 管理灾备实例
- **查看灾备实例**
灾备实例可在其所在地域查看，可在实例列表筛选出该地域全部灾备实例。
![](https://qcloudimg.tencent-cloud.cn/raw/a4c71252422950f30c07556dfd37d707.png)
- **查看从属关系**
单击每个灾备实例或主实例右方的图标，即可查看从属关系。
![](https://qcloudimg.tencent-cloud.cn/raw/1de39a4e6e7ade57022e66a1af22062c.png)
- **查看同步延迟**
可在灾备实例的实例详情页上方查看到主实例和灾备实例之间的同步延迟。
![](https://qcloudimg.tencent-cloud.cn/raw/164617857ea6e611f614d4c8983eead8.png)
- **灾备实例功能**
灾备实例提供实例详情、实例监控、数据库管理、安全组、备份恢复等功能。
 
## 灾备实例升级为主实例
当您需要切换灾备实例为主实例时，可在控制台主动切换灾备实例为主实例。
>!
>- 将灾备实例升级为主实例后，灾备实例将成为新的主实例接管运行，新主实例的访问地址会变更，需在业务端重新设置新的访问地址，同时原来的主实例不再承担现有业务。
>- 灾备实例切换为主实例后，将断开与原主实例的同步连接，同步连接断开后不可重连，请谨慎操作。
>
1. 在 [实例列表](https://console.cloud.tencent.com/cdb)，选择需要升级为主实例的灾备实例，单击实例 ID，进入实例管理页面。
2. 在实例管理页面，单击右上角的**切换为主实例**，即可将灾备实例升级为主实例。切换后将断开与原主实例的同步连接，恢复实例数据库数据写入能力和完整的 MySQL 功能。
![](https://qcloudimg.tencent-cloud.cn/raw/922f613e950d5ec3c607058676f014ba.png)


