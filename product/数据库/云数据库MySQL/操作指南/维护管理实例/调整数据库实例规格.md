云数据库 MySQL 支持通过控制台快捷调整实例规格，提供灵活的扩缩容操作。您可根据业务所处的实际情况（业务初期、业务快速发展期、业务高峰期、业务低谷期等）灵活的调整 MySQL 实例的规格，从而更好地满足资源充分利用和成本实时优化等需求。调整费用变更请参见 [调整实例费用说明](https://cloud.tencent.com/document/product/236/36350)。

## 实例硬盘超限说明
- 为保障您业务正常进行，当硬盘空间快要满时，请及时升级数据库实例规格或者购买硬盘空间。
>?硬盘空间可在 [MySQL 控制台](https://console.cloud.tencent.com/cdb) 实例详情页查看，您也可通过 [配置告警](https://cloud.tencent.com/document/product/236/8457) 及时接收硬盘告警消息。
- 实例存储数据量超过实例，实例会被锁住，仅能读取数据不能写入，需扩容或在控制台删除部分数据库表解除只读。
- 为避免数据库重复触发锁定状态，仅当实例剩余空间大于20%或大于50GB时，实例会解除锁定状态，恢复正常读写功能。

## 变配介绍
用户在控制台变更实例配置后，系统会通过数据迁移的方式来完成变更，默认情况下为普通变配，如果本地（即实例所在的宿主机）剩余资源充足，也可选择极速变配。变配流程如下：
![](https://qcloudimg.tencent-cloud.cn/raw/0e8db8b9796877aed2417e5f44064322.png)
- **普通变配**：通过将当前宿主机的实例数据迁移至新宿主机的实例来完成变配，期间需要迁移数据、对比校验数据，数据量级较大时，变配整体耗时较长，且调整配置完毕时可能会涉及实例切换。
- **极速变配**：在当前宿主机直接完成变配，不涉及数据迁移，减少了数据迁移的准备工作，整体变配耗时较短。
>!
>- 本地剩余资源充足，满足极速变配条件时，默认使用极速变配能力，如不需使用，则在调整配置页面进行关闭。（即在变配页面可选择开关“极速变配”按钮）。
>- 极速变配有可能会重启实例，变配过程中存在短暂的不可用状态。

## 注意事项
- RO 实例在开启独立 VIP 访问时，RO 实例不支持极速变配。
- RO 实例所在 RO 组存活实例数量小于等于延迟剔除最小实例数量时，RO 实例不支持极速变配。
- RO 实例所在 RO 组只有一个 RO 实例时，该 RO 实例不支持极速变配。
- 变配时，若实例小版本不是最新，则会先升级实例内核小版本至最新，升级小版本时极速变配能力会重启实例，是否涉及重启，您可以变配页面极速变配下的提示为准。

## [调整配置规则](id:guize)
- 云数据库 MySQL 实例及其所关联的只读实例和灾备实例处于正常状态下（运行中），并且当前没有任务执行时才能够发起调整配置操作。
- 调整配置过程中，不允许取消本次调整配置操作。
- 调整配置前后实例的名称、访问 IP、访问端口均不发生变化。
- 调整配置过程中，请尽量避免修改 MySQL 的全局参数、用户密码等操作。
- 调整配置过程中，可能会涉及到数据的搬迁，期间 MySQL 实例可正常访问，业务不受影响。
- 调整配置完毕时可能会涉及实例切换（即秒级 MySQL 数据库连接断开），建议程序有自动重连功能，并且选择实例可维护时间内做切换。请参见 [设置实例维护时间](https://cloud.tencent.com/document/product/236/10929)。
- MySQL 单节点 - 基础型，在调整配置过程中，存在大约15分钟实例不可用的情况，建议在业务低峰期操作。

## 实例规格和存储表
### 双节点/三节点（本地 SSD 盘）
<table class="table-striped">
<tbody>
<tr><th>隔离策略</th><th>CPU 和内存</th><th>最大 IOPS</th><th>存储空间</th></tr>
<tr>
<td rowspan="14">通用型</td>
<td>1核 1000MB</td><td>1200</td><td rowspan="10">25GB - 3000GB</td></tr>	
<tr>
<td>1核 2000MB</td><td>2000</td></tr>
<tr>
<td>2核 4000MB</td><td>4000</td></tr>
<tr>
<td>4核 8000MB</td><td>8000</td></tr>
<tr>
<td>4核 16000MB</td><td>14000</td></tr>
<tr>
<td>8核 16000MB</td><td>20000</td></tr>
<tr>
<td>8核 32000MB</td><td>28000</td></tr>
<tr>
<td>16核 32000MB</td><td>32000</td></tr>
<tr>
<td>16核 64000MB</td><td>40000</td></tr>
<tr>
<td>16核 96000MB</td><td>40000</td></tr>
<tr>
<td>16核 128000MB</td><td>40000</td><td rowspan="4">25GB - 6000GB</td></tr>
<tr>
<td>24核 244000MB</td><td>60000</td></tr>
<tr>
<td>32核 256000MB</td><td>80000</td></tr>
<tr>
<td>48核 488000MB</td><td>120000</td></tr>
<tr>
<td rowspan="26">独享型</td>
<td>2核 16000MB</td><td>8000</td><td rowspan="7">25GB - 3000GB</td></tr>	
<tr>
<td>4核 16000MB</td><td>10000</td></tr>
<tr>
<td>4核 24000MB</td><td>13000</td></tr>
<tr>
<td>4核 32000MB</td><td>16000</td></tr>
<tr>
<td>8核 32000MB</td><td>32000</td></tr>
<tr>
<td>8核 48000MB</td><td>36000</td></tr>
<tr>
<td>8核 64000MB</td><td>40000</td></tr>
<tr>
<td>12核 48000MB</td><td>36000</td><td rowspan="15">25GB - 6000GB</td></tr>
<tr>
<td>16核 64000MB</td><td>60000</td></tr>
<tr>
<td>12核 72000MB</td><td>40000</td></tr>
<tr>
<td>12核 96000MB</td><td>48000</td></tr>
<tr>
<td>16核 96000MB</td><td>60000</td></tr>
<tr>
<td>24核 96000MB</td><td>72000</td></tr>
<tr>
<td>16核 128000MB</td><td>60000</td></tr>
<tr>
<td>32核 128000MB</td><td>80000</td></tr>
<tr>
<td>24核 144000MB</td><td>76000</td></tr>
<tr>
<td>24核 192000MB</td><td>80000</td></tr>
<tr>
<td>32核 192000MB</td><td>90000</td></tr>
<tr>
<td>48核 192000MB</td><td>120000</td></tr>
<tr>
<td>32核 256000MB</td><td>100000</td></tr>
<tr>
<td>48核 288000MB</td><td>140000</td></tr>
<tr>
<td>48核 384000MB</td><td>140000</td></tr>
<tr>
<td>64核 256000MB</td><td>150000</td><td rowspan="2">25GB - 9000GB</td></tr>
<tr>
<td>64核 384000MB</td><td>150000</td></tr>
<tr>
<td>64核 512000MB</td><td>150000</td><td rowspan="2">25GB - 12000GB</td></tr>
<tr>
<td>90核 720000MB</td><td>150000</td></tr>
</tbody></table>	

## 通过控制台调整实例配置
1. 登录 [MySQL 控制台](https://console.cloud.tencent.com/cdb)，在实例列表，选择需要调整的实例，在**操作**列选择**更多** > **调整配置**。
2. 在弹出的对话框，选择调整后的配置，单击**提交**。
>?
>- 本地剩余资源充足时，会触发极速变配能力，即本页面的**极速变配**按钮会生效，供用户选择开启或关闭。
>![](https://main.qcloudimg.com/raw/6b748799ced5f4a079e2d5929af15ef4.png)
>- 部分极速变配场景不涉及重启，此时提交的变配会在调整配置完毕时即时生效。如下图：
![](https://main.qcloudimg.com/raw/c5a6655393390f749501d69641976149.png)
>
![](https://main.qcloudimg.com/raw/97fa5655a5e451456658c0797b163609.png)

## 通过 API 调整实例配置
用户可以使用 UpgradeDBInstance 接口调整实例配置，请参见 [调整云数据库实例的配置](https://cloud.tencent.com/document/product/236/15876)。

## 热点问题
#### 调整数据库实例规格，对实例有什么影响吗？
- MySQL 在调整配置过程中，可能进行数据迁移，期间实例访问不受影响；迁移完成后会进行切换，会有秒级别闪断，请确保业务具备重连机制。
- MySQL 单节点 - 基础型，在调整配置过程中，存在大约15分钟实例不可用的情况，建议在业务低峰期操作。

#### 为什么我的数据库无法降配？
可能是您的存储已经超过了硬盘最大容量，需要先清理下数据，让剩余空闲空间大于20%或者大于50G，才能进行降配操作。

#### 控制台调整配置后，为什么一直显示在“升级待切换”状态中？
有可能是您在 [控制台](https://console.cloud.tencent.com/cdb) 调整配置时，选择的**切换时间**为**维护时间内切换**，导致无法立即切换。
如您需立即切换，可在实例列表的**操作**列单击**立即切换**，切换会有秒级别闪断，请确保业务具备重连机制。

#### 调整实例规格，升级需要多长时间？
数据库的升级时间和您当前数据库中的数据量的大小以及数据复制速度有关，具体时间无法进行预估。
升级过程中不会影响您当前实例的正常使用，在升级完成切换 VIP 时会有秒级的瞬断。

#### 调整实例进度，在哪里可以查看？
您可在控制台的 [任务列表](https://console.cloud.tencent.com/mysql/task) 查看任务进度。

#### 硬盘空间即将用尽，怎么办？
用户硬盘空间使用达到85%以上，建议考虑删除无用数据或者扩容硬盘空间，通过 [控制台](https://console.cloud.tencent.com/cdb)（实例列表右侧**操作**列选择**更多** > **调整配置**）可以进行硬盘空间扩容。

#### 如何确认我的实例扩内存（扩容磁盘）支持极速变配？
您可在变配页面，通过查看极速变配开关状态判断是否可以使用极速变配能力，不需要使用时，可以手动关闭。不满足极速变配需求时，无法打开该能力。
![](https://main.qcloudimg.com/raw/6b748799ced5f4a079e2d5929af15ef4.png)

#### 扩容内存或者磁盘是否会影响实例的小版本？
当实例小版本不是最新的情况下，会升级实例内核小版本至最新，升级小版本时极速变配能力会重启数据库。

#### 极速变配是否会对实例重启？
在特定情况下，会重启实例，是否涉及重启，会在变配页面下方有相关提示，如下图：
![](https://main.qcloudimg.com/raw/a105869f7e8ded950ea06b0a25cc7ab9.png)
>?其中，在满足实例小版本是最新以及触发极速变配能力的情况下，仅变配磁盘不会重启。

#### 在控制台升级时，如何判断是否为极速变配？
您可通过变配页面的**极速变配**按钮是否打开来判断。
![](https://main.qcloudimg.com/raw/6b748799ced5f4a079e2d5929af15ef4.png)

#### API 接口变更配置时，如何判断是否为极速变配？
API 接口目前仅支持迁移方式进行变配升级，无法提供极速变配的指定，后续会提供 API 的能力。

#### 数据库变配时，是否会调整数据库参数？
会调整 innodb_buffer_pool_size 参数以适应配置的变化。

#### 数据库变配时，触发极速变配后，参数会调整吗？
与普通变配相同，参数会跟随实例规格的变化而调整。

#### 极速变配对比普通变配，有什么区别？
极速变配减少了数据迁移的时间。

