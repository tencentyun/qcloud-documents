云数据库 SQL Server 提供跨地域备份功能，支持将备份文件存放到另一个地域存储，帮助用户提升监管与容灾恢复能力，同时提升数据的可靠性。本文介绍跨地域备份功能。

## 操作场景
数据是企业运营的重要组成，信息化带来便利的同时，电子数据、存储信息极易损毁、丢失的特点也暴露了出来。而在自然灾害、系统故障、员工误操作和病毒感染面前，任意一次事故就有可能导致企业的运营中断，甚至灾难性损失。因此，确保核心数据的安全完整性，是每个企业必须考虑的。

云数据库 SQL Server 提供跨地域备份功能，用于将备份文件存储于其他地域，以达到最大程度避免自然灾害、系统故障等导致的数据损毁，跨地域备份可实现数据库恢复的高可用性，满足数据可用性及安全性、异地备份恢复、异地容灾、长期归档数据、监管等需求。

![](https://qcloudimg.tencent-cloud.cn/raw/81242ffa61dcab1c7d4c3d612d999526.png)

## 跨地域备份说明
- 跨地域备份不会影响本地默认备份，开启跨地域备份后，两者同时存在。
- 本地默认的自动备份完成后就会触发跨地域备份，即将默认的自动备份转储到跨地域备份存储设备上。
- 跨地域备份空间的备份文件由自动备份（包括数据备份及日志备份）组成，即本地自动备份同步至异地存储。
- 跨地域备份保留时长默认为7天，支持自定义保留时长，最小7天，最大1830天。
- 开启/关闭跨地域备份以及修改备份地域选项不会影响存量备份。
- 跨地域备份的保留天数仅影响跨地域存储的备份生命周期。
- 修改跨地域备份保留时长会影响历史存量跨地域备份的生命周期。
- 修改跨地域备份地域选项不影响存量跨地域备份的备份存储地域。
- 存储在异地的跨地域备份无法使用本地备份的免费存储空间。

## 计费说明
跨地域备份费用由**存储**和**流量**两部分组成。
即：**跨地域备份费用 = 跨地域备份存储费用 + 跨地域复制流量费用**

跨地域备份存储费用按照目的地域实行按量计费，跨地域复制流量费用基于源地域及目的地域间的链路进行按量计费。
详细计费说明和定价，请参见  [跨地域备份收费说明](https://cloud.tencent.com/document/product/238/77393)。

## 跨地域备份和同地域备份的区别

| 对比项 | 本地备份 | 跨地域备份 |
|---------|---------|---------|
| 是否默认开启 | 默认开启 | 默认关闭，需要手动开启 |
| 备份存储地域 | 备份存储在实例所在地域 | 备份存储在额外的目的地域 |
| 备份计量地域与计费地域 | 备份量计算到所属主实例所在备份地域 | 备份量计算到所属主实例所在备份地域，备份费用按照备份存储地域（即：所跨的目的地域）的备份价格来计算 |
| 计费生命周期 | <li>包年包月实例，默认在实例进入回收站后只保留7天，7天后随实例销毁<li>按量计费实例，默认在实例进入回收站后只保留3天，3天后随实例销毁 | <li>包月包月实例，默认在实例进入回收站后只保留7天，7天后随实例销毁<li>按量计费实例，默认在实例进入回收站后只保留3天，3天后随实例销毁 |
| 是否占用免费存储空间 | 可占用免费存储空间 | 不可占用免费存储空间 |
| 备份空间计费规则 | <li>如果备份大小未超过免费额度，备份不收费。超过后，`备份的每小时费用 = (备份文件总大小 - 免费额度) x 备份单价`<li>`计费空间（该地域）= 数据备份量<自动 + 手动>（该地域）+ 日志备份量<自动>（该地域）- 免费备份空间（该地域）`| <li>开启跨地域备份后，所产生的全部跨地域备份文件均会收费<li>`计费空间（所属主实例所在地域）= 数据备份量<自动>（目的地域）+ 日志备份量<自动>（目的地域）` |

## 跨地域备份支持的地域

| 源地域  | 支持备份到的目的地域 |
|---------|---------|
| 北京、广州、上海、成都、重庆、南京、北京金融、上海金融、深圳金融、香港 | 北京、广州、上海、成都、重庆、南京、北京金融、上海金融、深圳金融<br>支持备份至除源地域自身以外的地域，具体以控制台实际支持地域为准|


>?
>- 暂不支持源地域为中国大陆地域备份到中国香港地域。
>- 其他国家地域暂时不支持进行跨地域备份，如后续开放会同步更新。

## 通过控制台开启跨地域备份
1. 登录 [SQL Server 控制台](https://console.cloud.tencent.com/sqlserver)。
2. 在实例列表找到目标实例，单击实例 ID 或**操作**列的**管理**，进入实例管理页。
3. 在实例管理页选择**备份管理**，单击**跨地域备份设置**。
![](https://qcloudimg.tencent-cloud.cn/raw/45c994e1d31b785360822d2cdcb74cc2.png)
4. 在跨地域备份设置窗口，设置以下参数，单击**保存**。
![](https://qcloudimg.tencent-cloud.cn/raw/9ceb0908a19a191f7f3f6f57d32ed02a.png)
<table>
<thead><tr><th>参数</th><th>说明</th></tr></thead>
<tbody><tr>
<td>跨地域备份</td>
<td>跨地域备份功能的开关，单击按钮开启</td></tr>
<tr>
<td>备份地域</td>
<td>用于存储跨地域备份的地域，单击下拉键选择所需地域，可选择1 - 2个</td></tr>
<tr>
<td>跨地域备份保留时长</td>
<td>跨地域备份文件保留的时长，支持设置7 - 1830天</td></tr>
<tr>
<td>跨地域备份收费说明</td>
<td>开启跨地域备份会产生额外费用，阅读后勾选此项</td></tr>
</tbody></table>

## 修改跨地域备份设置
>?
>- 修改备份地域，不会影响存量备份的存储地域，只会影响新增备份的存储地域。
>- 修改跨地域备份保留时长，会影响存量跨地域备份的生命周期，也会影响新增跨地域备份的生命周期。

**方法一**
1. 登录 [SQL Server 控制台](https://console.cloud.tencent.com/sqlserver)。
2. 在实例列表找到目标实例，单击实例 ID 或**操作**列的**管理**，进入实例管理页。
3. 在实例管理页选择**备份管理**，单击**跨地域备份设置**。
4. 在跨地域备份设置窗口，修改备份地域和跨地域备份保留时长，单击**保存**。

**方法二**
1. 登录 [SQL Server 控制台](https://console.cloud.tencent.com/sqlserver)。
2. 在左侧导航栏选择**数据库备份**，在数据库备份页上方选择地域。
3. 在数据库备份页选择**概览 > 备份实时统计 > 跨地域备份**。
4. 在跨地域备份列表找到目标实例，单击其**操作**列的**跨地域备份设置**。
5. 在跨地域备份设置窗口，修改备份地域和跨地域备份保留时长，单击**保存**。

## 关闭跨地域备份
>?关闭跨地域备份后，将不生成新的跨地域备份文件，停止新增跨地域备份文件的计费。

**方法一**
1. 登录 [SQL Server 控制台](https://console.cloud.tencent.com/sqlserver)。
2. 在实例列表找到目标实例，单击实例 ID 或**操作**列的**管理**，进入实例管理页。
3. 在实例管理页选择**备份管理**，单击**跨地域备份设置**。
4. 在跨地域备份设置窗口，关闭跨地域备份按钮。
5. 在弹窗下选择保留或者清除存量备份，然后单击**确定关闭**。
![](https://qcloudimg.tencent-cloud.cn/raw/61b7e74ad1acf390c833553a94469814.png)
>?
>- 选择保留，则历史存量跨地域备份文件将按照所设置的跨地域备份保留时间进行保存及计费，跨地域备份保留时长在跨地域备份关闭前可以修改。
>- 选择清除，则历史存量跨地域备份文件将随之清除，即在关闭跨地域备份的同时也删除存量跨地域备份文件。

**方法二**
1. 登录 [SQL Server 控制台](https://console.cloud.tencent.com/sqlserver)。
2. 在左侧导航栏选择数据库备份，在数据库备份页上方选择地域。
3. 在数据库备份页选择**概览 > 备份实时统计 > 跨地域备份**。
4. 在跨地域备份列表找到目标实例，单击其**操作**列的**跨地域备份设置**。
5. 在跨地域备份设置窗口，关闭跨地域备份按钮。
6. 在弹窗下选择保留或者清除存量备份，然后单击**确定关闭**。
