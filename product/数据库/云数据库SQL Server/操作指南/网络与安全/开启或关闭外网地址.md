## 操作场景
云数据库 SQL Server 支持内网和外网两种地址类型，默认提供内网地址供您内部访问实例，如果需要通过外网地址访问，您需要开启外网地址，开启后也可根据需要关闭。

## 注意事项
- 开启外网地址后，您可以通过系统分配的域名和端口访问 SQL Server，生效时间大概需要5分钟。
- 外网访问开启后将受到安全组网络访问策略的控制，请提前配置好相应的策略，需要在安全组入站规则中配置访问数据库的来源信息，并放通协议端口（需同时放开内网和外网端口，内网端口默认为1433）。具体操作，请参见 [配置安全组](https://cloud.tencent.com/document/product/238/43287)。
- 开启外网地址后，您的数据库服务会暴露在公网上，可能导致数据库被入侵或攻击，不推荐正式业务连接使用外网（可能存在不可控因素导致外网连接不可用，例如 DDOS 攻击、突发大流量访问等）。建议您使用内网连接数据库。
- 通过外网地址访问实例，会降低实例的安全性，仅推荐用于开发、测试或辅助管理数据库，不提供可用性 SLA  保证。为了获得更快的传输速率和更高的安全性，建议使用内网地址连接数据库，外网不承担业务负载，如果需要承担业务负载，建议 [通过 CLB 开启外网服务](https://cloud.tencent.com/document/product/238/73132)。
- 目前开启外网地址和后续产生的公网流量暂不收费，但不保证外网带宽和流量稳定。
- 外网访问出现的故障，不会计入 SQL Server 服务的整体可用性计算。

## 前提条件
- 实例的网络为：VPC 网络。
- 实例所在地域：广州、上海、北京、成都、重庆、南京、中国香港、新加坡、首尔、东京、硅谷、法兰克福。
>!如遇以上地域不能开启外网，可 [提交工单](https://console.cloud.tencent.com/workorder/category) 申请。

## 内外网地址说明

| 地址类型 | 说明 | 
|---------|---------|
| 内网地址 | <li>内网地址是无法通过 Internet 外部设备访问的 IP 地址，是腾讯云内网服务的实现形式。<li>系统默认提供内网地址，无法关闭，支持切换网络类型。<li>若您部署的 CVM 云服务器实例与 SQL server 数据库实例属于同一个腾讯云主账号，位于同一地域，网络类型都是 VPC 且处于同一个 VPC，两实例间可通过内网地址互通，无需开启外网地址。<li>安全性高。 | 
| 外网地址 | <li>外网地址是 Internet 上的非保留地址。<li>外网地址需要手动开启，不需要时也可以关闭。 <li>外网地址会降低实例的安全性，请谨慎使用。<li>腾讯云以外的设备可通过开启外网地址来访问 SQL Server 实例。</li>| 

## 开启外网地址
1. 登录 [SQL Server 控制台](https://console.cloud.tencent.com/sqlserver)。
2. 选择地域，在实例列表单击需要开启外网的实例 ID 或**操作**列的**管理**。
3. 在**实例详情**页的**基本信息** > **外网地址**后，单击**开通**。
![](https://qcloudimg.tencent-cloud.cn/raw/ef7523cc555b9a7fa989f349d233b48e.png)
4. 在开通外网设置窗口阅读并勾选提示，单击**确定**（开通外网前系统会根据是否配置安全组给出不同提示）。
>!开启成功后，即可在基本信息中查看到外网地址。通过开关可以关闭外网连接权限，重新开启外网，域名对应的外网地址不变。
>
 - 绑定了安全组，且未涉及高风险策略，则可正常开通，提示如下：
 ![](https://qcloudimg.tencent-cloud.cn/raw/3c268ee0fbb73996d3aed968adaa92f9.png)
 - 绑定了安全组，但存在地址为`0.0.0.0/0`或`::/0`高风险入站规则时，提示如下：
 ![](https://qcloudimg.tencent-cloud.cn/raw/fb94d04e8eeb1187811a03c67aefe4bb.png) 
 - 未绑定安全组时，开通外网会触及高风险，提示如下：
 ![](https://qcloudimg.tencent-cloud.cn/raw/9a18b9e7c82870274836e9f344177d0f.png)
5. 待实例状态更新为**运行中**，即可在实例详情页查看外网地址。

## 关闭外网地址
1. 登录 [SQL Server 控制台](https://console.cloud.tencent.com/sqlserver)。
2. 选择地域，在实例列表单击需要开启外网的实例 ID 或**操作**列的**管理**。
3. 在**实例详情**页的**基本信息** > **外网地址**后，单击**关闭**。
4. 在关闭外网弹窗下，单击**确定**。
>!关闭后，您将无法通过外网域名和端口访问腾讯云 SQL Server，请确认您的系统没有使用外网访问地址，以免给您带来不必要的损失。
