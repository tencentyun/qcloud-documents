
## 集群版
### 支持版本
SQL Server 2017/2019 Enterprise

### 架构
云数据库 SQL Server 集群版采用 Always On 架构（包括一主一备），主备跨机架/跨可用区部署，每个库对应一组监控 Agent，通过心跳对数据库进行实时监控。
- 腾讯云管理集群：由独立部署的决策调度集群和配置集群组成，作为集群的管理调度中心，主要管理数据库节点组、接入网关集群、对象存储 COS 的正常运行。
- 对象存储：提供数据灾备服务，提供冷备数据。
- 接入网关集群：对外提供唯一的 IP，如果数据节点发生切换，用户连接实例的 IP 不会改变。


>?Always On 的基本同步过程：
>Primary 节点的日志（Commit、Log Block Write）会从 Log Cache 刷到磁盘，同时 Primary 节点的 Log Capture 也会将日志发送到其它所有 Replica 节点，对应节点的 Log Receive 线程将收到的日志同样从 Log Cache 刷到磁盘，最后由 Redo Thread 应用这些日志刷到数据文件。
>
![](https://main.qcloudimg.com/raw/e282782dd413238f1b2b6f7b9a0306b0.png)


## 双机高可用版
### 支持版本
- SQL Server 2008R2/2012/2014/2016/2017/2019 Enterprise
- SQL Server 2012/2014/2016/2017/2019 Standard

### 架构
云数据库 SQL Server 由一主一镜像（Mirror）的 SQL Server 数据库组成，跨机架/跨可用区部署，每个库对应一组监控 Agent，通过心跳对数据库进行实时监控。
- 腾讯云管理集群：由独立部署的决策调度集群和配置集群组成，作为集群的管理调度中心，主要管理数据库节点组、接入网关集群、对象存储的正常运行。
- 对象存储：提供数据灾备服务，提供冷备数据。
- 接入网关集群：对外提供唯一的 IP，如果数据节点发生切换，用户连接实例的 IP 不会改变。
- 只读实例的扩展通过发布订阅模式实现。

>?镜像（Mirror）具有完整的数据副本，本身不提供读写服务，通过接收来自 Principal 的更新日志实现数据同步，允许创建快照实现报表；在镜像集群中，Principal 和 Mirror 的数据同步依靠事务日志来实现，SQL Server 的事务日志是 Database 级别的，非实例级别，每个 Database 都具有单独的事务日志，SQL Server 的镜像是基于 Database 层面实现。

![](https://main.qcloudimg.com/raw/6d5bd0293f81a1f2d9a3f32ee908adc7.png)

## 基础版
### 支持版本
SQL Server 2008R2/2012/2014/2016/2017/2019 Enterprise

### 架构
基础版采用单个节点部署，价格低廉，性价比非常高。特点如下：
- 计算与存储分离，若计算节点故障，能够通过更换节点达到快速恢复的效果；底层数据采用云盘三副本存储，保证一定的数据可靠性，硬盘故障时可通过硬盘快照模式快速恢复。
- 基础版提供针对数据库连接、访问、资源等多维度20多余项监控，并可配置对应告警策略，相较于云服务器自建，更加省心；同时兼具极大价格优势，相较于云服务器节省成本开销；基础版节点部署在云服务器上，提供数据库性能比用户自建更好。
- 基础版底层存储介质使用高性能云盘，适用于90%的 I/O 场景，质优价廉，性能稳定。
>!
>- 基础版适用于个人学习、中小企业的 ISV 软件（如财务、CRM、ERP 等软件客户）、Web 类应用、企业非核心小型系统以及测试环境。
>- 由于基础版是单节点架构，当该节点出现故障，恢复时长比云服务器故障恢复稍长（涉及实例启动与数据恢复）。
>- 建议对高可用有要求的业务，使用双机高可用版或集群版。

![](https://main.qcloudimg.com/raw/89b7de103f8fe6e251f5dc58fc81cf34.svg)

