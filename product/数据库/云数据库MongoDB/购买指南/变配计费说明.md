
本文将对按量计费和包年包月的云数据库 MongoDB 实例，在变更配置时产生的费用进行详细说明。 

## 背景信息
变更实例的配置规格，包括：节点内存、存储容量、副本集节点数、分片集群的分片数量、单分片节点数等数据都会重新计费结算。

## 计费说明
### 升级实例配置
- 包年包月：系统将计算实例规格间的差价，并从用户的账户中扣除差价。升级配置后再续费将按照新的实例规格进行计费。若账户余额不足则需要先进行充值。
- 按量计费： 按量计费实例的计费周期为小时，系统将在下一个周期按照实例新的配置规格进行计费， 每个整点（北京时间）进行一次结算。

### 降级实例配置
#### 包年包月
- 计算差价公式：**退还金额 = 原配置剩余价值 - 新配置购买价值**。
  - 原配置剩余价值：原配置有效订单金额 - 原配置已使用价值。
    - 原配置有效订单金额指生效中订单的付款金额，不包含折扣和代金券。
    - 原配置已使用价值：发起降配当天，已满整月，按已使用整月的包年包月价格及对应的官网折扣进行扣除；不满整月的，按已使用时长的按量计费价格进行扣除。已使用部分精确到秒。
  - 新配置购买价值：指新配置当前官方价格 × 剩余使用时长。

>!
>- 单价和折扣按照系统当前的优惠为准。
>- 抵扣或代金券不予以退还。
>- 退还金额将以购买使用的现金和赠送金支付比例的方式返还到您的账户。
>- 退款金额 ≤ 0，按0计算，即退款金额为0。

#### 按量计费
系统按照第一阶梯在下一个整点（北京时间）按照实例新的配置规格开始计费，每个整点进行一次结算。  
- 0天＜时长 ≤ 4天，使用按量计费第一阶梯价格。
- 4天＜时长 ≤15天，使用按量计费第二阶梯价格。
- 时长＞15天，使用按量计费第三阶梯价格。

具体计费价格，请参见 [产品定价](https://cloud.tencent.com/document/product/240/8364)。

## 包年包月退费计算示例
2019年3月1日，企业 A 购买广州三区高 IO 万兆型、2核4GB、磁盘200GB副本集 MongoDB。
- 单价：880元/月。
- 折扣说明：购买1年，包年享83折。

则支付总价为： 880 × 12 × 0.83 = 8764.8元

### 情景一
2019年5月1日，需要将**已使用2个月**的高 IO 万兆型、2核4GB、磁盘200GB副本集 MongoDB，**降配**到2核4GB、磁盘100GB。
- 折扣说明：包月时长为2个月不打折，包月时长为6个 - 11个月可享受88折。
- 新配置规格单价：670元/月。

**计费计算公式**：
- 原配置剩余价值 = 原配置有效订单金额 - 原配置已使用价值 = 8764.8 - 880 × 2 = 7004.8（元）
- 新配置购买价值 = 新配置当前官方价格 × 剩余使用时长 = 670 × 10 × 0.88 = 5896（元）
- 实例降配退款金额 = 原配置剩余价值 - 新配置购买价值 = 7004.8元 - 5896元 = 1108.8（元）

### 情景二
2019年11月1日，需要将**已使用8个月**的高 IO 万兆型、2核4GB、磁盘200GB副本集 MongoDB，**降配**到2核4GB、磁盘100GB。
- 折扣说明：包月时长为6个 - 11个月可享受88折，已使用8个月可享受此优惠折扣。
- 新配置规格单价：670元/月。

**计费计算公式：**
- 原配置剩余价值 = 原配置有效订单金额 - 原配置已使用价值 = 8764.8 - 880 × 8 × 0.88 = 8764.8 - 6195.2 = 2569.6（元）
- 新配置购买价值 = 新配置当前官方价格 × 剩余使用时长 = 670 × 4 = 2680（元）
- 实例降配退款金额 = 原配置剩余价值 - 新配置购买价值 = 2569.6 - 2680 = -110.4（元 ）
  退款金额 ≤ 0，按0计算，即退款金额为0。

