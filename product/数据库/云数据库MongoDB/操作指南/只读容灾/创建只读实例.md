云数据库 MongoDB 支持在控制台创建只读实例，并进行管理。

## 背景信息
云数据库 MongoDB 支持用户创建一个或者多个只读实例，支持用户读写分离的应用场景，可减轻主实例请求压力，提高用户业务的读负载能力。
>? 
>- 各只读实例与主实例之间的同步时延可在控制台查看。
>- 由于数据同步有延迟，只读实例数据同步的实时性可能无法保证，如果业务需要读写分离并且对实时要求比较高，建议业务读取主实例的从节点，具体请参见 [连接 MongoDB 实例](https://cloud.tencent.com/document/product/240/3563#uri-.E6.96.B9.E5.BC.8F)。
>- 只读实例和主实例的连接方式相同，请参见 [连接示例](https://cloud.tencent.com/document/product/240/3563)。
>- 在只读实例生命周期内，只读实例只能读，不能进行数据写入更新操作。
>- 当只读实例跟主实例同步断开，或用户手动在控制台提升只读实例为主实例的时候，只读实例即转为普通实例，可以正常读写。

## 基础架构 
通过 oplog 将主实例的更改同步到只读实例。每个只读实例均采用至少一主两从的架构。架构请参考下图：
![](https://main.qcloudimg.com/raw/dd4316c0d814aabfb1f05bf337976c1c.svg)

## 版本说明
当前仅3.2、3.6、4.0版本的副本集实例支持创建只读实例。

## 使用限制 
- 一个主实例最多可以创建3个只读实例。
- 只读实例与主实例的引擎保持一致。
- 备份回档：不支持备份和回档功能。
- 数据迁移：不支持数据迁移至只读实例。
- 数据库管理：不支持创建\删除数据库。
- 帐号管理：不支持创建、删除帐号、修改帐号密码、帐号授权。

## 前提条件
- 已 [申请云数据库 MongoDB 实例](https://cloud.tencent.com/document/product/240/3551)。
- 实例状态运行正常。

## 操作步骤
### 查看只读实例
1. 登录 [MongoDB 控制台](https://console.cloud.tencent.com/mongodb/sharding)。
2. 在左侧导航栏，选择**NoSQL** > **MongoDB**。
3. 在 **MongoDB** 的下拉列表中，选择**副本集实例**或者**分片实例**。副本集与分片集群操作类似。
4. 在右侧实例列表页面上方，选择地域。
5. 在实例列表中，找到目标实例。
6. 单击目标实例 ID，进入**实例详情**页面。
7. 选择**只读容灾**页签，进入**只读实例**页签。
8. 查看当前实例下新增的只读实例。

### 新建只读实例
1. 在**只读实例**页签，单击**新建**。
2. 在**云数据库 MongoDB 只读实例**购买页面，确认**主实例信息**，选择所需配置。
3. 单击**立即购买**，购买后可返回只读实例页管理只读实例。
![](https://main.qcloudimg.com/raw/de7253338e01b5e0797b0a5d168df615.png)

### 调整只读实例配置
1. 在**只读实例**页签，找到需调整配置的只读实例。
2. 在其**操作**列，单击**配置调整**。
3. 在**配置调整**页面，可以重新调整节点规格、节点容量、Oplog 容量。
4. 在**切换时间**选项中，选择切换实例规格的具体时间。
   - 选择**调整完成时**，立即执行调整实例规格任务。
   - 选择**维护时间**，在维护时间段内执行切换实例规格任务。
> !**维护时间**一般设置在业务低峰期，需要对实例进行定期维护。选择**调整完成时**立即调整实例配置，可能涉及节点迁移或者主从切换，主从切换时间点将不可控，强烈建议调整实例配置在**维护时间**内进行。更多信息，请参见 [设置实例维护时间](https://cloud.tencent.com/document/product/240/19910)。
5. 单击**计费详情**，可查看计费项目、计费公式，确认**费用**。
6. 确认无误，单击**提交**。

### 给只读实例续费
1. 在**只读实例**页签，找到需续费的只读实例。
2. 单击实例列表上方的**续费**，在**续费所选实例**对话框，选择续费时长。
3. 确认续费总费用，单击**确定**。

### 设置自动续费
1. 在**只读实例**页签，找到需设置自动续费的只读实例。
2. 单击实例列表上方的**设置自动续费**，在**设置自动续费**对话框，确认自动续费项与续费到期时间。
3. 确认续费总费用，单击**确定**。

### 取消自动续费
1. 在**只读实例**页签，找到需取消自动续费的只读实例。
2. 单击实例列表上方的**取消自动续费**，确认实例信息。
3. 单击**确定**。

## 相关 API
| API 接口             | API 解释                                                      |
| ------------------- | ------------------------------------------------------------ |
| DescribeDBInstances | [查询云数据库实例列表](https://cloud.tencent.com/document/api/240/38568) |
| RenameInstance      | [修改实例名称](https://cloud.tencent.com/document/api/240/38563) |
| RenewDBInstances    | [续费云数据库实例](https://cloud.tencent.com/document/api/240/43595) |

