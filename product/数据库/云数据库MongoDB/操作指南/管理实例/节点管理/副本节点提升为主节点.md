## 操作场景

云数据库 MongoDB 的副本实例只能有一个主节点，可有多个副本节点。当发现主节点有异常时，可以主动提升副本节点为主节点，保证业务正常运行。对于分片实例，将所有分片节点及多个副本节点划分为一个主节点组与多个从节点组，在主节点组内某些分片节点异常，支持主动提升从节点组的所有节点为主节点组。

## 版本说明

MongoDB 4.4、4.2、4.0、3.6版本均支持提升主节点。

## 注意事项

提升为主节点将导致数据库当前已存在的 TCP 连接断开，操作之前请确认业务有自动重连机制。否则，需手动重新使用新的连接数据库。

## 前提条件

实例状态为：运行中。

## 操作步骤

1. 登录 [MongoDB 控制台](https://console.cloud.tencent.com/mongodb)。
2. 在左侧导航栏 **MongoDB** 的下拉列表中，选择**副本集实例**或者**分片实例**。副本集实例与分片实例操作类似。
3. 在右侧**实例列表**页面上方，选择地域。
4. 在实例列表中，找到需查看节点的目标实例。
5. 单击其实例 ID，进入**实例详情**页面，单击**节点管理**页签。
6. 在**节点管理**页面的 **Mongod 节点**页签，在节点列表，找到需升主的从节点。
   - 副本集：在节点列表，找到需升主的从节点，单击其**操作**列的**提升为主节点**。
     ![](https://qcloudimg.tencent-cloud.cn/raw/1f113e4fce23e65cca4bdbc68d65efb1.png)
   - 分片集：在节点组列表，找到需升主的从节点组，单击其右上角的**提升为主节点**。
     ![](https://qcloudimg.tencent-cloud.cn/raw/0db5a4e4f7fc7881c09890ca5c9b6c66.png)
7. 在**提升为主节点**对话框，了解提升主节点的影响，勾选**确认提升为主节点的风险** ，单击**确定**。
> !提升为主节点将导致数据库当前已存在的 TCP 连接断开，操作之前请确认业务有自动重连机制。否则，需手动重新连接数据库。
8. 返回**实例详情**页签，查看**实例状态**包含**切换主节点中**，等待实例状态无此信息，说明任务完成。在**节点管理**页面，可看到原从节点**角色**为 PRIMARY。

