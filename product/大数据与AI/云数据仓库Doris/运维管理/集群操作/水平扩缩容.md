## 功能介绍
云数据仓库 for Apache Doris 集群管理提供了水平扩缩容功能，帮助您完成集群节点规模的伸缩。

水平扩容是指增加服务节点的数量，相应的水平缩容是指减少服务节点的数量。若集群当前的规模及性能不满足使用需求时，可通过水平扩容提升性能。若集群当前的利用率较低且较长一段时间内无大量使用需求，可选择水平缩容降低集群规模，降低费用消耗。


>!
>- 操作集群需处于稳定的运行中状态。
>- 操作主账号无欠费、待支付订单情况。

## 水平扩容
>? 
>- 水平扩容过程中，系统可读不可写，执行操作大约需要5 - 15分钟，请选择在非业务高峰期进行。
>- 在数据存储量或查询量均相对增长时，优先选择水平扩容。

### 操作指南
1. 登录 [云数据仓库 for Apache Doris 控制台](https://console.cloud.tencent.com/cdwdoris)，在需要操作的集群中选择**操作 > 水平扩容**。  
![](https://qcloudimg.tencent-cloud.cn/raw/8a525984ed7cbfb5da97cb35693aacf3.png)
2. 在集群水平变配页，选择变配FE节点或BE节点，将节点个数增加至需要量，可扩容至3~27个节点。新扩容出的节点单机配置和集群目前的配置一样。在选择变配量后“变更费用”会实时计算，供您参考。
![](https://qcloudimg.tencent-cloud.cn/raw/641c478475275322650fc7111850a5b8.png)
3. 单击**确定**，确认页完成订单支付，集群状态“变更中”将持续5 - 15分钟。
4. 扩容完成后，进入集群详情页，可以查看到新扩容的节点。

## 水平缩容
为保证数据的安全性及副本数量满足要求，缩容前，待下线节点上存储的数据需要迁移到正常节点。迁移过程耗时和待迁移数据的大小成正比。
另外，基于架构稳定性要求，对缩容后的目标节点数量有要求，如：
1. FE 节点数量需要是奇数。
2. 高可用模式集群的 FE 和 BE 节点数需大于等于3。
3. 满足节点类型最小数量要求：FE：1，BE：3。

>!
>- 缩容只能每次一个节点执行。
>- 缩容过程中，系统读写仍可进行，但是可能出现一些抖动。
>- 缩容执行操作具体时间依赖于数据大小，从几分钟到几小时不等，请选择在非业务高峰期进行。

### 操作指南
1. 登录 [云数据仓库 for Apache Doris 控制台](https://console.cloud.tencent.com/cdwdoris)，在需要操作的集群中选择**操作 > 更多 > 水平缩容**。 
![](https://qcloudimg.tencent-cloud.cn/raw/3c729963cf724f3a5c02292c7c79bcea.png)
2. 在集群水平缩容页，选择变配FE节点或BE节点，将节点个数降低至需要量在选择变配量后“变更费用”会实时计算节省的费用。
![](https://qcloudimg.tencent-cloud.cn/raw/3b9d16ab9a057e92bf29a9a895fcebfd.png)
3. 单击**确定**，确认页完成确认退款，之后系统提交缩容订单，后台开始执行数据迁移及扩容操作。您可打开订单管理页查看订单执行详情。
4. 缩容完成后，进入集群详情页，可以查看到集群当前的节点列表。
