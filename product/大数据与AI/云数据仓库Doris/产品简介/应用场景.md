Doris 作为一个分析性数据库，适合几乎所有的分析性数据的场景，其中最主要的四种场景列出如下：
![](https://qcloudimg.tencent-cloud.cn/raw/144a56ac5b515efa00e1a5f5ab257500.png)
这四种场景都是实际业务中用户对分析性数据库期望最多的场景，但是这些场景在大数据量下，对系统的要求也是非常高的。Doris 通过以下技术来满足这些场景对系统功能和性能的苛刻要求。

## OLAP 多维分析和报表——高维表上的高速随意探查能力
在关系数据库中，多维分析定义的对数据立方体（CUBE）上进行的钻取、上卷、切片、切块、旋转等操作是通过维度建模实现的。
维度建模最常见的模型是星型模型和雪花模型。
维度建模中，一个表中的列可以分为维度列和指标列，Doris 支持在建表的时候定义出维度列和指标列，如下图所示。
![](https://qcloudimg.tencent-cloud.cn/raw/484cf1ddf97c0c954752d5f00fa00d52.png)
指标列上可以定义函数，Doris 可以做到在数据导入的时候，数据按照维度列进行分类，再按照指标列指定的函数进行聚合。这种预聚合能力大大减少了查询所扫描的数据量，从而加速了聚合查询的速度。
另外，Doris 还实现了物化视图、Rollup 索引和 CUBE 的语法，其中的 Rollup 对应上卷操作、通过 Grouping Set 语法可以建出 CUBE 立方体来。

## 实时数仓和数据分析——PB 级数据量上的实时增、删、改、查能力
下图展示的是一个 Doris 的建表语句，从这个语句中可以看出，数据可以分区（Partition），也可以分桶 （DISTRIBUTED BY），通过分区和分桶，Doris 可以将一个表 (Table) 的数据拆分成多个 Tablet。
![](https://qcloudimg.tencent-cloud.cn/raw/0584e0d78183e9db64bfac226020ba4a.png)
Doris 中每个 Tablet 可以设置多个副本，这些 Tablet 及其副本可以存储在不同的 BE 中，从而保证数据的高可用和高可靠。

物理上，Tablet 会按照一定大小（256M）拆分为多个 Segment 文件，Segment 是列存的 LSM-Tree 全称是Log Structured Merge Tree，是一种分层，有序，面向磁盘的数据结构。这种结构的理论基础是磁盘批量的顺序写要远比随机写性能高。

作为对实时数仓和数据分析的支持，数据的实时写入是非常关键的一个环节，为了实现数据的实时写入，Doris 开发了 Stream Load 实现了数据的实时写入能力。

在此基础上，又提供了三种常用的实时导入功能：也即通过内置的 Canal 客户端实时获取 MySQL 的 binlog；通过 Doris Flink Connector 对接 Flink 的 CDC 能力实现数据的精确导入； 通过内置的 Kafka 客户端订阅 Kafka 的 Topic， 从而实现数据的实时更新。
![](https://qcloudimg.tencent-cloud.cn/raw/838848d406e30d20535366f25d78dc71.png)

## 高并发场景——高并发下低延迟查询能力
Doris 拥有一个现代的MPP查询引擎，这个引擎完整实现了 Exchange 节点。有了 Exchange 节点，查询就能被分解到各个节点进行并行数据处理。
同时 Doris 由于FE和BE能很容易横向扩展，理论上就能应对并发增加的情况，从而满足高并发场景。

Doris 提供了丰富的索引结构来帮助加速数据的读取和过滤。索引的类型大体可以分为智能索引和二级索引两种。

其中智能索引是在 Doris 数据写入时自动生成的，无需用户干预。而二级索引是用户可以选择性的在某些列上添加的辅助索引。

智能索引包括前缀稀疏索引和MinMax索引两种。
前缀稀疏索引是建立在排序结构上的一种索引。Doris 存储在文件中的数据，是按照排序列有序存储的，Doris 会在排序数据上，每 1024 行创建一个稀疏索引项。

索引的 Key 即当前这1024行中，第一行的前缀排序列的值。当用户的查询条件包含这些排序列是，我们可以通过前缀稀疏索引快速的定位到起始行。
另外，Doris 也实现了动态分区裁剪和谓词下推技术，这些技术都能有效的降低最终从磁盘 scan 的数据量，从而加快查询的执行。

## 大数据和数据库统一分析——Hadoop 生态兼容和外表高性能查询能力
Doris 不依赖 Hadoop 组件，但是 Doris 本身对 Hadoop 生态进行了全面的支持。除了可以通过 Flink， Spark 写入 Doris ，我们还可以导入 HDFS 的数据，也可以通过建立 Hive 外表，直接查询 Hive 数据。
下图是 Doris 对 Hadoop 生态支持的一个全景图。
![](https://qcloudimg.tencent-cloud.cn/raw/826796d2f53bb0dd4d85538179f20cc8.png)
