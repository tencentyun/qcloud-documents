

## 操作背景
- 腾讯 TI 平台 TI-ONE 自动学习模块内置了常见深度学习场景，例如图片分类、目标检测、以及杯盘检测。使用户仅需通过简单的配置即可完成深度学习模型构建、评测、发布等模型生命周期全流程工作。
- 为了方便您有效地使用腾讯 TI 平台 TI-ONE 的自动学习，本文将通过一杯盘检测案例向您演示使用流程。

## 前提条件
- 完成腾讯云 TI 平台 TI-ONE 服务注册与开通，请参考 [账号和权限说明](https://cloud.tencent.com/document/product/851/74113)。  
- 开通 [对象存储 COS ](https://console.cloud.tencent.com/cos)服务并完成 [存储桶创建](https://cloud.tencent.com/document/product/436/13309)。
- 在数据中心 [上传](https://cloud.tencent.com/document/product/851/74157) 带有标注标签的数据或对数据进行 [标注](https://cloud.tencent.com/document/product/851/74156)。
- 使用后付费类型资源会预先冻结所选配置2个小时的使用费用，若您的现金账户余额不足，请先进行充值。

## 使用自动学习进行杯盘检测模型训练

### 步骤1：新建任务

进入**自动学习** > **立即开始**，选择对应的区域，单击**新建任务**。
![](https://qcloudimg.tencent-cloud.cn/raw/50ee6675a33382c40974a894ebd23335.png)
单击后进入新建任务页面，用户需在此填写本次任务的任务名称、训练数据、训练输出路径、训练配置及训练资源配置等信息。
1. 填写基本信息：
![](https://qcloudimg.tencent-cloud.cn/raw/1bdf62201e8667bb305989f1bc19750a.png)
2. 填写数据配置
![](https://qcloudimg.tencent-cloud.cn/raw/8e62108893353f3e7fee83f7bfce6281.png)
3. 填写训练配置
![](https://qcloudimg.tencent-cloud.cn/raw/ac6941fa0babaf95563c2d5ca7cc3622.png)
其中：
	- 期望准确率：可结合业务目标设置合理的期望准确率值，到达准确率后会为您自动停止训练。
	- 最长训练时长：默认为1小时，到达后任务会立即停止。该设置下，模型可能无法达到所需的训练效果，可结合实际情况对该项进行调整。
	- 训练参数设置为可选项，自动学习会为您提供默认值。也可结合您的实际情况进行修改，可修改的训练参数包括：
	- epochs：模型训练次数，可选择系统内置的值或进行自定义。
	- lr：学习率，可选择系统内置的值或进行自定义。
	- batch_size：训练批次大小，可选择系统内置的值或进行自定义。
	- warmup：预热训练次数，可选择系统内置的值或进行自定义。
4. 填写训练资源配置，可按需选择后付费或预付费训练模式，确认后单击**下一步**。
![](https://qcloudimg.tencent-cloud.cn/raw/7ba1a8d01e85c147fbcd274da70fea1b.png)
单击**下一步**后，进入训练模型页面
如您在单击**下一步**后离开训练模型页面，可至任务管理列表页重新找到该任务。

### 步骤2：训练模型
在训练模型页，可以查看模型的运行状态及训练详情。页面展示信息如下：
1. 训练状态
![](https://qcloudimg.tencent-cloud.cn/raw/612bd962b6c8925fe80853302ba2b099.png)
	- 已训练时长：展示模型训练任务已经运行的时长。
	- 最长训练时长：为本任务在配置任务页所设置的值，本例中为1小时。
	- 训练进度：展示模型训练任务进度及训练任务当前所处阶段。如果您不再需要本次训练任务，可以单击**停止**按钮。如果训练意外中断，可单击**重启**按钮。
2. 训练详情
	- 实时指标：展示模型训练过程中的实时指标，包含横坐标为 epoch（模型训练次数）， 纵坐标为具体指标所对应的数值。
![](https://qcloudimg.tencent-cloud.cn/raw/e8a5dcb26c2f857fed8c4840b163b1e3.png)
	- 训练日志：展示模型训练过程中产生的日志详情，支持自动刷新及检索分析。
![](https://qcloudimg.tencent-cloud.cn/raw/b34902b22cae1ae24215f4f2a9b013ab.png)
3. 杯盘测试训练指标说明：
	- mAP：将所有类别检测的平均正确率（AP）进行综合加权平均而得到的。
	- loss：损失值，代表模型预测与目标之间的距离。

### 步骤3：模型评测
模型评测提供基于测试集的模型表现信息。包含模型评测任务基本信息（如评测时长、评测图片数量、badcase 数量），整体指标（可通过定义不同的全局阈值查看模型的精确率、召回率、MAP），PR曲线。
1. 查看模型评测的基本信息，包含测试集、评测时长、评测图片数量、badcase数量等。
![](https://qcloudimg.tencent-cloud.cn/raw/c3d41bda588de179e5a9f6e84c02e74a.png)
	- 如需查看测试数据集，请单击测试集对应的**查看**，单击后，可看到测试集的标签分布信息、各类别标签数量及标签占比。由于图片读取会产生 COS 请求及流量费用，因此，默认不展示测试集图片详情。如需展示图片详情，您可打开详情展示开关。
![](https://qcloudimg.tencent-cloud.cn/raw/ceb06984eed26bb033ced2e86080101b.png)
	- 单击**详情**展示后，会为您展示测试集中所包含的图片详情信息。您可依次查看，或根据标注类别选择具体的标签进行查看。
![](https://qcloudimg.tencent-cloud.cn/raw/36c359a089b54bc351ed02997a2c17a2.png)
	- 对于模型在测试集上的badcase，可单击基本信息中 badcase 数量对应的查看，进入到对应的页面进行查看。由于badcase访问需要产生对象存储COS的请求和流量费用，因此图片默认是不展示的。请将预览badcase图片开关打开后查看详情。
![](https://qcloudimg.tencent-cloud.cn/raw/68bebfa4b79c3fac5613232cabeb97f6.png)
![](https://qcloudimg.tencent-cloud.cn/raw/029ddf2469d9de8ddf0b4c1c64e8289d.png)
2. 查看模型整体指标，包含精确率、召回率、MAP。
![](https://qcloudimg.tencent-cloud.cn/raw/8f67ab3064e08414c044dcca664d34a7.png)
	- 精确率：表示预测结果为正类的样本中，真正的正样本比例。
	- 召回率：实际图片类别被检测到的比率。
	- 全局阈值：默认为50%，可按步长为5进行数值调整。通过调整阈值，可以权衡精确率和召回率，以判断模型是否符合实际业务场景的需求。
	- MAP：将所有类别检测的平均正确率（AP）进行综合加权平均而得到的。
3. 查看模型的 PR 曲线，横轴表示 Recall（召回率），纵轴表示 Precision（精确率），鼠标 hover 至曲线上可查看每个类别对应的精确率、召回率及阈值。
![](https://qcloudimg.tencent-cloud.cn/raw/a4326f65e8c92d9c46a5bc60bc85a82a.png)
4. 在 PR 曲线下方提供每个类别对应的预测结果及指标。可通过调整面板中的阈值，查看不同阈值对应的精度、召回率及 MAP。
![](https://qcloudimg.tencent-cloud.cn/raw/31ed2e51097f72de6ee637abb695659a.png)

### 步骤4：一键发布
1. 模型评测结束后，可单击**下一步**，进入一键发布页面，快速将训练得到的模型部署为在线预测服务。
![](https://qcloudimg.tencent-cloud.cn/raw/584c0e5f4b842ef65b9f9bd41a34b927.png)
	- 计费模式：可选择后付费或预付费。
	- 算力规格：按需选择模型部署所需的算力。
	- 最长运行时长：为节省资源您可设置最长运行时长，服务将按照设置时长停止。
	- 单击一键发布按钮进行模型发布，如果计费模式选择后付费，则会预先冻结所选配置2个小时的费用，需要保证账户余额能满足您的业务要求。
2. 单击**一键发布**后，进入到发布页面：
![](https://qcloudimg.tencent-cloud.cn/raw/3e87ee60e17d4edaff9c02daaa034bf3.png)
	- 运行状态：显示预测服务当前所处的状态。如您不再需要此服务，可单击停止，停止该服务。
	- 在线预测服务：单击查看服务，进入该服务对应的详情页面。包含服务的基本信息、实例列表、监控、事件、日志、更新记录。详情可查看 [在线服务运营](https://cloud.tencent.com/document/product/851/74143)。
	- 服务测试：服务测试区域，您可单击点击上传按钮，上传新的测试图片，查看模型的预测结果。
>?如果识别结果显示暂无数据，可通过调整置信度，对显示结果进行过滤。
