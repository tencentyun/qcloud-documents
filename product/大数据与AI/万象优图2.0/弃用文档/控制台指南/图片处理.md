## 简介

您可在此页面对数据万象图片相关服务进行管理，包括对 **Guetzli 图片压缩**、**TPG 图片压缩**、**盲水印**、**样式分隔符设置**以及**样式管理**等服务进行开启或关闭。

## Guetzli 图片压缩 

Guetzli 图片压缩是数据万象推出的**视觉无损压缩**服务，能够对 **JPG 图像**进行高比例压缩，为使用者节省下载流量，并加快用户下载速度，提升体验。它利用人眼对于部分色域及图片细节的不敏感性，在不影响视觉效果的前提下有选择地丢弃细节信息，使得在相同质量条件下比原图节省约35% - 50%的图片大小。

### 操作步骤

1.  登录 [数据万象控制台](https://console.cloud.tencent.com/ci/bucket) ，单击【存储桶管理】，进入存储桶管理页面。
2.  在【存储桶管理】页面选择并单击需操作的存储桶，进入相应存储桶管理页面。
3.  单击左侧导航栏单击【图片处理】页签，向下找到【Guetzli 图片压缩】配置项，单击【编辑】并打开状态，然后单击【保存】，即可使用。
>?
>
>-  开启 Guetzli 后，**首次访问图片会返回普通 JPG 原图**，同时启动异步 Guetzli 处理，处理完成后再次请求该图片会得到压缩后的结果图。
>-  当前 Guetzli 图片压缩服务仅对质量 q>70、像素小于400万的 JPG 图片做处理。
>-  Guetzli 压缩是付费服务，具体费用可查看 [购买指南](https://cloud.tencent.com/doc/product/460/6970)，数据万象为每个账户提供每月**3000张**的免费体验额度，超出后将正常计费。未使用额度不会累积至下一月。

### Guetzli 状态码

开启 Guetzli 压缩功能后，对应存储桶中图片请求的 HTTP 头部会增加 x-GuetzliState 标识，用以标注 Guetzli 压缩处理的状态。具体内容如下：

| x-GuetzliState 状态码 | 含义                       |
| --------------------- | -------------------------- |
| <0                    | 无法处理（不满足压缩条件） |
| 0                     | 不进行 Guetzli 压缩处理    |
| 1                     | 已发起 Guetzli 压缩请求    |
| 2                     | Guetzli 压缩中             |
| 3                     | 原图缓存未过期，暂不处理   |
| 100                   | 压缩成功                   |

## TPG 图片压缩 

TPG 是腾讯推出的自研图片格式，可在**保证图片观感**的情况下实现有效压缩，支持 JPG、PNG、WEBP、GIF 等格式的转换。您可通过数据万象控制台开通服务，开通后，对于当前存储桶中的图片资源，使用相应的图片压缩接口即可实现**下载时处理**。
>!
>
>-  TPG 是腾讯自研的图片格式，如需使用请确认**图片加载环境支持 TPG 解码**，腾讯云音视频实验室提供集成 TPG 解码器的 IOS、Android、Windows 终端 SDK，可帮助您快速接入和使用 TPG，详见 [SDK 下载](https://cloud.tencent.com/document/product/875/18366) 文档。
>-  TPG 压缩为付费服务，具体费用可查看 [计费与定价](https://cloud.tencent.com/doc/product/460/6970)。

### 操作步骤

1.  登录 [数据万象控制台](https://console.cloud.tencent.com/ci/bucket) ，单击【存储桶管理】，进入存储桶管理页面。
2.  在【存储桶管理】页面选择并单击需操作的存储桶，进入相应存储桶管理页面。
3.  单击左侧导航栏单击【图片处理】页签，向下找到【TPG 图片压缩】配置项，单击【编辑】并打开状态按钮，然后单击【保存】，即可使用。
    ![](https://main.qcloudimg.com/raw/f1d90dadd3ea7748255787ffa8c81bc5.jpg)
>!TPG 图片压缩是付费服务，具体费用可查看 [购买指南](https://cloud.tencent.com/doc/product/460/6970)。

## 盲水印

盲水印是数据万象推出的特殊水印服务，能够将水印图以**不可见形式**添加至图像频域，在图片被攻击后仍可进行水印图提取，进行鉴权追责。

您可通过控制台开通服务，开通后可使用 [持久化处理接口](https://cloud.tencent.com/document/product/460/18147) 在**上传时**添加盲水印或在**已上传**的数据中添加，同时也可以在**下载时**添加盲水印。当您需要检测图片时，您可直接使用提取接口进行盲水印提取。


### 操作步骤

1.  登录 [数据万象控制台](https://console.cloud.tencent.com/ci/bucket) ，单击【存储桶管理】，进入存储桶管理页面。
2.  在【存储桶管理】页面选择并单击需操作的存储桶，进入相应存储桶管理页面。
3.  单击左侧导航栏单击【图片处理】页签，向下找到【盲水印】配置项，单击【编辑】并修改为开启状态，然后单击【保存】，即可使用。
>?
>
>-  使用盲水印功能，水印图的宽高不得超过原图的1/8。
>-  为保证盲水印效果，水印图请选用黑底白色图片。
>-  盲水印为付费服务，具体费用请参见 [购买指南](https://cloud.tencent.com/doc/product/460/6970)。另外数据万象为每个账户提供每月3000张的**免费体验额度**，超出后将正常计费。未使用额度不会累积至下一月。

## 样式分隔符

样式分隔符是分割文件名称和处理样式的符号，包含中划线(-)、下划线(_)、斜杠(/)和感叹号(!)。

### 操作步骤

1.  登录 [数据万象控制台](https://console.cloud.tencent.com/ci/bucket) ，单击【存储桶管理】，进入存储桶管理页面。
2.  在【存储桶管理】页面选择并单击需操作的存储桶，进入相应存储桶管理页面。
3.  单击左侧导航栏【图片处理】页签，向下找到【样式分隔符】配置项，单击【编辑】并修改为开启状态，然后选择一种或多种样式分隔符。
4.  单击【保存】，即可完成样式分隔符设置。

### 使用说明

**URL 格式**： http:// 绑定域名 /文件名称 + 分隔符 + 处理样式名。
假设样式分隔符为(!)，同时样式名为 yunstyle ，原图 fileid 为 sample.jpg ，则原图的经过样式 yunstyle 处理后的图片 URL 为 `http://space.image.com/sample.jpg!yunstyle`。

>!
>
>-  同一存储桶下最多可设置100条样式。
>-  为避免歧义，处理样式名中不可出现当前所启用的样式分隔符。
>-  设置生效时间平均为30分钟。
>-  更改分隔符需清除缓存，全网生效至少需要24小时。
>-  取消已使用的分隔符，可能导致产品功能异常。


## 样式管理

通过样式管理服务，您可对现有样式进行管理，如样式**预览**、**编辑**、**删除**、**导出**操作；您还可通过可视化的方式或导入样式的方式**新增样式**。在存储桶中，您可以设置图片的样式，方便管理不同需求的图片。此处设置的样式是图片下载时为实时处理参数组合起的一个别名。
![](https://main.qcloudimg.com/raw/5a39eb00c8f80ec7a1132b5515992a16.png)


### 新增样式

您可根据导入规则批量导入样式，同时也可进行可视化操作新增样式。下面对可视化新增样式操作进行介绍：

1.  登录 [数据万象控制台](https://console.cloud.tencent.com/ci/bucket) ，单击【存储桶管理】，进入存储桶管理页面。
2.  在【存储桶管理】页面选择并单击需操作的存储桶，进入相应存储桶管理页面。
3.  单击左侧导航栏【图片处理】页签，向下找到【样式管理】配置项。
4.  单击【新增样式】，进入编辑样式界面，然后按照如下配置项说明进行配置：

####  样式名称
 -  样式名称区分大小写。
 -  为避免歧义，处理样式名中不可出现当前所启用的样式分隔符。
 -  样式名称保存之后不可修改。

####  编辑模式
 -  [基本编辑](#1)：您可以可视化的方式进行样式设置。
 -  高级编辑：您可通过输入参数进行样式的设置。详情请参考 [基础图片处理](https://cloud.tencent.com/document/product/460/36540) API 文档。
		 ![](https://main.qcloudimg.com/raw/4db7e44c61472b1ec8a971448467d6d1.png)

<span id=1>

#### 基础处理

选择基本编辑方式，您可设置样式的缩略方式，渐进效果、输出格式、输出效果、文字或图片水印等。

数据万象支持 [缩放 + 裁剪](#st1)、[只裁剪](#st2)、[只缩放](#st3) 三种缩略方式。缩略方式非必选项，您可以设置为不缩略。
![](https://main.qcloudimg.com/raw/2fd1cd98fa2a7c59abe859992a09019c.png)

>!数据万象的缩放处理可将图片缩小或放大，而不会将图片拉伸。

<span id="st1"></span>
**缩放 + 裁剪**
裁剪 + 缩放功能是为了能够在原图较大，目标图较小且比例和原图不一致时使用，会先将图片缩放到缩略尺寸，再按照用户设定的裁剪位置和宽高尺寸进行裁剪。可以通过九宫格的选择，来决定裁剪中心的位置。

-  等比缩放：指按原图的长宽比例根据用户的尺寸设置进行缩略。
-  限定宽高缩放：严格按照用户限定的图片尺寸进行缩略。例如，原图为1200X900，缩略图为尺寸为600X600 ，则会先将原图按宽高比（600:600即1:1 ）做裁剪，裁剪原图到900X900后，再进行缩放，缩小到600X600的目标尺寸。

<span id="st2"></span>

**只裁剪**
只裁剪样式根据您设置的裁剪位置和缩略图尺寸，直接对原图进行裁剪，其中九宫格确定裁剪的中心位置。
例如，设置裁剪位置为居中，裁剪后的缩略图尺寸为600X600 ，则沿宽中线左右各取300，高沿中线各取300，形成最终的600X600缩略图进行裁剪。

<span id="st3"></span>

**只缩放**
只缩放是将图片按照设置的尺寸进行缩放。

- 等比缩放：等比缩放是指按原图的长宽比例根据用户的尺寸设置进行缩略。
- 限定宽高缩放：严格按照用户限定的图片尺寸进行缩略，忽略原图宽高比例。

#### 文字水印

文字水印能够按照您设置的文字内容、字体、字号、颜色、透明度等信息，由九宫格确定水印位置，在目标图片上设置水印。
![](https://main.qcloudimg.com/raw/34e111cfa7a2bb8f423670f61aa588eb.jpg)

#### 图片水印

图片水印能够按照您设置的图片，由九宫格确定水印位置，在目标图片上设置水印。
![](https://main.qcloudimg.com/raw/68b30895ad90812bb4b27d7e1fc7fe7c.jpg)
