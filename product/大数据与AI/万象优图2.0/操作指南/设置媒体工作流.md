## 简介

数据万象支持设置媒体工作流，您可以快速、灵活、按需搭建视频处理流程。每个工作流与**输入存储桶**的一个路径绑定，当视频文件上传至该路径时，该媒体工作流就会被自动触发，执行指定的处理操作，并将处理结果保存至**输出存储桶**的指定路径下。在工作流中可以设置 [视频截帧](https://cloud.tencent.com/document/product/460/38934) 任务和 [视频转动图](https://cloud.tencent.com/document/product/460/38932) 任务。

>?
> - 该工作流支持视频文件格式包括：3gp、asf、avi、dat、dv、flv、f4v、m2t、m3u8、m4v、mj2、mkv、mov、mp4、mpe、mpg、mpeg、mts、ogg、qt、rm、rmvb、swf、vob、wmv、webm。
> - 媒体处理服务当前仅支持北京、上海、重庆地域，如您有其他地域需求，请 [提交工单](https://console.cloud.tencent.com/workorder/category) 联系我们。



## 操作步骤

### 创建工作流

1. 登录 [数据万象控制台](https://console.cloud.tencent.com/ci) ，单击左侧导航栏【存储桶管理】，进入存储桶列表。
2. 找到您需要进行视频处理的存储桶，并单击右侧的【媒体处理】，然后进入媒体处理页面。
3. 单击媒体处理页面上方的【工作流】页签，进入工作流界面。
4. 单击【创建工作流】，进入创建工作流页面。在创建工作流时，您需要设置工作流名称、输入路径、队列和配置工作流节点，配置项说明如下：
	- **工作流名称**：必填项，仅支持中文、英文大小写[A-Z,a-z]、数字[0-9]、下划线(\_)和短横线(-)，长度不能超过128个字符。
	- **输入存储桶**：默认项，即为当前存储桶。
	- **输入路径**：选填项，以`/`开头，以`/`结尾，如果不填写，则对输入存储桶所有路径生效。工作流启用后，当视频文件上传至该路径时，媒体工作流将被自动触发。
	- **队列**：必选项，在开通服务时，系统会自动创建一个用户队列。当用户提交任务后，任务会先进入队列中进行排队，根据优先级和提交顺序依次执行。
<img src="https://main.qcloudimg.com/raw/ebea0957f8a555b16bfe5dc054591fab.png" style="zoom:80%;" />
	- **配置工作流**：单击输入右侧的“+”可以添加**视频截帧**和**视频转动图**节点，每个工作流至少配置一个任务节点。任务节点配置需设置输出存储桶、输出文件路径、选择任务模版。模版设置详情请参见 [设置媒体处理](https://cloud.tencent.com/document/product/460/41486#.E6.A8.A1.E7.89.88.E8.AE.BE.E7.BD.AE)。工作流各任务节点处理完成后新生成的文件将存储在对应输出文件路径中。
![](https://main.qcloudimg.com/raw/e07489d15bd666a492f90db28b39ea6f.jpg)




### 管理工作流


1. 登录 [数据万象控制台](https://console.cloud.tencent.com/ci) ，单击左侧导航栏【Bucket管理】，进入存储桶列表。
2. 找到您需要进行视频处理的存储桶，并单击右侧的【媒体处理】，然后进入媒体处理页面。
3. 单击媒体处理页面上方的【工作流】页签，进入工作流界面。
4. 工作流列表展示了工作流名称、工作流 ID、输入路径、创建时间以及启用状态等信息。支持按照工作流名称、工作流 ID 搜索以及对指定工作流进行查看详情、编辑和删除操作。
	 ![](https://main.qcloudimg.com/raw/791f9de773ec92fb3abbd97a5c17afb1.png)
	- **启用按钮**：启动工作流后，您上传至输入存储桶对应路径下的视频文件将会根据工作流配置自动处理。再次单击该状态按钮，可暂停工作流。暂停工作流后，将不会对上传至对应路径下的视频文件进行自动处理。
	>?工作流默认为未启用状态，单击该工作流对应的状态按钮后，可启用工作流。工作流启用后，将在5分钟内生效。
	- **编辑**：单击操作栏下的【编辑】，进入“工作流编辑”页面，在该页面可以更改工作流配置。
	> !工作流处于启用状态时，无法对其进行编辑和删除操作。
	- **删除**：单击目标工作流操作栏中的【删除】，可删除该工作流。


### 查看执行实例

每个视频文件执行完一遍工作流，就会产生一个执行实例，执行实例页面展示源文件地址，工作流执行状态，执行时间等信息。
1. 单击目标工作流操作栏中的【执行实例】，进入“执行实例”列表页面。
  <img src="https://main.qcloudimg.com/raw/bbcc563815d3758fc36dc68e13ed2106.png" style="zoom:70%;" />
2. 在列表页面中，选择单击目标实例 ID 右侧的【详情】，进入“实例”详情页面。
![](https://main.qcloudimg.com/raw/9adfdda6e20fe90c1675a0192bbe4e95.png)
3. 通过单击图中的图标，可查看工作流各节点的任务 ID，执行状态，开始/结束时间等信息。
![](https://main.qcloudimg.com/raw/0c2f798838b18d708e00edb66d5c36cb.png)

