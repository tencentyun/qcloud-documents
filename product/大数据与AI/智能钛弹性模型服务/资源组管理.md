在 TI-EMS 中，集群资源会被分为不同的资源组进行隔离，在启动模型服务的时候，用户可以选择将集群资源部署在默认的公共资源组或者部署在用户独享的专用资源组中。部署在不同资源组的模型服务计费方式详见 [计费概述](https://cloud.tencent.com/document/product/1120/38717)。

| 资源组类型   | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| 公共资源组 | 公共资源组提供公共的大规模计算集群，根据用户服务配置按需分配使用。按资源规格、使用时长及实例数计费。 |
| 专用资源组 | 提供独享的计算资源，可用于模型部署。专用资源组不与其他用户共享，更加高效。购买资源节点后即开始计费，目前支持包年包月和按量计费两种计费模式。使用专属资源组部署上线服务，不再另行收费。 |

>!专用资源组购买已经开放，公共资源组按量计费暂未开放，请填写 [使用申请]( https://cloud.tencent.com/apply/p/nx0bbybrhuf) 使用公共资源组。

## 公共资源组
若用户选择在公共资源组部署服务，可自由选择占用的资源：CPU 配置的部署单位为 2Gquota 和 4Gquota，GPU 配置部署的单位为 P4quota。
部署单位说明：
- 2Gquota为1核CPU，2G内存
- 4Gquota为1核CPU，4G内存
- P4quota为1核CPU，5G内存，0.25P4卡

选定想要部署的资源类型以后，可指定 Quota 数量，1个实例副本的 2Gquota 和 4Gquota 的数量设置范围为1 - 10，1个实例副本的 P4quota 的数量设置范围为1 - 4（即单副本最大 GPU 配置为1P4卡）。

## 专用资源组
TI-EMS 的用户可以创建专属于自己的资源组，托管给 TI-EMS，用户可将模型服务部署在专属资源组上，不与其他用户共用资源。

#### 专用资源组优势
- 对于业务稳定，需要长期使用的服务来说，使用预付费专用资源组可以为您节省总消耗成本。
- 用户可以在专用资源组中使用自定义运行环境，可灵活部署更多种类型的模型。
- 部署在专用资源组的服务支持 VPC 打通。

## 专用资源组使用方式
### 新建资源组
进入【资源组管理】页面，单击【新建资源组】，跳转至购买页面，资源组购买方式请详见 [购买方式](https://cloud.tencent.com/document/product/1120/38753)。

>?可能会因为当前地域或可用区资源不足等原因，导致资源组部署失败，退款订单会自动创建，已支付的钱款会原路返回。

资源组创建完成后，在 TI-EMS 资源组列表页就可以看到当前用户名下的所有资源组，并且可以查看相关信息。在部署模型时也可以选择该专用资源组进行部署。

### 资源组节点详情
在资源组列表页，用户可以修改资源组名称，单击资源组名称，可进入查看资源组下各个节点的状态和资源使用情况。
- 包年包月资源组节点状态分为部署中、部署失败、正常、已过期四种类型。部署成功的节点状态显示为正常时，节点可正常使用，状态为部署中、部署失败或者已过期的节点不可部署模型服务，为了保证您的服务运行正常，请时刻关注您的包年包月节点到期状况，关于节点的过期说明请查看 [欠费说明](https://cloud.tencent.com/document/product/1120/38756)。
- 按量计费资源组节点状态分为部署中、部署失败、正常、已销毁四种类型，部署成功的节点状态显示为正常，节点可正常使用，状态为部署中、部署失败或者已销毁的节点不可部署模型服务。

用户可对资源组进行一键续费和增加节点的操作，对包年包月资源组节点可进行节点续费、设置/取消自动续费的操作，对按量计费资源组节点可进行销毁操作。

### 资源组手动扩展
当资源组资源不足时，用户可增加资源组节点，单击资源组列表的【增加节点】，进入购买页面，资源组手动扩展可选择购买包年包月或按量计费的节点。

>?增加节点仅可选择当前资源组所在地域和可用区的相同规格的机器。

### 资源组自动伸缩
对于访问量快速变化的业务，您可以选择创建伸缩组来满足资源的自动扩展需求。

**创建伸缩组**
1. 在资源组列表页点击资源组名称，进入资源组详情页-伸缩组页，单击【新建伸缩组】，进入伸缩组创建页面。
![](https://main.qcloudimg.com/raw/69e4fe2ce6112d9637f3650c4a74ffa4.png)
2. 输入伸缩组名称和最大最小伸缩数，即限制伸缩组内节点的数量范围。
![](https://main.qcloudimg.com/raw/e397e85d854591fb0b0d04ca4bf3a4e8.png)
3. 单击【确定】，完成创建。
![](https://main.qcloudimg.com/raw/f98c41b26355e172eb905526761283b4.png)

**伸缩组操作**
1. 启用/停用伸缩组
当伸缩组创建完成以后，需要启用伸缩组。单击【伸缩组】>【操作】>【启用】，伸缩组将按照平台伸缩规则进行节点扩展和销毁。
2. 删除伸缩组
单击【伸缩组】>【操作】>【更多】>【删除】，即可删除伸缩组，删除伸缩组的前提是伸缩组内所有节点均已销毁。
3. 查看资源组节点列表
单击【伸缩组】>【节点列表】，当访问量增加，伸缩组会自动扩展节点，伸缩组内扩展的节点可在此页面进行查看。伸缩组内扩展的节点可以手动销毁。
4. 查看资源组伸缩记录
单击伸缩组名称，进入【伸缩组】>【伸缩记录】，您可查看伸缩组内节点的历史扩展与销毁记录。


**TI-EMS 资源组伸缩规则**
**1. 扩容规则**
当资源组中出现因为缺少可用资源而无法调度的容器实例时，将触发自动扩容策略，并尝试扩容节点来运行这些实例。用于判断资源是否充足的标准是资源组中剩余可用资源是否满足服务实例的资源配置值。每当 Kubernetes 调度程序找不到任何运行 Pod 的地方，它会将 Pod 的 PodCondition 设置为 false，并将原因设置为不可调度的。集群自动扩缩容程序会每隔一段时间扫描一次，查看是否有不可调度的 Pod 需进行扩容，并尝试扩容节点来运行这些 Pod。

仅在扩容节点的规格能够满足 pod 请求的规格时，才能触发扩容。例如 16c32g 的 pod 请求，伸缩组的机器规格是 24c48g 的情况下，就可以触发扩充尝试。伸缩组机器为 8c16g 时则不会触发扩容。

**2. 缩容规则**
TI-EMS 规定的缩容规则是当资源组中节点空闲资源较多时，将触发缩容。当节点上所有 Pod 的 CPU 或者内存占用资源/可分配资源的比值小于50%时，并且持续10分钟，该节点就会尝试缩容。同时，只有该节点上所有 Pod 都能够成功调度到其他节点上时， Pod 才会被驱逐从而缩容成功。

扩容成功后十分钟内不会进行缩容，也不会进行缩容计时。

### 包年包月资源组节点续费
**1. 资源组一键续费**
用户可在 TI-EMS 控制台或腾讯云费用中心的续费管理页面对资源组进行一键续费操作，一键续费可将资源组下所有包年包月节点进行批量续费。关于一键续费的详细说明详见 [续费说明](https://cloud.tencent.com/document/product/1120/38757)。
**2. 节点续费**
用户可在 TI-EMS 控制台或腾讯云费用中心的续费管理页面对包年包月节点进行续费操作，关于节点续费的详细说明详见 [续费说明](https://cloud.tencent.com/document/product/1120/38757)。
**3. 节点设置/关闭自动续费**
用户可在 TI-EMS 控制台或腾讯云费用中心的续费管理页面对包年包月节点进行自动续费管理，关于节点自动续费的详细说明详见 [续费说明](https://cloud.tencent.com/document/product/1120/38757)。

### 资源组类型
TI-EMS 所支持的资源组节点类型和定价信息，请参见 [定价说明](https://cloud.tencent.com/document/product/1120/38717?!preview&!editLang=zh#.3Cspan-id.3D.22tenisst.22.3E.E5.AE.9A.E4.BB.B7.E8.AF.B4.E6.98.8E.3C.2Fspan.3E)。
