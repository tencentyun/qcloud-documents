## 操作场景
本文为您介绍通过 EMR 控制台创建一个 EMR on TKE 集群的操作步骤和相关配置。
## 操作步骤
登录 [EMR 控制台](https://console.cloud.tencent.com/emr/tke)，在 EMR on TKE 集群列表页单击**创建集群**，在购买页面完成相关配置；当集群列表中集群状态显示为运行中时，表示集群创建成功。
<table>
<thead>
<tr>
<th>配置项</th>
<th>配置项说明</th>
</tr>
</thead>
<tbody><tr>
<td>集群名称</td>
<td>通过设置集群名称，来区分不同的 EMR 集群，系统随机生成支持修改。</td>
</tr>
<tr>
<td>地域</td>
<td>集群所部署的物理数据中心，每个地域（region）都指一个独立的物理数据中心，不同地域间的云服务器内网不互通。<br><b>注意</b>：<br>1. 集群创建后，无法更改地域，请谨慎选择。<br>2. 仅支持该地域下的容器集群为集群提供资源。</td>
</tr>
<tr>
<td>容器类型</td>
<td>服务角色由底层容器提供资源进行部署，支持 TKE 标准集群和 TKE Serverless 集群<br><b>注意</b>：选择具体某个容器集群为该 EMR on TKE 集群提供 Pod 资源进行服务部署。</td>
</tr>
<tr>
<td>集群网络</td>
<td>用于购买 db 使用，保持网络与容器集群网络一致。</td>
</tr>
<tr>
<td>可用区及子网</td>
<td>用于购买 db 使用，保持网络与容器集群网络一致。</td>
</tr>
<tr>
<td>安全组</td>
<td>安全组具有防火墙功能，用于设置云服务器 CVM 的网络访问控制。如果没有安全组，EMR 会自动帮您新建一个安全组。若已经有在使用的安全组可以直接选择使用。若安全组数量已达到上限无法新建，可删除部分不再使用的安全组。查看已在使用的安全组。<br>创建安全组：EMR 帮助用户创建一个安全组，开启22和30001端口及必要的内网通信网段。<br>已有 EMR 安全组：选择已创建的 EMR 安全组作为当前实例的安全组，开启22和30001端口及必要的内网通信网段。</td>
</tr>
<tr>
<td>计费模式</td>
<td>仅支持按量计费模式。按量计费：按照使用时长付费，需对账户进行实名认证，在开通时需冻结2小时的费用（代金券不可用作冻结凭证），销毁时退还冻结资源费用。</td>
</tr>
<tr>
<td>产品版本</td>
<td>不同产品版本上捆绑的组件和组件的版本不同。</td>
</tr>
<tr>
<td>部署服务</td>
<td>非必选组件，根据自身需求组合搭配自定义部署，最少选择一个组件服务部署；部署形式支持：默认部署和关联部署。<br>关联部署：是提供其它集群的服务为当前集群共用（其他云上 EMR 集群）。<br>默认部署：将当前服务部署到已选择的容器资源中，可自定义部署资源规格和数量（服务角色维度部署），推荐使用。</td>
</tr>
<tr>
<td>关联部署</td>
<td>选择 EMR on CVM 和 EMR on TKE 集群中含有当前服务的集群。<br>1. 选择 EMR on CVM 集群时，该集群必须部署当前服务。<br>2. 选择 EMR on TKE 集群时，该集群中当前服务必选设置可对外提供服务。</td>
</tr>
<tr>
<td>默认部署</td>
<td>数据卷目录：为容器提供数据存储目录，目前仅支持使用主机路径（HostPath 挂载方式）或使用新建 PVCPOD 规格设置服务角色维度部署信息可选项。<br>外部访问设置：设置当前角色是否开启对外提供服务，支持公网 LB 访问和内网 LB 访问可选项。<br>节点调度策略：设置当前角色部署调度策略，可根据调度规则，将 Pod 调度到符合预期的 Label 的节点中。</td>
</tr>
<tr>
<td>Hive 元数据库</td>
<td>如果选择了 Hive 组件，Hive 元数据库提供了两种存储方式：第一种集群默认，Hive 元数据存储于集群独立购买的 MetaDB；第二种是关联外部 Hive 元数据库，可选择关联 EMR-MetaDB 或自建 MySQL 数据库，元数据将存储于关联的数据库中，不随集群销毁而销毁。可参考 <a href="https://cloud.tencent.com/document/product/589/41518">Hive 元数据管理</a>。<br>注意：当选择 Hue、Ranger、Oozie、Druid、Superset 一个或多个组件时系统会自动购买一个 MetaDB 用于除 Hive 外的组件元数据存储。</td>
</tr>
<tr>
<td>cos存储桶</td>
<td>用于存储日志，jar 包等信息。</td>
</tr>
<tr>
<td>标签</td>
<td>您在创建时对集群或节点资源添加标签，以便于管理集群和节点资源，最多可绑定5条，标签键不可重复。</td>
</tr>
<tr>
<td>设置密码</td>
<td>设置 WebUI 密码，当前密码仅用于初始设置服务 WebUI 访问密码。</td>
</tr>
<tr>
<td>协议条款</td>
<td>同意<a href="https://cloud.tencent.com/document/product/301/34841">《弹性 MapReduce 服务等级协议》</a>和 <a href="https://cloud.tencent.com/document/product/589/44600">《退费协议》</a>。</td>
</tr>
</tbody></table>
